[
  {
    "Id": "174122",
    "ThreadId": "51898",
    "Html": "Hi - I'm trying to extend command support to a Silverlight DataForm - specifically the ItemEditEnded event.  When I look at the documentation for extending command support, there is a parameter supplied to the register attached property method that is &quot;typeof(Click)&quot;.  When I look at the metadata for the Click class, it appears as follows : <br>\r\n<br>\r\n<span style=\"font-size:13px;color:#008000\">\r\n<p>// Summary:</p>\r\n</span><span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// Static Class that holds all Dependency Properties and Static methods to allow\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// the Click event of the ButtonBase class to be attached to a Command.\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">//\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// Remarks:\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// This class is required, because Silverlight doesn't have native support for\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// Commands.\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#0000ff\">public</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">static</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">class</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\">Click\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>{</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// Summary:\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// Command parameter to supply on command execution.\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#0000ff\">public</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">static</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">readonly</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\">DependencyProperty</span><span style=\"font-size:13px\"> CommandParameterProperty;\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#008000\">//\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// Summary:\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// Command to execute on click event.\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#0000ff\">public</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">static</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">readonly</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\">DependencyProperty</span><span style=\"font-size:13px\"> CommandProperty;\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#008000\">// Summary:\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// Retrieves the System.Windows.Input.ICommand attached to the System.Windows.Controls.Primitives.ButtonBase.\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">//\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// Parameters:\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// buttonBase:\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// ButtonBase containing the Command dependency property\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">//\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// Returns:\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// The value of the command attached\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#0000ff\">public</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">static</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\">ICommand</span><span style=\"font-size:13px\"> GetCommand(</span><span style=\"font-size:13px;color:#2b91af\">ButtonBase</span><span style=\"font-size:13px\"> buttonBase);\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#008000\">//\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// Summary:\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// Gets the value in CommandParameter attached property on the provided System.Windows.Controls.Primitives.ButtonBase\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">//\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// Parameters:\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// buttonBase:\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// ButtonBase that has the CommandParameter\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">//\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// Returns:\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// The value of the property\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#0000ff\">public</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">static</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">object</span><span style=\"font-size:13px\"> GetCommandParameter(</span><span style=\"font-size:13px;color:#2b91af\">ButtonBase</span><span style=\"font-size:13px\"> buttonBase);\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#008000\">//\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// Summary:\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// Sets the System.Windows.Input.ICommand to execute on the click event.\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">//\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// Parameters:\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// buttonBase:\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// ButtonBase dependency object to attach command\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">//\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// command:\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// Command to attach\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#0000ff\">public</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">static</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">void</span><span style=\"font-size:13px\"> SetCommand(</span><span style=\"font-size:13px;color:#2b91af\">ButtonBase</span><span style=\"font-size:13px\"> buttonBase, </span><span style=\"font-size:13px;color:#2b91af\">ICommand</span><span style=\"font-size:13px\"> command);\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#008000\">//\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// Summary:\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// Sets the value for the CommandParameter attached property on the provided\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// System.Windows.Controls.Primitives.ButtonBase.\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">//\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// Parameters:\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// buttonBase:\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// ButtonBase to attach CommandParameter\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">//\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// parameter:\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\">// Parameter value to attach\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#0000ff\">public</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">static</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">void</span><span style=\"font-size:13px\"> SetCommandParameter(</span><span style=\"font-size:13px;color:#2b91af\">ButtonBase</span><span style=\"font-size:13px\"> buttonBase, </span><span style=\"font-size:13px;color:#0000ff\">object</span><span style=\"font-size:13px\"> parameter);\r\n<p>&nbsp;</p>\r\n<p>}<br>\r\n<br>\r\n<br>\r\n<br>\r\nWhat does this class do?  What is the equivalent that I have to implement for my own command extension?  Is this covered in the documentation?  This seems to me to be a missing piece of the puzzle.  <br>\r\n<br>\r\n</p>\r\n</span></p>\r\n",
    "PostedDate": "2009-03-31T16:37:09.613-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "175488",
    "ThreadId": "51898",
    "Html": "<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">Hi,</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">To create a command that is executed when the <b>ItemEditEnded</b> is fired you can perform the following steps (remember that this is just a sample). I have smoked tested this sample and it works correctly:</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span><span style=\"font-family:calibri\">1.</span><span style=\"font:7pt 'times new roman'\">       </span></span><span style=\"font-family:calibri\">Create a class for your attached behavior with code similar to this. In this example the class’ name is DataFormItemEditEndedCommandBehavior:</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span style=\"font-size:10pt;font-family:'courier new'\">public class DataFormItemEditEndedCommandBehavior : CommandBehaviorBase&lt;DataForm&gt; </span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span style=\"font-size:10pt;font-family:'courier new'\">    {</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        public DataFormItemEditEndedCommandBehavior(DataForm dataForm)</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            : base(dataForm)</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        {</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            dataForm.ItemEditEnded += OnItemEditEnded;</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        }</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span style=\"font-size:10pt;font-family:'courier new'\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        private void OnItemEditEnded(object sender, DataFormItemEditEndedEventArgs e)</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        {</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            ExecuteCommand();</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        }</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span style=\"font-size:10pt;font-family:'courier new'\">    }</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span><span style=\"font-family:calibri\">2.</span><span style=\"font:7pt 'times new roman'\">       </span></span><span style=\"font-family:calibri\">Create a class that will define the needed attached properties to execute the command with code similar to this:</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">public static class ItemEditEnded</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">    {</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        private static readonly DependencyProperty ItemEditEndedCommandBehaviorProperty = DependencyProperty.RegisterAttached(</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            &quot;ItemEditEndedCommandBehavior&quot;,</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            typeof(DataFormItemEditEndedCommandBehavior),</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            typeof(ItemEditEnded),</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            null);</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        public static readonly DependencyProperty CommandProperty = DependencyProperty.RegisterAttached(</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            &quot;Command&quot;,</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            typeof(ICommand),</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            typeof(ItemEditEnded),</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            new PropertyMetadata(OnSetCommandCallback));</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        public static readonly DependencyProperty CommandParameterProperty = DependencyProperty.RegisterAttached(</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">           &quot;CommandParameter&quot;,</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">           typeof(object),</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">           typeof(ItemEditEnded),</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">           new PropertyMetadata(OnSetCommandParameterCallback));</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        public static ICommand GetCommand(DataForm dataForm)</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        {</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            return dataForm.GetValue(CommandProperty) as ICommand;</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        }</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        public static void SetCommandParameter(DataForm dataForm, object parameter)</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        {</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            dataForm.SetValue(CommandParameterProperty, parameter);</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        }</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        public static object GetCommandParameter(DataForm dataForm)</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        {</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            return dataForm.GetValue(CommandParameterProperty);</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        }</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        private static void OnSetCommandCallback(DependencyObject dependencyObject, DependencyPropertyChangedEventArgs e)</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        {</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            DataForm dataForm = dependencyObject as DataForm;</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            if (dataForm != null)</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            {</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">                DataFormItemEditEndedCommandBehavior behavior = GetOrCreateBehavior(dataForm);</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">                behavior.Command = e.NewValue as ICommand;</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            }</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        }</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        private static void OnSetCommandParameterCallback(DependencyObject dependencyObject, DependencyPropertyChangedEventArgs e)</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        {</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            DataForm dataForm = dependencyObject as DataForm;</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            if (dataForm != null)</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            {</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">                DataFormItemEditEndedCommandBehavior behavior = GetOrCreateBehavior(dataForm);</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">                behavior.CommandParameter = e.NewValue;</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            }</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        }</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        private static DataFormItemEditEndedCommandBehavior GetOrCreateBehavior(DataForm dataForm)</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        {</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            DataFormItemEditEndedCommandBehavior behavior = dataForm.GetValue(ItemEditEndedCommandBehaviorProperty) as DataFormItemEditEndedCommandBehavior;</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            if (behavior == null)</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            {</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">                behavior = new DataFormItemEditEndedCommandBehavior(dataForm);</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">                dataForm.SetValue(ItemEditEndedCommandBehaviorProperty, behavior);</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            }</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            return behavior;</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">        }</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 34.2pt\"><span style=\"font-size:10pt;font-family:'courier new'\">    }</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">With this two classes you are good to go. You will then have to create your command and specify the required binding in your DataForm. The command principles explained in the Composite Application Guidance remain the same.</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"color:#1f497d;font-family:calibri\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt -1.2pt\"><span style=\"font-family:calibri\">The latter class is the one needed to create the attached behavior when the Xaml parser creates the UserControl. The following blog post uses a similar approach to the code that end up in the CAL (although it is not exactly the same), and explains how the Attached Behavior pattern works:</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 40.65pt\"><span style=\"font-family:symbol\">·<span style=\"font:7pt 'times new roman'\">         </span><a href=\"http://blogs.southworks.net/jdominguez/2008/08/icommand-for-silverlight-with-attached-behaviors/\" title=\"Permanent Link to ICommand for Silverlight with Attached Behaviors\"><span style=\"color:#0000ff;font-family:calibri\">ICommand for Silverlight with Attached Behaviors</span></a>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"color:#1f497d;font-family:calibri\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">For more information about customizing commands, you could read:</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 40.65pt\"><span style=\"font-family:symbol\">·<span style=\"font:7pt 'times new roman'\">         </span><a href=\"http://msdn.microsoft.com/en-us/library/dd458928.aspx\"><span style=\"color:#0000ff;font-family:calibri\">Commands</span></a>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">I hope this is useful for you.</span></p>\r\n<p style=\"margin:0cm 0cm 0pt -0.6pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt -0.6pt\"><span style=\"font-family:calibri\">Damian Schenkelman</span></p>\r\n<span style=\"font-size:11pt;font-family:'calibri','sans-serif'\"><a href=\"http://blogs.southworks.net/dschenkelman\"><span style=\"color:#0000ff\">http://blogs.southworks.net/dschenkelman</span></a></span></span></p>\r\n</span></p>\r\n",
    "PostedDate": "2009-04-03T14:31:12.373-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "175529",
    "ThreadId": "51898",
    "Html": "Thanks Damian....I went down this road, but I didn't implement the command parameter properly as you have.  Cheers.\r\n",
    "PostedDate": "2009-04-03T16:38:24.267-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]