[
  {
    "Id": "178870",
    "ThreadId": "53181",
    "Html": "Hi ,<div><br></div><div>    I am trying to writing a PRISM application that will use a Page class instead of a Window class. Do we have any sample to demonstrate this.</div><div>I made a few changes after reading the blog post <a href=\"http://www.mokosh.co.uk/post/Prism-and-WPF-Browser-Application-(Xbap).aspx\">http://www.mokosh.co.uk/post/Prism-and-WPF-Browser-Application-(Xbap).aspx</a> but still</div><div>when I try to mark a region within my page as a PRISM Region (Name=&quot;MainRegion&quot;) I get an exception as below.</div><div><br></div><div>Cannot create instance of 'Menu' defined in assembly 'NavigationApplication, Version=1.0.3391.18580, Culture=neutral, PublicKeyToken=null'. Exception has been thrown by the target of an invocation.  Error in markup file 'Menu.xaml' Line 1 Position 7.<br></div><div><br></div><div>In the above exception, Menu is the class derived from Page class.</div><div><br></div><div>Any help?</div><div><br></div><div>Thanks,</div><div>Ranjith</div>",
    "PostedDate": "2009-04-14T01:06:32.54-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "179726",
    "ThreadId": "53181",
    "Html": "<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">Hi Ranjith,</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">I see that you are using Prism v2 (because of the tag you used in the post) and Mokosh's post  targets Prism v1 (because he uses some v1 classes IModuleEnumerator, StaticModuleEnumerator). You might take a look at my post </span><a href=\"http://blogs.southworks.net/matiasb/2009/03/11/using-cal-with-xbap-applications/\" title=\"Permanent Link to Migrating Composite Application Guidance (Prism-v2) to XBAP\"><span style=\"color:#0000ff;font-family:calibri\">Migrating Composite Application Guidance (Prism-v2) to XBAP</span></a><span style=\"font-family:calibri\"> that uses this same approach to migrate the HelloWorld Quickstart in Prism v2. </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">I followed Mokosh's steps on the HelloWorld quickstart application but couldn't reproduce the same exception you are receiving. Instead I get the following error:</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\"><i>&quot;An exception of type 'System.NullReferenceException' occurred in Microsoft.Practices.ServiceLocation.dll but was not handled in user code&quot; </i>in the <b>CreateRegion </b>method<b> </b>of the<b> RegionManager </b>class<b>.</b></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><b><span style=\"font-family:calibri\"> </span></b></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">To solve this issue I needed to make some changes to Mokosh's solution:</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36.6pt\"><span style=\"font-size:10pt;font-family:calibri\">1.<span style=\"font:7pt 'times new roman'\">  </span>Replace <b>GetModuleEnumerator </b>method in Mokosh's <b>Bootstrapper</b> with the following one:<br>\r\n<span style=\"font-size:10pt;color:blue;font-family:'courier new'\">protected</span><span style=\"font-size:10pt;font-family:'courier new'\"> <span style=\"color:blue\">override</span> IModuleCatalog GetModuleCatalog()</span>\r\n<p style=\"margin:0cm 0cm 0pt 35.4pt\"><span style=\"font-size:10pt;font-family:'courier new'\">{</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 35.4pt\"><span style=\"font-size:10pt;font-family:'courier new'\">ModuleCatalog catalog = <span style=\"color:blue\">new</span> ModuleCatalog()</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 71.4pt\"><span style=\"font-size:10pt;font-family:'courier new'\">.AddModule(<span style=\"color:blue\">typeof</span>(HelloWorldModule.HelloWorldModule));</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 35.4pt\"><span style=\"font-size:10pt;color:blue;font-family:'courier new'\">return</span><span style=\"font-size:10pt;font-family:'courier new'\"> catalog;</span></p>\r\n<p style=\"margin:0cm 0cm 12pt 35.4pt\"><span style=\"font-size:10pt;font-family:'courier new'\">}</span> </p>\r\n<p style=\"margin:0cm 0cm 0pt 36.6pt\"><span><span style=\"font-family:calibri\">2.</span><span style=\"font:7pt 'times new roman'\">       </span></span><span style=\"font-family:calibri\">Page constructor should first execute the bootstrapper, then Initialize the components (this way the <b>RegionManager</b> can be located)</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36.6pt\"><span style=\"font-size:10pt;color:blue;font-family:'courier new'\">public</span><span style=\"font-size:10pt;font-family:'courier new'\"> Shell()</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36.6pt\"><span style=\"font-size:10pt;font-family:'courier new'\">{</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36.6pt\"><span style=\"font-size:10pt;font-family:'courier new'\">    Bootstrapper bootStrapper = <span style=\"color:blue\">new</span> Bootstrapper();</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36.6pt\"><span style=\"font-size:10pt;font-family:'courier new'\">    bootStrapper.ShellPage = <span style=\"color:blue\">this</span>;</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36.6pt\"><span style=\"font-size:10pt;font-family:'courier new'\">    bootStrapper.Run();</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36.6pt\"><span style=\"font-size:10pt;font-family:'courier new'\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36.6pt\"><span style=\"font-size:10pt;font-family:'courier new'\">    InitializeComponent();            </span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36.6pt\"><span style=\"font-size:10pt;font-family:'courier new'\">}</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36.6pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">There are also some things that should be done and the post does not say explicitly:</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span style=\"font-family:symbol\">·<span style=\"font:7pt 'times new roman'\">         </span><span style=\"font-family:calibri\"><b>StartupUri</b> tag should be added in app.xaml. For example: </span><span style=\"font-size:10pt;color:blue;font-family:'courier new'\">&lt;</span><span style=\"font-size:10pt;color:#a31515;font-family:'courier new'\">Application</span> <b><span style=\"font-size:10pt;color:red;font-family:'courier new'\">StartupUri</span></b><b><span style=\"font-size:10pt;color:blue;font-family:'courier new'\">=</span></b><b><span style=\"font-size:10pt;font-family:'courier new'\">&quot;<span style=\"color:blue\">shell.xaml</span>&quot;<span style=\"color:#1f497d\">&gt;</span>\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span style=\"font-family:symbol\">·<span style=\"font:7pt 'times new roman'\">         </span><span style=\"font-family:calibri\"><b>OnStartup </b>method from <b>App</b> class should be deleted<b></b></span>\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span style=\"font-family:calibri\">·<span style=\"font:7pt 'times new roman'\">         </span>You should replace <b>Window</b> by <b>Page</b> in <b>Shell</b> class (both in xaml and cs). For example: <span style=\"font-size:10pt;color:blue;font-family:'courier new'\">&lt;</span><b><span style=\"font-size:10pt;color:#a31515;font-family:'courier new'\">Page</span></b> ......   and  <span style=\"font-size:10pt;color:blue;font-family:'courier new'\">public</span><span style=\"font-size:10pt;font-family:'courier new'\"> <span style=\"color:blue\">partial</span> <span style=\"color:blue\">class</span> <span style=\"color:#2b91af\">Shell</span> : <b><span style=\"color:#2b91af\">Page</span></b></span>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'courier new'\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">Please let me know if this helps you solve your issue. If not please tell me what changes have you done to make Mokosh's solution run in Prism v2.</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">Matias Bonaventura</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><a href=\"http://blogs.southworks.net/\"><span style=\"font-family:calibri\">http://blogs.southworks.net/matiasb</span></a></p>\r\n</span></p>\r\n</span></p>\r\n</span></b> </span></p>\r\n</span></p>\r\n",
    "PostedDate": "2009-04-15T10:39:30.393-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "200594",
    "ThreadId": "53181",
    "Html": "<p>Hi,</p>\r\n<p>I was trying to add navigation to the Erwin &quot;outlook style&quot; application. Everything went fine with the above guidelines, except that the RegionManager is always empty, thus leading to not having the view rendered. Everything compile fine.</p>\r\n<p>The problem seems to be in CreateShell method, which should be changed only to return the ShellPage property:<br><br>protected override DependencyObject CreateShell()<br>{<br>&nbsp;&nbsp; var shell = Container.Resolve&lt;Shell&gt;();<br>&nbsp;&nbsp; var model = Container.Resolve&lt;IApplicationModel&gt;();<br>&nbsp;&nbsp; shell.DataContext = model;<br>&nbsp;&nbsp; shell.Show();<br>&nbsp;&nbsp; return shell;<br>}<br>should be changed to:<br>&nbsp;&nbsp;&nbsp; protected override DependencyObject CreateShell()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return ShellPage;<br>&nbsp;&nbsp;&nbsp; }</p>\r\n<p>That's means that the RegionManager is not resolved via the Container? How shall be added the Model in that case?</p>\r\n<p>Thanks,<br>Emanuel Pasat<span style=\"color:#008000;font-size:x-small\"></span></p>",
    "PostedDate": "2009-06-11T15:00:43.613-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "200965",
    "ThreadId": "53181",
    "Html": "<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:small\"><span style=\"font-family:Calibri\"><span style=\"\" lang=EN-US>Hi Emanuel, </span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:small\"><span style=\"font-family:Calibri\"><span style=\"\" lang=EN-US>&nbsp;</span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:small\"><span style=\"font-family:Calibri\"><span style=\"\" lang=EN-US>If I understood your problem correctly, you followed the steps for </span><span style=\"color:#30332d\"><a title=\"Permanent Link to Migrating Composite Application Guidance (Prism-v2) to XBAP\" href=\"http://blogs.southworks.net/matiasb/2009/03/11/using-cal-with-xbap-applications/\"><span style=\"\" lang=EN-US><span style=\"color:#0000ff\">Migrating Composite Application Guidance (Prism-v2) to XBAP</span></span></a></span><span style=\"color:#30332d\"> <span lang=EN-US>in <a href=\"http://blogs.msdn.com/erwinvandervalk/archive/2009/04/29/how-to-build-an-outlook-style-application-with-prism-v2-part-2.aspx\">Erwin's outlook app</a> and </span></span><span style=\"\" lang=EN-US>views are<span style=\"color:#30332d\"> not showing.</span></span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"\" lang=EN-US><span style=\"font-size:small\"><span style=\"font-family:Calibri\">I followed those steps and<strong><em> </em></strong>was able to reproduce the situation you mention by changing the <strong>CreateShell</strong> method with the code you posted. </span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"\" lang=EN-US><span style=\"font-size:small\"><span style=\"font-family:Calibri\">&nbsp;</span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:small\"><span style=\"font-family:Calibri\"><span style=\"\" lang=EN-US>In this case, views are not showing because the <strong>ApplicationModel</strong> is not being set as the dataContext for the Shell. </span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:small\"><span style=\"font-family:Calibri\"><span style=\"\" lang=EN-US>&nbsp;</span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:small\"><span style=\"font-family:Calibri\"><strong><span style=\"\" lang=EN-US>Workaround </span></strong></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"\" lang=EN-US><span style=\"font-size:small;font-family:Calibri\">Modify the <strong>CreateShell</strong> method in the bootstrapper as follows:</span></span><span style=\"font-size:10pt;color:#2b91af;font-family:'Courier New'\" lang=EN-US> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;color:blue;font-family:'Courier New'\" lang=EN-US>protected</span><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US> <span style=\"color:blue\">override</span> System.Windows.<span style=\"color:#2b91af\">DependencyObject</span> CreateShell()</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>{</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp; <span style=\"color:green\">//var shell = Container.Resolve&lt;Shell&gt;();</span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp; <span style=\"color:blue\">var</span> model = Container.Resolve&lt;<span style=\"color:#2b91af\">IApplicationModel</span>&gt;();</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp; <strong>((<span style=\"color:#2b91af\">Shell</span>)ShellPage).DataContext = model;</strong></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp; <span style=\"color:green\">//shell.Show();</span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp; <span style=\"color:blue\">return</span> ShellPage;</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>}</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:small\"><span style=\"font-family:Calibri\"><span style=\"\" lang=EN-US>Hope it helps!</span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:small\"><span style=\"font-family:Calibri\"><span style=\"\" lang=EN-US>&nbsp;</span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:small\"><span style=\"font-family:Calibri\">Matias Bonaventura</span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><a href=\"http://blogs.southworks.net/\"><span style=\"font-size:small;font-family:Calibri\">http://blogs.southworks.net/matiasb</span></a></p>",
    "PostedDate": "2009-06-12T12:51:07.367-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]