[
  {
    "Id": "521364",
    "ThreadId": "234536",
    "Html": "\r\n<p>There were a few posts about skinning the shell but no real answers. I used the same technique that Josh Smith did to skin his Podder project. http://joshsmithonwpf.wordpress.com/category/podder/<br>\r\n<br>\r\n&nbsp;<br>\r\nEverything is working except that I can&rsquo;t figure out why the skinned shell&rsquo;s initialize is not calling the ViewModel and the import setter is not being called.<br>\r\n<br>\r\n<br>\r\nRundown of what everything is supposed to do.<br>\r\n1. ShellContainer does nothing but be a container for the actual skinned shell.<br>\r\n2. Shell contains the Regions that can be different depending of the skin.<br>\r\n<br>\r\n1. Bootstrapper gets the ShellContainer which determines what skin to use and sets the content.<br>\r\n2. ShellContainer initializes and the mef magic loads the skinned shell and any module that is needed.<br>\r\n<br>\r\nThe wpf project is using the MSDN Prism 4 assemblies.</p>\r\n<p><br>\r\n<br>\r\nI posted some of the code below if someone might want to take a quick look at it. Hopefully it is just a simple issue and not a flaw in my concept.</p>\r\n<p>&nbsp;</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:green\">// ProjectBootStrapper.cs</span>\r\n\r\n<span style=\"color:blue\">public</span> <span style=\"color:blue\">partial</span> <span style=\"color:blue\">class</span> ProjectBootstrapper \r\n    : MefBootstrapper\r\n{\r\n    <span style=\"color:blue\">protected</span> <span style=\"color:blue\">override</span> DependencyObject CreateShell()\r\n    {\r\n        <span style=\"color:blue\">return</span> <span style=\"color:blue\">this</span>.Container.GetExportedValue&lt;ShellContainer&gt;();\r\n    }\r\n}\r\n\r\n\r\n<span style=\"color:green\">// ShellContainer.xaml.cs</span>\r\n\r\n[Export]\r\n<span style=\"color:blue\">public</span> <span style=\"color:blue\">partial</span> <span style=\"color:blue\">class</span> ShellContainer\r\n        : ConfigurableWindow\r\n{\r\n    <span style=\"color:blue\">public</span> ShellContainer()\r\n    {\r\n        <span style=\"color:blue\">this</span>.ConfigureWindowSettings(<span style=\"color:blue\">new</span> ShellWindowSettings(<span style=\"color:blue\">this</span>));\r\n\r\n        InitializeComponent();\r\n    }\r\n\r\n    [Import]\r\n    <span style=\"color:blue\">private</span> ShellContainerViewModel ViewModel\r\n    {\r\n        <span style=\"color:blue\">set</span>\r\n        {\r\n            <span style=\"color:blue\">this</span>.DataContext = value;\r\n        }\r\n    } \r\n}\r\n\r\n<span style=\"color:green\">// ShellContainer.xaml</span>\r\n\r\n&lt;framework:ConfigurableWindow x:Class=<span style=\"color:#a31515\">&quot;Project.ShellContainer&quot;</span>\r\n                            xmlns=<span style=\"color:#a31515\">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span>\r\n                            xmlns:x=<span style=\"color:#a31515\">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span>\r\n                            xmlns:framework=<span style=\"color:#a31515\">&quot;clr-namespace:CompanyFramework.WindowSettings;assembly=CompanyFramework&quot;</span>\r\n                            Content=<span style=\"color:#a31515\">&quot;{DynamicResource VIEW_MainWindow}&quot;</span>\r\n                            MinWidth=<span style=\"color:#a31515\">&quot;800&quot;</span>\r\n                            MinHeight=<span style=\"color:#a31515\">&quot;600&quot;</span>\r\n                            Title=<span style=\"color:#a31515\">&quot;&quot;</span>&gt;\r\n\r\n&lt;/framework:ConfigurableWindow&gt;\r\n\r\n<span style=\"color:green\">// SkinResource.xaml</span>\r\n\r\n&lt;ResourceDictionary xmlns=<span style=\"color:#a31515\">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span>\r\n                xmlns:x=<span style=\"color:#a31515\">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span>\r\n                xmlns:views=<span style=\"color:#a31515\">&quot;clr-namespace:Project.Resources.Views&quot;</span> &gt;\r\n                    \r\n&lt;views:Shell x:Key=<span style=\"color:#a31515\">&quot;VIEW_MainWindow&quot;</span> /&gt;\r\n\r\n&lt;/ResourceDictionary&gt;\r\n\r\n<span style=\"color:green\">// ShellContainerViewModel.cs</span>\r\n[Export]\r\n<span style=\"color:blue\">public</span> <span style=\"color:blue\">class</span> ShellContainerViewModel\r\n    : NotificationObject\r\n{\r\n}\r\n\r\n<span style=\"color:green\">// Shell.xaml.cs</span>\r\n\r\n[Export] <span style=\"color:green\">// Not sure if this is the correct attribute.</span>\r\n[PartCreationPolicy(CreationPolicy.Shared)]\r\n<span style=\"color:blue\">public</span> <span style=\"color:blue\">partial</span> <span style=\"color:blue\">class</span> Shell\r\n    : UserControl\r\n{\r\n    <span style=\"color:blue\">public</span> Shell()\r\n    {\r\n        <span style=\"color:green\">// This is not calling the ViewModel's constructor</span>\r\n        InitializeComponent();\r\n    }\r\n\r\n    [Import]\r\n    <span style=\"color:blue\">private</span> ShellViewModel ViewModel\r\n    {\r\n        <span style=\"color:blue\">set</span>\r\n        {\r\n            <span style=\"color:green\">// This is not being called at all.</span>\r\n            <span style=\"color:blue\">this</span>.DataContext = value;\r\n        }\r\n    } \r\n}\r\n\r\n<span style=\"color:green\">// ShellViewModel.cs</span>\r\n\r\n[Export(<span style=\"color:blue\">typeof</span>(ShellViewModel))]\r\n[PartCreationPolicy(CreationPolicy.Shared)]\r\n<span style=\"color:blue\">public</span> <span style=\"color:blue\">class</span> ShellViewModel \r\n    : NotificationObject\r\n{\r\n    <span style=\"color:blue\">private</span> IEventAggregator eventAggregator;\r\n\r\n    [ImportingConstructor]\r\n    <span style=\"color:blue\">public</span> ShellViewModel(IEventAggregator eventAggregator)\r\n    {\r\n        <span style=\"color:blue\">this</span>.eventAggregator = eventAggregator;\r\n\r\n    }\r\n}\r\n\r\n</pre>\r\n</div>\r\n<p></p>\r\n<div id=\"x__mcePaste\" style=\"left:-10000px; top:0px; width:1px; height:1px; overflow:hidden\">\r\n&lt;!--[if gte mso 9]&gt;&lt;xml&gt; &lt;w:WordDocument&gt; &lt;w:View&gt;Normal&lt;/w:View&gt; &lt;w:Zoom&gt;0&lt;/w:Zoom&gt; &lt;w:TrackMoves /&gt; &lt;w:TrackFormatting /&gt; &lt;w:PunctuationKerning /&gt; &lt;w:ValidateAgainstSchemas /&gt; &lt;w:SaveIfXMLInvalid&gt;false&lt;/w:SaveIfXMLInvalid&gt; &lt;w:IgnoreMixedContent&gt;false&lt;/w:IgnoreMixedContent&gt;\r\n &lt;w:AlwaysShowPlaceholderText&gt;false&lt;/w:AlwaysShowPlaceholderText&gt; &lt;w:DoNotPromoteQF /&gt; &lt;w:LidThemeOther&gt;EN-US&lt;/w:LidThemeOther&gt; &lt;w:LidThemeAsian&gt;X-NONE&lt;/w:LidThemeAsian&gt; &lt;w:LidThemeComplexScript&gt;X-NONE&lt;/w:LidThemeComplexScript&gt; &lt;w:Compatibility&gt; &lt;w:BreakWrappedTables\r\n /&gt; &lt;w:SnapToGridInCell /&gt; &lt;w:WrapTextWithPunct /&gt; &lt;w:UseAsianBreakRules /&gt; &lt;w:DontGrowAutofit /&gt; &lt;w:SplitPgBreakAndParaMark /&gt; &lt;w:DontVertAlignCellWithSp /&gt; &lt;w:DontBreakConstrainedForcedTables /&gt; &lt;w:DontVertAlignInTxbx /&gt; &lt;w:Word11KerningPairs /&gt; &lt;w:CachedColBalance\r\n /&gt; &lt;/w:Compatibility&gt; &lt;w:BrowserLevel&gt;MicrosoftInternetExplorer4&lt;/w:BrowserLevel&gt; &lt;m:mathPr&gt; &lt;m:mathFont m:val=&quot;Cambria Math&quot; /&gt; &lt;m:brkBin m:val=&quot;before&quot; /&gt; &lt;m:brkBinSub m:val=&quot;&#45;-&quot; /&gt; &lt;m:smallFrac m:val=&quot;off&quot; /&gt; &lt;m:dispDef /&gt; &lt;m:lMargin m:val=&quot;0&quot; /&gt; &lt;m:rMargin\r\n m:val=&quot;0&quot; /&gt; &lt;m:defJc m:val=&quot;centerGroup&quot; /&gt; &lt;m:wrapIndent m:val=&quot;1440&quot; /&gt; &lt;m:intLim m:val=&quot;subSup&quot; /&gt; &lt;m:naryLim m:val=&quot;undOvr&quot; /&gt; &lt;/m:mathPr&gt;&lt;/w:WordDocument&gt; &lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt; &lt;w:LatentStyles DefLockedState=&quot;false&quot; DefUnhideWhenUsed=&quot;true&quot;\r\n DefSemiHidden=&quot;true&quot; DefQFormat=&quot;false&quot; DefPriority=&quot;99&quot; LatentStyleCount=&quot;267&quot;&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;0&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; QFormat=&quot;true&quot; Name=&quot;Normal&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;9&quot; SemiHidden=&quot;false&quot;\r\n UnhideWhenUsed=&quot;false&quot; QFormat=&quot;true&quot; Name=&quot;heading 1&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;9&quot; QFormat=&quot;true&quot; Name=&quot;heading 2&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;9&quot; QFormat=&quot;true&quot; Name=&quot;heading 3&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;9&quot;\r\n QFormat=&quot;true&quot; Name=&quot;heading 4&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;9&quot; QFormat=&quot;true&quot; Name=&quot;heading 5&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;9&quot; QFormat=&quot;true&quot; Name=&quot;heading 6&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;9&quot; QFormat=&quot;true&quot; Name=&quot;heading\r\n 7&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;9&quot; QFormat=&quot;true&quot; Name=&quot;heading 8&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;9&quot; QFormat=&quot;true&quot; Name=&quot;heading 9&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;39&quot; Name=&quot;toc 1&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot;\r\n Priority=&quot;39&quot; Name=&quot;toc 2&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;39&quot; Name=&quot;toc 3&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;39&quot; Name=&quot;toc 4&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;39&quot; Name=&quot;toc 5&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;39&quot;\r\n Name=&quot;toc 6&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;39&quot; Name=&quot;toc 7&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;39&quot; Name=&quot;toc 8&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;39&quot; Name=&quot;toc 9&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;35&quot; QFormat=&quot;true&quot;\r\n Name=&quot;caption&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;10&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; QFormat=&quot;true&quot; Name=&quot;Title&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;1&quot; Name=&quot;Default Paragraph Font&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;11&quot;\r\n SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; QFormat=&quot;true&quot; Name=&quot;Subtitle&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;22&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; QFormat=&quot;true&quot; Name=&quot;Strong&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;20&quot; SemiHidden=&quot;false&quot;\r\n UnhideWhenUsed=&quot;false&quot; QFormat=&quot;true&quot; Name=&quot;Emphasis&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;59&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Table Grid&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Placeholder Text&quot; /&gt; &lt;w:LsdException\r\n Locked=&quot;false&quot; Priority=&quot;1&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; QFormat=&quot;true&quot; Name=&quot;No Spacing&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;60&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Light Shading&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;61&quot;\r\n SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Light List&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;62&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Light Grid&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;63&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot;\r\n Name=&quot;Medium Shading 1&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;64&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Shading 2&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;65&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium List 1&quot; /&gt; &lt;w:LsdException\r\n Locked=&quot;false&quot; Priority=&quot;66&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium List 2&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;67&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Grid 1&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;68&quot; SemiHidden=&quot;false&quot;\r\n UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Grid 2&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;69&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Grid 3&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;70&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Dark\r\n List&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;71&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Colorful Shading&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;72&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Colorful List&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot;\r\n Priority=&quot;73&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Colorful Grid&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;60&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Light Shading Accent 1&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;61&quot; SemiHidden=&quot;false&quot;\r\n UnhideWhenUsed=&quot;false&quot; Name=&quot;Light List Accent 1&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;62&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Light Grid Accent 1&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;63&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot;\r\n Name=&quot;Medium Shading 1 Accent 1&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;64&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Shading 2 Accent 1&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;65&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium\r\n List 1 Accent 1&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Revision&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;34&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; QFormat=&quot;true&quot; Name=&quot;List Paragraph&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;29&quot;\r\n SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; QFormat=&quot;true&quot; Name=&quot;Quote&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;30&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; QFormat=&quot;true&quot; Name=&quot;Intense Quote&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;66&quot; SemiHidden=&quot;false&quot;\r\n UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium List 2 Accent 1&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;67&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Grid 1 Accent 1&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;68&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot;\r\n Name=&quot;Medium Grid 2 Accent 1&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;69&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Grid 3 Accent 1&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;70&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Dark List\r\n Accent 1&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;71&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Colorful Shading Accent 1&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;72&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Colorful List Accent 1&quot; /&gt;\r\n &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;73&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Colorful Grid Accent 1&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;60&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Light Shading Accent 2&quot; /&gt; &lt;w:LsdException\r\n Locked=&quot;false&quot; Priority=&quot;61&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Light List Accent 2&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;62&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Light Grid Accent 2&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;63&quot;\r\n SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Shading 1 Accent 2&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;64&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Shading 2 Accent 2&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;65&quot; SemiHidden=&quot;false&quot;\r\n UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium List 1 Accent 2&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;66&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium List 2 Accent 2&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;67&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot;\r\n Name=&quot;Medium Grid 1 Accent 2&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;68&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Grid 2 Accent 2&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;69&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Grid\r\n 3 Accent 2&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;70&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Dark List Accent 2&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;71&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Colorful Shading Accent 2&quot; /&gt; &lt;w:LsdException\r\n Locked=&quot;false&quot; Priority=&quot;72&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Colorful List Accent 2&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;73&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Colorful Grid Accent 2&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;60&quot;\r\n SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Light Shading Accent 3&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;61&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Light List Accent 3&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;62&quot; SemiHidden=&quot;false&quot;\r\n UnhideWhenUsed=&quot;false&quot; Name=&quot;Light Grid Accent 3&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;63&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Shading 1 Accent 3&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;64&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot;\r\n Name=&quot;Medium Shading 2 Accent 3&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;65&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium List 1 Accent 3&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;66&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium\r\n List 2 Accent 3&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;67&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Grid 1 Accent 3&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;68&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Grid 2 Accent 3&quot;\r\n /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;69&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Grid 3 Accent 3&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;70&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Dark List Accent 3&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot;\r\n Priority=&quot;71&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Colorful Shading Accent 3&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;72&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Colorful List Accent 3&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;73&quot;\r\n SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Colorful Grid Accent 3&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;60&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Light Shading Accent 4&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;61&quot; SemiHidden=&quot;false&quot;\r\n UnhideWhenUsed=&quot;false&quot; Name=&quot;Light List Accent 4&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;62&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Light Grid Accent 4&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;63&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot;\r\n Name=&quot;Medium Shading 1 Accent 4&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;64&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Shading 2 Accent 4&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;65&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium\r\n List 1 Accent 4&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;66&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium List 2 Accent 4&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;67&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Grid 1 Accent 4&quot;\r\n /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;68&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Grid 2 Accent 4&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;69&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Grid 3 Accent 4&quot; /&gt; &lt;w:LsdException\r\n Locked=&quot;false&quot; Priority=&quot;70&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Dark List Accent 4&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;71&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Colorful Shading Accent 4&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;72&quot;\r\n SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Colorful List Accent 4&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;73&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Colorful Grid Accent 4&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;60&quot; SemiHidden=&quot;false&quot;\r\n UnhideWhenUsed=&quot;false&quot; Name=&quot;Light Shading Accent 5&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;61&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Light List Accent 5&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;62&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot;\r\n Name=&quot;Light Grid Accent 5&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;63&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Shading 1 Accent 5&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;64&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Shading\r\n 2 Accent 5&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;65&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium List 1 Accent 5&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;66&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium List 2 Accent 5&quot; /&gt; &lt;w:LsdException\r\n Locked=&quot;false&quot; Priority=&quot;67&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Grid 1 Accent 5&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;68&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Grid 2 Accent 5&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;69&quot;\r\n SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Grid 3 Accent 5&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;70&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Dark List Accent 5&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;71&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot;\r\n Name=&quot;Colorful Shading Accent 5&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;72&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Colorful List Accent 5&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;73&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Colorful\r\n Grid Accent 5&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;60&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Light Shading Accent 6&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;61&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Light List Accent 6&quot; /&gt; &lt;w:LsdException\r\n Locked=&quot;false&quot; Priority=&quot;62&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Light Grid Accent 6&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;63&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Shading 1 Accent 6&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;64&quot;\r\n SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Shading 2 Accent 6&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;65&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium List 1 Accent 6&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;66&quot; SemiHidden=&quot;false&quot;\r\n UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium List 2 Accent 6&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;67&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Grid 1 Accent 6&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;68&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot;\r\n Name=&quot;Medium Grid 2 Accent 6&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;69&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Medium Grid 3 Accent 6&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;70&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Dark List\r\n Accent 6&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;71&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Colorful Shading Accent 6&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;72&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Colorful List Accent 6&quot; /&gt;\r\n &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;73&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; Name=&quot;Colorful Grid Accent 6&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;19&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; QFormat=&quot;true&quot; Name=&quot;Subtle Emphasis&quot; /&gt; &lt;w:LsdException\r\n Locked=&quot;false&quot; Priority=&quot;21&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; QFormat=&quot;true&quot; Name=&quot;Intense Emphasis&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;31&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; QFormat=&quot;true&quot; Name=&quot;Subtle Reference&quot; /&gt; &lt;w:LsdException\r\n Locked=&quot;false&quot; Priority=&quot;32&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; QFormat=&quot;true&quot; Name=&quot;Intense Reference&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;33&quot; SemiHidden=&quot;false&quot; UnhideWhenUsed=&quot;false&quot; QFormat=&quot;true&quot; Name=&quot;Book Title&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot;\r\n Priority=&quot;37&quot; Name=&quot;Bibliography&quot; /&gt; &lt;w:LsdException Locked=&quot;false&quot; Priority=&quot;39&quot; QFormat=&quot;true&quot; Name=&quot;TOC Heading&quot; /&gt; &lt;/w:LatentStyles&gt; &lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 10]&gt; &lt;mce:style&gt;&lt;! /* Style Definitions */ table.MsoNormalTable {mso-style-name:&quot;Table\r\n Normal&quot;; mso-tstyle-rowband-size:0; mso-tstyle-colband-size:0; mso-style-noshow:yes; mso-style-priority:99; mso-style-qformat:yes; mso-style-parent:&quot;&quot;; mso-padding-alt:0in 5.4pt 0in 5.4pt; mso-para-margin-top:0in; mso-para-margin-right:0in; mso-para-margin-bottom:10.0pt;\r\n mso-para-margin-left:0in; line-height:115%; mso-pagination:widow-orphan; font-size:11.0pt; font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;; mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin; mso-fareast-font-family:&quot;Times New Roman&quot;; mso-fareast-theme-font:minor-fareast;\r\n mso-hansi-font-family:Calibri; mso-hansi-theme-font:minor-latin;} --&gt; &lt;!--[endif]--&gt;\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\">There were a few posts about skinning the shell but no real answers. I used the same technique that Josh Smith did to skin his Podder project.\r\n<a href=\"http://joshsmithonwpf.wordpress.com/category/podder/\">http://joshsmithonwpf.wordpress.com/category/podder/</a></span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\">&nbsp;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\"><span>&nbsp;</span></span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\">Everything is working except that I can&rsquo;t figure out why the skinned shell&rsquo;s initialize is not calling the ViewModel and the import\r\n setter is not being called.</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\">&nbsp;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\">&nbsp;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\">Rundown of what everything is supposed to do.</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\">1. ShellContainer does nothing but be a container for the actual skinned shell.</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\">2. Shell contains the Regions that can be different depending of the skin.</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\">&nbsp;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\">1. Bootstrapper gets the ShellContainer which determines what skin to use and sets the content.</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\">2. ShellContainer initializes and the mef magic loads the skinned shell and any module that is needed.</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\">&nbsp;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\">The project is using the MSDN Prism 4 assemblies.</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\">&nbsp;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\">I posted some of the code below if someone might want to take a quick look at it. Hopefully it is just a simple issue and not a flaw in my concept.</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:&quot;Arial&quot;,&quot;sans-serif&quot;\">&nbsp;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:9.5pt; font-family:Consolas\">&nbsp;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\">ProjectBootStrapper.cs</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\">&nbsp;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:blue\">public</span> <span style=\"color:blue\">partial</span>\r\n<span style=\"color:blue\">class</span> <span style=\"color:#2b91af\">ProjectBootstrapper</span>\r\n</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>: <span style=\"color:#2b91af\">MefBootstrapper</span></span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;\r\n</span>{</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:blue\">protected</span> <span style=\"color:blue\">override</span>\r\n<span style=\"color:#2b91af\">DependencyObject</span> CreateShell()</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>{</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:blue\">return</span> <span style=\"color:blue\">this</span>.Container.GetExportedValue&lt;<span style=\"color:#2b91af\">ShellContainer</span>&gt;();</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>}</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;\r\n</span>}</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\">&nbsp;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\">&nbsp;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\">ShellContainer.xaml.cs</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\">&nbsp;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;\r\n</span>[<span style=\"color:#2b91af\">Export</span>]</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:blue\">public</span> <span style=\"color:blue\">partial</span>\r\n<span style=\"color:blue\">class</span> <span style=\"color:#2b91af\">ShellContainer</span></span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>: <span style=\"color:#2b91af\">ConfigurableWindow</span></span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;\r\n</span>{</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:blue\">public</span> ShellContainer()</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>{</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:blue\">this</span>.ConfigureWindowSettings(<span style=\"color:blue\">new</span>\r\n<span style=\"color:#2b91af\">ShellWindowSettings</span>(<span style=\"color:blue\">this</span>));</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\">&nbsp;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>InitializeComponent();</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>}</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\">&nbsp;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>[<span style=\"color:#2b91af\">Import</span>]</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:blue\">private</span> <span style=\"color:#2b91af\">ShellContainerViewModel</span> ViewModel</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>{</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:blue\">set</span></span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>{</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:blue\">this</span>.DataContext = <span style=\"color:blue\">\r\nvalue</span>;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>}</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>} </span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;\r\n</span>}</span></p>\r\n<p><span style=\"font-size:10pt; line-height:115%; font-family:Consolas\">&nbsp;</span></p>\r\n<p><span style=\"font-size:10pt; line-height:115%; font-family:Consolas\">ShellContainer.xaml</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas; color:blue\">&lt;</span><span style=\"font-size:10pt; font-family:Consolas; color:#a31515\">framework</span><span style=\"font-size:10pt; font-family:Consolas; color:blue\">:</span><span style=\"font-size:10pt; font-family:Consolas; color:#a31515\">ConfigurableWindow</span><span style=\"font-size:10pt; font-family:Consolas; color:red\">\r\n x</span><span style=\"font-size:10pt; font-family:Consolas; color:blue\">:</span><span style=\"font-size:10pt; font-family:Consolas; color:red\">Class</span><span style=\"font-size:10pt; font-family:Consolas; color:blue\">=&quot;Project.ShellContainer&quot;</span><span style=\"font-size:10pt; font-family:Consolas\">&nbsp;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:red\"><span>&nbsp;</span>xmlns</span><span style=\"color:blue\">=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:red\"><span>&nbsp;</span>xmlns</span><span style=\"color:blue\">:</span><span style=\"color:red\">x</span><span style=\"color:blue\">=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:red\"><span>&nbsp;</span>xmlns</span><span style=\"color:blue\">:</span><span style=\"color:red\">framework</span><span style=\"color:blue\">=&quot;clr-namespace:CompanyFramework.WindowSettings;assembly=CompanyFramework&quot;</span></span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:red\"><span>&nbsp;</span>Content</span><span style=\"color:blue\">=&quot;{</span><span style=\"color:#a31515\">DynamicResource</span><span style=\"color:red\"> VIEW_MainWindow</span><span style=\"color:blue\">}&quot;</span></span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:red\"><span>&nbsp;</span>MinWidth</span><span style=\"color:blue\">=&quot;800&quot;</span></span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color:red\"><span>&nbsp;</span>MinHeight</span><span style=\"color:blue\">=&quot;600&quot;</span></span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:red\"><span>&nbsp;</span>Title</span><span style=\"color:blue\">=&quot;&quot;&gt;</span></span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\">&nbsp;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas; color:blue\">&lt;/</span><span style=\"font-size:10pt; font-family:Consolas; color:#a31515\">framework</span><span style=\"font-size:10pt; font-family:Consolas; color:blue\">:</span><span style=\"font-size:10pt; font-family:Consolas; color:#a31515\">ConfigurableWindow</span><span style=\"font-size:10pt; font-family:Consolas; color:blue\">&gt;</span></p>\r\n<p><span style=\"font-size:10pt; line-height:115%; font-family:Consolas\">&nbsp;</span></p>\r\n<p><span style=\"font-size:10pt; line-height:115%; font-family:Consolas\">SkinResource.xaml</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas; color:blue\">&lt;</span><span style=\"font-size:10pt; font-family:Consolas; color:#a31515\">ResourceDictionary</span><span style=\"font-size:10pt; font-family:Consolas; color:red\">\r\n xmlns</span><span style=\"font-size:10pt; font-family:Consolas; color:blue\">=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:red\"><span>&nbsp;</span>xmlns</span><span style=\"color:blue\">:</span><span style=\"color:red\">x</span><span style=\"color:blue\">=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:red\"><span>&nbsp;</span>xmlns</span><span style=\"color:blue\">:</span><span style=\"color:red\">views</span><span style=\"color:blue\">=&quot;clr-namespace:Project.Resources.Views&quot; &gt;</span></span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas; color:#a31515\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span></span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas; color:#a31515\"><span>&nbsp;&nbsp;&nbsp;\r\n</span></span><span style=\"font-size:10pt; font-family:Consolas; color:blue\">&lt;</span><span style=\"font-size:10pt; font-family:Consolas; color:#a31515\">views</span><span style=\"font-size:10pt; font-family:Consolas; color:blue\">:</span><span style=\"font-size:10pt; font-family:Consolas; color:#a31515\">Shell</span><span style=\"font-size:10pt; font-family:Consolas; color:red\">\r\n x</span><span style=\"font-size:10pt; font-family:Consolas; color:blue\">:</span><span style=\"font-size:10pt; font-family:Consolas; color:red\">Key</span><span style=\"font-size:10pt; font-family:Consolas; color:blue\">=&quot;VIEW_MainWindow&quot; /&gt;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\">&nbsp;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas; color:blue\">&lt;/</span><span style=\"font-size:10pt; font-family:Consolas; color:#a31515\">ResourceDictionary</span><span style=\"font-size:10pt; font-family:Consolas; color:blue\">&gt;</span></p>\r\n<p><span style=\"font-size:10pt; line-height:115%; font-family:Consolas\">&nbsp;</span></p>\r\n<p><span style=\"font-size:10pt; line-height:115%; font-family:Consolas\">ShellContainerViewModel.cs</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;\r\n</span>[<span style=\"color:#2b91af\">Export</span>]</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:blue\">public</span> <span style=\"color:blue\">class</span>\r\n<span style=\"color:#2b91af\">ShellContainerViewModel</span></span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>: <span style=\"color:#2b91af\">NotificationObject</span></span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;\r\n</span>{</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;\r\n</span>}</span></p>\r\n<p><span style=\"font-size:10pt; line-height:115%; font-family:Consolas\">&nbsp;</span></p>\r\n<p><span style=\"font-size:10pt; line-height:115%; font-family:Consolas\">Shell.xaml.cs</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;\r\n</span>[<span style=\"color:#2b91af\">Export</span>] // Not sure if this is the correct attribute.</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;\r\n</span>[<span style=\"color:#2b91af\">PartCreationPolicy</span>(<span style=\"color:#2b91af\">CreationPolicy</span>.Shared)]</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:blue\">public</span> <span style=\"color:blue\">partial</span>\r\n<span style=\"color:blue\">class</span> <span style=\"color:#2b91af\">Shell</span></span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>: <span style=\"color:#2b91af\">UserControl</span></span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;\r\n</span>{</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:blue\">public</span> Shell()</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>{</span></p>\r\n<p style=\"margin:0in 0in 0.0001pt 0.5in; text-indent:0.5in; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\">// This is not calling the ViewModel&rsquo;s constructor</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>InitializeComponent();</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>}</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\">&nbsp;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>[<span style=\"color:#2b91af\">Import</span>]</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:blue\">private</span> <span style=\"color:#2b91af\">ShellViewModel</span> ViewModel</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>{</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:blue\">set</span></span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>{</span></p>\r\n<p style=\"margin:0in 0in 0.0001pt 0.5in; text-indent:0.5in; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\">// This is not being called at all.</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:blue\">this</span>.DataContext = <span style=\"color:blue\">\r\nvalue</span>;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>}</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>} </span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;\r\n</span>}</span></p>\r\n<p><span style=\"font-size:10pt; line-height:115%; font-family:Consolas\">&nbsp;</span></p>\r\n<p><span style=\"font-size:10pt; line-height:115%; font-family:Consolas\">ShellViewModel.cs</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;\r\n</span>[<span style=\"color:#2b91af\">Export</span>(<span style=\"color:blue\">typeof</span>(<span style=\"color:#2b91af\">ShellViewModel</span>))]</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;\r\n</span>[<span style=\"color:#2b91af\">PartCreationPolicy</span>(<span style=\"color:#2b91af\">CreationPolicy</span>.Shared)]</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:blue\">public</span> <span style=\"color:blue\">class</span>\r\n<span style=\"color:#2b91af\">ShellViewModel</span> </span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>: <span style=\"color:#2b91af\">NotificationObject</span></span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;\r\n</span>{</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:blue\">private</span> <span style=\"color:#2b91af\">IEventAggregator</span> eventAggregator;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\">&nbsp;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>[<span style=\"color:#2b91af\">ImportingConstructor</span>]</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:blue\">public</span> ShellViewModel(<span style=\"color:#2b91af\">IEventAggregator</span> eventAggregator)</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>{</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:blue\">this</span>.eventAggregator = eventAggregator;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\">&nbsp;</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span>}</span></p>\r\n<p style=\"margin-bottom:0.0001pt; line-height:normal\"><span style=\"font-size:10pt; font-family:Consolas\"><span>&nbsp;&nbsp;&nbsp;\r\n</span>}</span></p>\r\n</div>\r\n",
    "PostedDate": "2010-11-12T18:10:47.247-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "522208",
    "ThreadId": "234536",
    "Html": "\r\n<p>Hi,</p>\r\n<p>A possible reason for that might be that you are creating the Shell window without using MEF. Although the a Shell instance is created, the dependencies will not be injected/composed.&nbsp;</p>\r\n<p>That said, I think that you can find the following links interesting:</p>\r\n<ul>\r\n<li><a href=\"http://mef.codeplex.com/Thread/View.aspx?ThreadId=59576\"><span>MEF and WPF controls with composed imports</span></a>\r\n</li><li><a href=\"http://codebetter.com/blogs/glenn.block/archive/2010/01/15/hosting-mef-within-your-applications.aspx\">Hosting MEF within application and libraries</a>, see the\r\n<em>Using MEF within XAML in WPF </em>section. </li></ul>\r\n<p>Hope this helps.</p>\r\n<p>Fernando Antivero<br>\r\n<a href=\"http://blogs.southworks.net/fantivero\"><span style=\"color:#0066cc\">http://blogs.southworks.net/fantivero</span></a></p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2010-11-15T08:44:31.387-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "522261",
    "ThreadId": "234536",
    "Html": "\r\n<p>Thanks Fernando!</p>\r\n<p>I used the CompositionInitializer port from Silverlight and that did the trick.</p>\r\n<p>Shell.xaml.cs was the only class I needed to modify besides adding the ported code to the project.</p>\r\n<p>&nbsp;</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:green\">// Shell.xaml.cs</span>\r\n\r\n[PartCreationPolicy(CreationPolicy.Shared)]\r\n<span style=\"color:blue\">public</span> <span style=\"color:blue\">partial</span> <span style=\"color:blue\">class</span> Shell\r\n    : UserControl\r\n{\r\n    <span style=\"color:blue\">public</span> Shell()\r\n    {\r\n        <span style=\"color:green\">// This is not calling the ViewModel's constructor</span>\r\n        InitializeComponent();\r\n\r\n        CompositionInitializer.SatisfyImports(<span style=\"color:blue\">this</span>);\r\n    }\r\n\r\n    [Import(<span style=\"color:blue\">typeof</span>(ShellViewModel))]\r\n    <span style=\"color:blue\">private</span> ShellViewModel ViewModel\r\n    {\r\n        <span style=\"color:blue\">set</span>\r\n        {\r\n            <span style=\"color:blue\">this</span>.DataContext = value;\r\n        }\r\n    } \r\n}\r\n</pre>\r\n</div>\r\n<p></p>\r\n",
    "PostedDate": "2010-11-15T10:59:23.917-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "522802",
    "ThreadId": "234536",
    "Html": "\r\n<p>Hi,</p>\r\n<p>Nice to see that you found a solution for your scenario and thanks for sharing this with the rest of the community. This might help other users with a similar situation.</p>\r\n<p>Additionally, I would like to share the following links:</p>\r\n<ul>\r\n<li><a href=\"http://mef.codeplex.com/wikipage?title=CompsitionInitializer\">Hosting MEF in Silverlight</a>\r\n</li><li><a href=\"http://mef.codeplex.com/Thread/View.aspx?ThreadId=207539\"><span>CompositionInitializer and ExportFactory for the desktop\r\n</span></a></li></ul>\r\n<p>Let me know if you have any other question.</p>\r\n<p>Fernando Antivero<br>\r\n<a href=\"http://blogs.southworks.net/fantivero\"><span style=\"color:#0066cc\">http://blogs.southworks.net/fantivero</span></a></p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2010-11-16T09:59:43.247-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]