[
  {
    "Id": "789827",
    "ThreadId": "336511",
    "Html": "\r\n<p>I want to Check authorization before load the view. if no authorization, the view will not show.</p>\r\n<p>I use below code, it just show error message, but not to stop show the view</p>\r\n<p>&nbsp;</p>\r\n<p>NavbarViewModel: &nbsp;</p>\r\n<p></p>\r\n<pre><span style=\"background-color:white\">  </span><span style=\"color:blue\">private</span><span style=\"background-color:white\"> </span><span style=\"color:blue\">void</span><span style=\"background-color:white\"> NavItemDoubleClick(</span><span style=\"color:blue\">object</span><span style=\"background-color:white\"> navItem)</span></pre>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>        {\r\n            <span style=\"color:blue\">if</span> (navItem == <span style=\"color:blue\">null</span>) <span style=\"color:blue\">return</span>;\r\n            NavMainMenuInfo item = navItem <span style=\"color:blue\">as</span> NavMainMenuInfo;\r\n            <span style=\"color:blue\">if</span> (<span style=\"color:blue\">string</span>.IsNullOrEmpty(item.ViewName))\r\n                <span style=\"color:blue\">return</span>;\r\n           \r\n            <span style=\"color:blue\">this</span>.regionManager.RequestNavigate(RegionNames.DocumentRegion, <span style=\"color:blue\">new</span> Uri(item.ViewName, UriKind.Relative),</pre>\r\n</div>\r\n<p></p>\r\n<pre>NavigationCompleted</pre>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>);\r\n                    \r\n        }\r\n         \r\n    \r\n        <span style=\"color:blue\">private</span> <span style=\"color:blue\">void</span> NavigationCompleted(NavigationResult result)\r\n        {\r\n            <span style=\"color:blue\">if</span> (result.Error != <span style=\"color:blue\">null</span>)\r\n                MessageBox.Show(Error.Message);\r\n            \r\n            IsBusy = <span style=\"color:blue\">false</span>;\r\n            \r\n        }\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>UnitViewModel:</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>    <span style=\"color:blue\">public</span> <span style=\"color:blue\">void</span> OnNavigatedTo(NavigationContext navigationContext)\r\n        {\r\n            <span style=\"color:blue\">if</span>(!(Csla.Rules.BusinessRules.HasPermission(Csla.Rules.AuthorizationActions.GetObject, <span style=\"color:blue\">typeof</span>(Unit))))\r\n                <span style=\"color:blue\">throw</span> <span style=\"color:blue\">new</span> Exception(<span style=\"color:#a31515\">&quot;...&quot;</span>);\r\n\r\n            <span style=\"color:blue\">if</span> (<span style=\"color:blue\">this</span>.Model == <span style=\"color:blue\">null</span>)\r\n            {\r\n                IsBusy = <span style=\"color:blue\">true</span>;\r\n                BeginRefresh(callback =&gt; UnitList.GetAll(callback));\r\n            }\r\n        }\r\n</pre>\r\n</div>\r\ni\r\n<p></p>\r\n",
    "PostedDate": "2012-02-21T06:29:12.177-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "798081",
    "ThreadId": "336511",
    "Html": "<p>Hi,</p>\r\n<p>Based on my understanding, the <strong>OnNavigatedTo </strong>method is invoked after the view has been constructed, injected in the region and activated. Based on this, it seems that you are checking the \"authorization\" to show the view <strong><em>after </em></strong>the view was already shown. You can find more information about the navigation sequence in the following section of the Prism documentation:</p>\r\n<ul>\r\n<li><a href=\"http://msdn.microsoft.com/en-us/library/gg430861%28PandP.40%29.aspx#sec15\">Chapter 8: Navigation - The Region Navigation Sequence</a></li>\r\n</ul>\r\n<p>As a possible approach you could check if the user has authorization to see the view <em><strong>before </strong></em>performing the navigation request and if the the view must not be shown, the view <strong>RequestNavigate </strong>method is not invoked. Regarding this approach, I believe you could find the following thread useful, where a similar concern is being discussed:</p>\r\n<ul>\r\n<li><a href=\"http://compositewpf.codeplex.com/discussions/286367\">RegionManager.RequestNavigate or other mean to control security?</a></li>\r\n</ul>\r\n<p>I hope you find this useful,</p>\r\n<p>Damian Cherubini<br /> <a href=\"http://blogs.southworks.net/dcherubini\">http://blogs.southworks.net/dcherubini</a></p>",
    "PostedDate": "2012-02-23T11:40:16.043-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]