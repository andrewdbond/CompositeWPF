[
  {
    "Id": "160834",
    "ThreadId": "48192",
    "Html": "Hi list,<br>\r\nwhat i have:<br>\r\nMy Shell Form and a hard wired UserControl within the Shell. This UC should act as may MainMenu<br>\r\n<span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">\r\n<p>Is there any chance to load and run Modules from within this UserControl. I think ybout using <span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">\r\n<p>&nbsp;</p>\r\n<p>IModuleManager</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px\"> moduleManager or stuff like this but have no idea how to get a reference to IModulManager.\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p></p>\r\n</span>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px\">Thanks in advance<br>\r\n Peter\r\n<p>&nbsp;</p>\r\n</span></p>\r\n",
    "PostedDate": "2009-02-22T23:32:50.273-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "161045",
    "ThreadId": "48192",
    "Html": "<p style=\"margin:0in 0in 0pt\"><span style=\"font-family:calibri\">Hi Peter,</span></p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-family:calibri\">The following article explains how to load modules on demand using the <b>IModuleManager</b> interface:</span></p>\r\n<p style=\"margin:0in 0in 0pt 0.5in\"><span style=\"font-family:symbol\">·<span style=\"font:7pt 'times new roman'\">         </span><a href=\"http://msdn.microsoft.com/en-us/library/dd458932.aspx\"><span style=\"font-family:calibri\">How to: Load Modules on Demand</span></a>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0in 0in 0pt -0.6pt\"><span style=\"font-family:calibri\">You could also check the </span><a href=\"http://msdn.microsoft.com/en-us/library/dd458909.aspx\"><span style=\"font-family:calibri\">Modularity QuickStarts</span></a><span style=\"font-family:calibri\"> shipped with the Prism v2 release to see different sample implementations.</span></p>\r\n<p style=\"margin:0in 0in 0pt -0.6pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0in 0in 0pt -0.6pt\"><span style=\"font-family:calibri\">Please let me know if this helps.</span></p>\r\n<p style=\"margin:0in 0in 0pt -0.6pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0in 0in 0pt -0.6pt\"><span style=\"font-family:calibri\">Mariano Converti</span></p>\r\n<p style=\"margin:0in 0in 0pt\"><a href=\"http://blogs.southworks.net/mconverti\"><span style=\"font-family:calibri\">http://blogs.southworks.net/mconverti</span></a> </p>\r\n</span></p>\r\n",
    "PostedDate": "2009-02-23T10:31:49.373-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "161297",
    "ThreadId": "48192",
    "Html": "<p>Hi Mariano,</p>\r\n<p>and thanks for your reply.</p>\r\n<p>What i did is as follows.<br>\r\n<span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">\r\n<p>&nbsp;</p>\r\n<p>Bootstrapper.cs :<br>\r\n<br>\r\nprotected</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">override</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\">IModuleCatalog</span><span style=\"font-size:13px\"> GetModuleCatalog()\r\n<p>&nbsp;</p>\r\n<p>{</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#2b91af\">ModuleCatalog</span><span style=\"font-size:13px\"> catalog = </span><span style=\"font-size:13px;color:#0000ff\">new</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\">ModuleCatalog</span><span style=\"font-size:13px\">();\r\n<p>&nbsp;</p>\r\n<p>catalog.AddModule(</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">typeof</span><span style=\"font-size:13px\">(</span><span style=\"font-size:13px;color:#2b91af\">EmployeeModule</span><span style=\"font-size:13px\">), </span><span style=\"font-size:13px;color:#a31515\">&quot;EmployeeModule&quot;</span><span style=\"font-size:13px\">);\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">return</span><span style=\"font-size:13px\"> catalog;\r\n<p>&nbsp;</p>\r\n<p>}<br>\r\n<br>\r\nShell:<br>\r\n<span style=\"font-size:13px;color:#0000ff\">public</span><span style=\"font-size:13px\"> Shell(</span><span style=\"font-size:13px;color:#2b91af\">IModuleManager</span><span style=\"font-size:13px\"> moduleManager)\r\n<p>&nbsp;</p>\r\n<p>{</p>\r\n<p>InitializeComponent();</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">this</span><span style=\"font-size:13px\">.moduleManager = moduleManager;\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">this</span><span style=\"font-size:13px\">.moduleManager.LoadModule(</span><span style=\"font-size:13px;color:#a31515\">&quot;EmployeeModule&quot;</span><span style=\"font-size:13px\">); &lt;&lt; here i get a error\r\n<p>&nbsp;</p>\r\n<p>}<br>\r\n<br>\r\nErrorMessage:<br>\r\nResolution of the dependency failed, type = &quot;BaseShell.Shell&quot;, name = &quot;&quot;. Exception message is: The current build operation (build key Build Key[BaseShell.Shell, null]) failed: At least one cyclic dependency has been found in the module catalog. Cycles in the module dependencies must be avoided. (Strategy type BuildPlanStrategy, index 3)<br>\r\nany idea?<br>\r\n<br>\r\nThanks<br>\r\nPeter<br>\r\n</p>\r\n</span></p>\r\n</span></p>\r\n",
    "PostedDate": "2009-02-24T00:08:56.363-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "161367",
    "ThreadId": "48192",
    "Html": "Hi, the problem is the 2nd parameter in the AddModule call.<br>\r\nThis parameter refers to the dependencies of the module you are adding:<br>\r\n<p>catalog.AddModule(<span style=\"color:#0000ff;font-size:13px\">typeof</span><span style=\"font-size:13px\">(</span><span style=\"color:#2b91af;font-size:13px\">EmployeeModule</span><span style=\"font-size:13px\">), </span><span style=\"color:#a31515;font-size:13px\">&quot;EmployeeModule&quot;</span><span style=\"font-size:13px\">);</span> <br>\r\n<br>\r\nSo this means EmployeeModule depends on EmployeeModule. When you are using typeof to add modules, the module name is inferred from the type, so using the following would be correct:</p>\r\n<p>catalog.AddModule(<span style=\"color:#0000ff;font-size:13px\">typeof</span><span style=\"font-size:13px\">(</span><span style=\"color:#2b91af;font-size:13px\">EmployeeModule</span><span style=\"font-size:13px\">)</span><span style=\"font-size:13px\">);</span> <br>\r\n<br>\r\nI hope this helps,<br>\r\nJulian Dominguez<br>\r\n<a href=\"http://blogs.southworks.net/jdominguez\">http://blogs.southworks.net/jdominguez</a></p>\r\n",
    "PostedDate": "2009-02-24T04:15:14.237-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "161372",
    "ThreadId": "48192",
    "Html": "Hi,<br>\r\nthanks for you reply. this problem is solved but the next is already here.<br>\r\nif i use:<br>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#0000ff\">protected</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">override</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\">IModuleCatalog</span><span style=\"font-size:13px\"> GetModuleCatalog()\r\n<p>&nbsp;</p>\r\n<p>{</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#2b91af\">ModuleCatalog</span><span style=\"font-size:13px\"> catalog = </span><span style=\"font-size:13px;color:#0000ff\">new</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\">ModuleCatalog</span><span style=\"font-size:13px\">();\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#008000\">//catalog.AddModule(typeof(EmployeeModule), InitializationMode.OnDemand);\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>catalog.AddModule(</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#0000ff\">typeof</span><span style=\"font-size:13px\">(</span><span style=\"font-size:13px;color:#2b91af\">EmployeeModule</span><span style=\"font-size:13px\">));\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">return</span><span style=\"font-size:13px\"> catalog;\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>}<br>\r\nthis version, the in '<span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">\r\n<p>&nbsp;</p>\r\n<p>protected</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">override</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">void</span><span style=\"font-size:13px\"> InitializeModules() in bootstrapper.cs is called an all is ok.<br>\r\n<p>&nbsp;</p>\r\n<p>But if i use the other line '<span style=\"font-size:13px;color:#008000\">catalog.AddModule(typeof(EmployeeModule), InitializationMode.OnDemand);'  i got a crash in Employee.<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n<p>Initialize()  'The region manager does not contain the MainRegion region.'. It seems to me that regionmanager is initialized 'very' late.<br>\r\n<br>\r\nIn Shell.cam.cs i make <br>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">private</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">void</span><span style=\"font-size:13px\"> Window_Loaded(</span><span style=\"font-size:13px;color:#0000ff\">object</span><span style=\"font-size:13px\"> sender, </span><span style=\"font-size:13px;color:#2b91af\">RoutedEventArgs</span><span style=\"font-size:13px\"> e)\r\n<p>&nbsp;</p>\r\n<p>{</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">this</span><span style=\"font-size:13px\">.moduleManager.LoadModule(</span><span style=\"font-size:13px;color:#a31515\">&quot;EmployeeModule&quot;</span><span style=\"font-size:13px\">);<br>\r\n.......<br>\r\n<br>\r\n<br>\r\nPeter<br>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n</span></span></p>\r\n</span></p>\r\n</span></p>\r\n",
    "PostedDate": "2009-02-24T04:32:42.61-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "161376",
    "ThreadId": "48192",
    "Html": "I'm not sure I follow the code because it is strangely formatted.<br>\r\nAre you trying to load a module on demand when the shell window has finished loading?<br>\r\nWhy do you need this / what is the scenario? Why make it on demand at all?<br>\r\n<br>\r\nThere is a timing thing here, and it is that the regions get registered after the CreateShell method in the bootstrapper has finished.<br>\r\nAlso GetModuleCatalog and InitializeModules get called after the shell was created, so the modules should not be available at this point.<br>\r\n<br>\r\nIf you are trying to add a region into a window that is not the main shell, then you might want to explicitely set the RegionManager attached property on the window, in order for it to register it regions there, like in the following:<br>\r\n<br>\r\npublic MyWindow(IRegionManager regionManager)<br>\r\n{<br>\r\n  RegionManager.SetRegionManager(this, regionManager);<br>\r\n}<br>\r\n<br>\r\nIf these are not your issues, please provide more context so we can help you better.<br>\r\nRegards,<br>\r\nJulian\r\n",
    "PostedDate": "2009-02-24T04:44:47.94-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "161782",
    "ThreadId": "48192",
    "Html": "<p>Hi Julian</p>\r\n<p>and very sorry about that ugly example.</p>\r\n<p>You are right, it was a timing problem. As soon is i add a buuton to Shell and put the '<span style=\"font-size:13px;color:#0000ff\">this</span><span style=\"font-size:13px\">.moduleManager.LoadModule(</span><span style=\"font-size:13px;color:#a31515\">&quot;EmployeeModule&quot;</span><span style=\"font-size:13px\">);' inside Button_Click the suff works.<br>\r\nThanks a lot<br>\r\nPeter<br>\r\n<br>\r\n</span></p>\r\n",
    "PostedDate": "2009-02-24T23:17:18.453-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]