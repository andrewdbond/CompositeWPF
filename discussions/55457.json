[
  {
    "Id": "187253",
    "ThreadId": "55457",
    "Html": "Hi All,<br>\r\nWe are using Prism 2.0 for my development.We have more than two modules in a application. Presently we need to open a module in another shell (May be a new instance of the shell). I tried using Process to open up new Shell. But I am not able to load the module in the startup.<br>\r\n<br>\r\nTake Microsoft Outlook for example. We can open the Calendar in new window. Here the complete Outlook is duplicated and opened as Calendar. You can navigate to Mail, etc.<br>\r\n<br>\r\nProcess p = new Process();<br>\r\np.StartInfo.FileName = System.Reflection.Assembly.GetEntryAssembly().Location;<br>\r\np.StartInfo.CreateNoWindow = false;<br>\r\np.StartInfo.UseShellExecute = true;<br>\r\np.StartInfo.Arguments = query;            <br>\r\np.Start();<br>\r\n",
    "PostedDate": "2009-05-06T01:32:06.11-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "187781",
    "ThreadId": "55457",
    "Html": "<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">Hi, </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">I don't know you exact scenario, but I think you have mainly two options depending that your exact needs.</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span><span style=\"font-family:calibri\">If what you need for your application is to open a new window and have a module load views, regions, etc, into it, you might find useful the <b>RegionPopupBehaviors</b> used in the </span><a href=\"http://msdn.microsoft.com/en-us/library/dd458919.aspx\"><span style=\"color:#0000ff;font-family:calibri\">Stock Trader RI</span></a><span style=\"font-family:calibri\"> sample. The following thread deal with similar situations:</span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span style=\"font-family:symbol\">·<span style=\"font:7pt 'times new roman'\">         </span><a href=\"http://compositewpf.codeplex.com/Thread/View.aspx?ThreadId=54812\"><span style=\"font-family:calibri\">Popup Region</span></a>\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span style=\"font-family:symbol\">·<span style=\"font:7pt 'times new roman'\">         </span><span style=\"color:#30332d\"><a href=\"http://compositewpf.codeplex.com/Thread/View.aspx?ThreadId=48199\"><span style=\"font-family:calibri\">Showing a view in a region vs a modal dialog</span></a></span>\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">If what you need for your application is to open a completely new application, you can use the approach you are suggesting. I used your code to reproduce your scenario (without the </span><span style=\"font-size:9.5pt;font-family:'courier new'\">p.StartInfo.Arguments = query; </span><span style=\"font-family:calibri\">line</span><span style=\"font-size:9.5pt;font-family:'segoe ui','sans-serif'\">) </span><span style=\"font-family:calibri\">and was able launched another instance of the application. To keep things decoupled I created a LoadApplication service that executes your code and called the service when a button is clicked.</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'courier new'\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">Hope it helps!</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">Matias Bonaventura</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><a href=\"http://blogs.southworks.net/\"><span style=\"font-family:calibri\">http://blogs.southworks.net/matiasb</span></a> </p>\r\n</span></p>\r\n</span></p>\r\n",
    "PostedDate": "2009-05-07T09:15:22.617-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "187816",
    "ThreadId": "55457",
    "Html": "Hi Matias,<br>\r\nThanks for trying the code block. &quot;query&quot; has the commandline arguments to open the selected module on startup and also suppress the login for the new instance of the application. <br>\r\n<br>\r\nI am not trying to open a module/view in new window (Popup/Modal dialog). I am trying to open the same shell in as a new process.<br>\r\n<br>\r\nFor example, I have,<br>\r\n- Shell<br>\r\n- Module 1 (load on demand)<br>\r\n- Module 2 (load on demand)<br>\r\n<br>\r\nFirst, I opened the Shell and clicked the Module 1 menu and it got loaded in the Workspace region. Again when I click Module 2, it should open in a new shell. Since I used p.StartInfo.FileName = System.Reflection.Assembly.GetEntryAssembly().Location, loading Module 2 will fail (all the modules are set to load on demand).<br>\r\n<br>\r\nHere the ApplicationDeployment.IsNetworkDeployed will\r\nbe false and getting\r\nApplicationDeployment.CurrentDeployment.UpdateLocation is not possible to read and download the manifests and Module 2 binaries.<br>\r\n<br>\r\nI changed System.Reflection.Assembly.GetEntryAssembly().Location to ApplicationDeployment.CurrentDeployment.ActivationUri (*.application location). I am facing two problems here.<br>\r\n1. This would work only after deployment and also the Shell should be activated/opened from the URL. But my application can be used in offline.<br>\r\n2. It always opens a IE to execute the ApplicationDeployment.CurrentDeployment.ActivationUri and then the Shell is invoked.<br>\r\n<br>\r\n<br>\r\n<br>\r\nIs anyone has solution for this?<br>\r\n",
    "PostedDate": "2009-05-07T11:20:44.84-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]