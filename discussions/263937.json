[
  {
    "Id": "637448",
    "ThreadId": "263937",
    "Html": "\r\n<p>Hi,</p>\r\n<p>we want to use the PRISM bootstrapper with a configuration file (app.config).</p>\r\n<p>All PRISM modules shall be configured in this configuration file.<br>\r\nAdditional we want to configure dependencies of this modules via unity configuration in this configuration file.</p>\r\n<p>How can we bring the two configurations together? In other words: how can we tell the bootstrapper to get modules dependencies from unity configuration?</p>\r\n<p>Snippet of configuration file. ILogger is configured in the unity section.The module Navigation has a dependency of that ILogger. Can bootstrapper resolve this dependency without custom code?</p>\r\n<pre style=\"font-family:Consolas; font-size:13; color:black; background:white\"><span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color:#a31515\">container</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color:#a31515\">register</span><span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">type</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">IShell</span>&quot;<span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">mapTo</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">Shell</span>&quot;<span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color:#a31515\">lifetime</span><span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">type</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">singleton</span>&quot;<span style=\"color:blue\">/&gt;</span>\r\n<span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span style=\"color:#a31515\">register</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color:#a31515\">register</span><span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">type</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">ILogger</span>&quot;<span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">mapTo</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">Logger</span>&quot;<span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color:#a31515\">lifetime</span><span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">type</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">singleton</span>&quot;<span style=\"color:blue\">/&gt;</span>\r\n<span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span style=\"color:#a31515\">register</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color:#a31515\">register</span><span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">type</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">ILoggerFacade</span>&quot;<span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">mapTo</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">Logger</span>&quot;<span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color:#a31515\">lifetime</span><span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">type</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">singleton</span>&quot;<span style=\"color:blue\">/&gt;</span>\r\n<span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span style=\"color:#a31515\">register</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span style=\"color:#a31515\">container</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&nbsp;&nbsp;&lt;/</span><span style=\"color:#a31515\">unity</span><span style=\"color:blue\">&gt;</span>\r\n \r\n<span style=\"color:blue\">&nbsp;&nbsp;&lt;</span><span style=\"color:#a31515\">modules</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color:#a31515\">module</span><span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">assemblyFile</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">Gui.Common.dll</span>&quot;<span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">moduleType</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">Gui.Common.Navigation</span>&quot;<span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">moduleName</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">Navigation</span>&quot;<span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">startupLoaded</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">false</span>&quot;<span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&nbsp;&nbsp;&nbsp; &lt;/</span><span style=\"color:#a31515\">module</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&nbsp;&nbsp;&lt;/</span><span style=\"color:#a31515\">modules</span><span style=\"color:blue\">&gt;<br><br>Snippet from Navigation code<br><br>class Navigation<br>{<br> [Dependancy(ILogger)]<br> ILogger Logger<br> {get;set;}<br>}<br><br><span style=\"color:#000000\">TIA, Matthias</span><br></span></pre>\r\n",
    "PostedDate": "2011-07-05T05:41:58.18-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "637511",
    "ThreadId": "263937",
    "Html": "<p>Hi Matthias,</p>\r\n<p>In order to achieve what you're mentioining, you need to indicate the Unity container that it's going to retrieve the mappings from the configuration file, which should be done in the <strong>ConfigureContainer </strong>method in the <strong>Bootstrapper </strong>(which can be overriden).</p>\r\n<p>You might find the following article useful, as it shows how to configure Unity from a separate configuration file (which should help keeping concerns clear, as the Unity configuration will be separated from the modules' configuration):</p>\r\n<p><a href=\"http://www.pnpguidance.net/post/UnityConfigurationSeparateConfigurationFile.aspx\"><span id=\"ctl00_ContentPlaceHolder1_ThePostTitle\">Unity Configuration from Separate Configuration File</span></a></p>\r\n<p>Therefore, since the container is configured before the modules are loaded, at the time you load your modules, the mappings will be in place and your module's dependencies will be resolved.</p>\r\n<p>I hope you find this helpful.</p>\r\n<p>Guido Leandro Maliandi <br /> <a href=\"http://blogs.southworks.net/gmaliandi\">http://blogs.southworks.net/gmaliandi</a></p>",
    "PostedDate": "2011-07-05T07:26:43.28-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "637925",
    "ThreadId": "263937",
    "Html": "<p>Hi Guido,</p>\r\n<p>thank you for answering. My problem is not to load unity containers from various files.</p>\r\n<p>My bootstrapper container (UnityContainer since the bootstrapper derives from UnityBootstrapper)is initialized with the default configuration (IServiceLocator, IModuleCatalog etc) and additional with a unity section:</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\"><pre>public class Bootstrapper:UnityBootstrapper\r\n{\r\n  ...</pre>\r\n<br />protected</span> <span style=\"color: blue;\">override</span> <span style=\"color: blue;\">void</span> ConfigureContainer() {   <span style=\"color: blue;\">base</span>.ConfigureContainer();   <span style=\"color: blue;\">var</span> unitySection = ConfigurationManager.GetSection(<span style=\"color: #a31515;\">\"unity\"</span>) <span style=\"color: blue;\">as</span> UnityConfigurationSection;   unitySection.Configure(<span style=\"color: blue;\">base</span>.Container); }</pre>\r\n</div>\r\n</p>\r\n<p>The bootstrapper container now has several additional (to the default mappings) type mappings in its Container. One of them is a mapping \"ILogger\" that is mapped to my implementation of an EntLib logger. The unity section where the logger is configured looks like that:</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">unity</span><span style=\"color: blue;\">&gt;</span>\r\n <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">container</span><span style=\"color: blue;\">&gt;</span>\r\n   <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">register</span> <span style=\"color: red;\">type</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">ILogger</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">mapTo</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">ACustomLogger</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">/&gt;</span>\r\n <span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">container</span><span style=\"color: blue;\">&gt;</span>\r\n<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">unity</span><span style=\"color: blue;\">&gt;</span>\r\n</pre>\r\n</div>\r\n</p>\r\n<p>No I want the bootstrapper to create the modules from the same configuration in the modules section. Therefore I tell the bootstrapper to load the ModuleCatalog from the configuration file.</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>\r\n<span style=\"color: blue;\">public</span> <span style=\"color: blue;\">class</span> Bootstrapper:UnityBootstrapper\r\n{\r\n ...\r\n <span style=\"color: blue;\">protected</span> <span style=\"color: blue;\">override</span> IModuleCatalog CreateModuleCatalog()\r\n {\r\n   <span style=\"color: blue;\">return</span> <span style=\"color: blue;\">new</span> ConfigurationModuleCatalog();\r\n }\r\n ...\r\n</pre>\r\n</div>\r\n</p>\r\n<p>The module section in the configuration file looks like this:</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">modules</span><span style=\"color: blue;\">&gt;</span>\r\n <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">module</span> <span style=\"color: red;\">assemblyFile</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">Modules.dll</span><span style=\"color: black;\">\"</span>\r\n   <span style=\"color: red;\">moduleType</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">Modules.Navigation, Modules</span><span style=\"color: black;\">\"</span>\r\n   <span style=\"color: red;\">moduleName</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">Navigation</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">/&gt;</span>\r\n ...\r\n</pre>\r\n</div>\r\n</p>\r\n<p>The bootstrapper loads the module Navigation and displays it in the region - all is fine so far.</p>\r\n<p>But now I want the module Navigation to get a dependancy resolved from the bootstappers Catalog. Here is the Navigation class with the dependancy that is defined in the unity section and is mapped in the bootstrappers catalog:</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">public</span> <span style=\"color: blue;\">class</span> Navigation:IModule\r\n{\r\n ... \r\n [Dependency()]\r\n <span style=\"color: blue;\">private</span> ILogger Logger\r\n {\r\n  <span style=\"color: blue;\">get</span>;\r\n  <span style=\"color: blue;\">set</span>;\r\n }\r\n ...\r\n</pre>\r\n</div>\r\n</p>\r\n<p>The Logger property is alwas null since the module catalog does not lokk for dependancies in the UnityCatalog. How can I achieve the resolution of dependancies without custom code?</p>\r\n<p>TIA, Matthias</p>",
    "PostedDate": "2011-07-06T00:47:16.827-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "637946",
    "ThreadId": "263937",
    "Html": "<p>Sorrs, sorry, sorry!</p>\r\n<p>Now as I read my own posting, I hardly believe what I see.<br />Obviously even Unity can not access privat properties...</p>\r\n<p>When I change the Navigations Logger property to public it works fine.</p>\r\n<p>Thank you for your time Guido.</p>\r\n<p>&nbsp;</p>\r\n<p>Regards, Matthias</p>",
    "PostedDate": "2011-07-06T01:24:47.423-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]