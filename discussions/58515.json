[
  {
    "Id": "198017",
    "ThreadId": "58515",
    "Html": "<p>Hello,</p>\r\n<p>I am using Prism in my application and I am using NUnit to test my code. &nbsp;I like using NUnit, because it lets me test things like my ViewModels without the overhead of the entire Silverlight runtime being executed. &nbsp;</p>\r\n<p>The problem I am running in to is that DelegateCommand.RaiseCanExecuteChanged calls into Deployment.Current which throws an exception in my unit test environment... I'm not surprised, since there is no current application in a unit test.</p>\r\n<p>Aside from removing it from the DelegateCommand.Silverlight.cs:OnExecuteChanged(), does anyone know a way around this?</p>\r\n<p>Here is my stack trace:</p>\r\n<p>\r\n<p style=\"margin:0.0px 0.0px 0.0px 0.0px;font:8.0px Helvetica\">failed: System.Exception : Catastrophic failure (Exception from HRESULT: 0x8000FFFF (E_UNEXPECTED))</p>\r\n<p style=\"margin:0.0px 0.0px 0.0px 0.0px;font:8.0px Helvetica\"><span style=\"white-space:pre\"> </span>at MS.Internal.XcpImports.CheckHResult(UInt32 hr)</p>\r\n<p style=\"margin:0.0px 0.0px 0.0px 0.0px;font:8.0px Helvetica\"><span style=\"white-space:pre\"> </span>at MS.Internal.XcpImports.Deployment_GetCurrent(IntPtr&amp; pDeployment)</p>\r\n<p style=\"margin:0.0px 0.0px 0.0px 0.0px;font:8.0px Helvetica\"><span style=\"white-space:pre\"> </span>at System.Windows.Deployment.get_Current()</p>\r\n<p style=\"margin:0.0px 0.0px 0.0px 0.0px;font:8.0px Helvetica\"><span style=\"white-space:pre\"> </span>at Microsoft.Practices.Composite.Presentation.Commands.DelegateCommand`1.OnCanExecuteChanged()</p>\r\n<p style=\"margin:0.0px 0.0px 0.0px 0.0px;font:8.0px Helvetica\"><span style=\"white-space:pre\"> </span>at Microsoft.Practices.Composite.Presentation.Commands.DelegateCommand`1.RaiseCanExecuteChanged()</p>\r\n<p style=\"margin:0.0px 0.0px 0.0px 0.0px;font:8.0px Helvetica\"><span style=\"white-space:pre\"> </span>C:\\Users\\BRIAN GENISIO\\Documents\\Visual Studio 2008\\Projects\\RecipeBox\\RecipeBox\\RecipeList\\RecipeListViewModel.cs(82,0): at RecipeBox.RecipeList.RecipeListViewModel.set_SearchText(String value)</p>\r\n<p style=\"margin:0.0px 0.0px 0.0px 0.0px;font:8.0px Helvetica\"><span style=\"white-space:pre\"> </span>C:\\Users\\BRIAN GENISIO\\Documents\\Visual Studio 2008\\Projects\\RecipeBox\\RecipeBoxTests\\RecipeBox\\RecipeListViewModelTests.cs(132,0): at RecipeBoxTests.RecipeBox.RecipeListViewModelTests.Search_With_Two_Pages_Requests_Second_Page()</p>\r\n<div><span style=\"font-family:Helvetica;font-size:xx-small\"><span style=\"font-size:8px\"><span style=\"font-family:'Segoe UI';font-size:small\"><span style=\"font-size:13px\"><br></span></span></span></span></div>\r\n</p>",
    "PostedDate": "2009-06-04T19:23:28.423-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "198397",
    "ThreadId": "58515",
    "Html": "<p style=\"margin:0cm 0cm 0pt\"><span style=\"\" lang=EN-US><span style=\"font-size:small\"><span style=\"font-family:Calibri\">Hi BrianGenisio, </span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"\" lang=EN-US><span style=\"font-size:small;font-family:Calibri\">&nbsp;</span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"\" lang=EN-US><span style=\"font-size:small\"><span style=\"font-family:Calibri\">I don't know what functionality you are trying to test, but if you need to use NUnit one way you can workarround this unavailable current application is creating a MockDelegateCommand. </span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"\" lang=EN-US><span style=\"font-size:small;font-family:Calibri\">&nbsp;</span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"\" lang=EN-US><span style=\"font-size:small\"><span style=\"font-family:Calibri\">In most usual scenarios you won't need during the test the ExecuteChanged functionallity that is implemented in the&nbsp;prism DelegateCommand. So, to easily create a mock of the delegate command you can create a mock class that inherits from the prism <strong>DelegateCommand</strong> and overrides the necessary methods (in your case, you might override the <strong>OnExecuteChanged</strong> method). If the method you need to mock is not available to override you can implement the <strong>ICommand</strong> interface to mock the command.</span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"\" lang=EN-US><span style=\"font-size:small\"><span style=\"font-family:Calibri\">Hope it helps!</span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"\" lang=EN-US><span style=\"font-size:small;font-family:Calibri\">&nbsp;</span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:small\"><span style=\"font-family:Calibri\">Matias Bonaventura</span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><a href=\"http://blogs.southworks.net/\"><span style=\"font-size:small;font-family:Calibri\">http://blogs.southworks.net/matiasb</span></a></p>",
    "PostedDate": "2009-06-05T13:12:16.947-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]