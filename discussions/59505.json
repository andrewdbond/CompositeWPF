[
  {
    "Id": "201463",
    "ThreadId": "59505",
    "Html": "<p>Hi,</p>\r\n<p>I develop a XBAP application, that should run in partial trusted mode (internet zone) using the CAL framework. And I have to load modules on demand.</p>\r\n<p>The following code works fine when I start the application in full trusted mode:</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>    <span style=\"color:Blue\">public</span> <span style=\"color:Blue\">partial</span> <span style=\"color:Blue\">class</span><span style=\"color:MediumTurquoise\"> Bootstrapper : UnityBootstrapper\r\n    </span>{\r\n        <span style=\"color:Blue\">protected</span> <span style=\"color:Blue\">override</span> IModuleCatalog GetModuleCatalog()\r\n        {\r\n            ModuleCatalog catalog = <span style=\"color:Blue\">new</span> ModuleCatalog();\r\n\r\n            <span style=\"color:Blue\">const</span> <span style=\"color:Blue\">string</span> moduleAssemblyQualifiedName1 = <span style=\"color:#A31515\">&quot;DeviceManager.DeviceManagerModule, DeviceManager, Version=1.0.0.0, Culture=neutral, PublicKeyToken=81447ee4612243af&quot;</span>;\r\n            catalog.AddModule(<span style=\"color:#A31515\">&quot;DeviceManager&quot;</span>, moduleAssemblyQualifiedName1, InitializationMode.OnDemand);\r\n\r\n            <span style=\"color:Blue\">const</span> <span style=\"color:Blue\">string</span> moduleAssemblyQualifiedName2 = <span style=\"color:#A31515\">&quot;NodeManager.NodeManagerModule, NodeManager, Version=1.0.0.0, Culture=neutral, PublicKeyToken=81447ee4612243af&quot;</span>;\r\n            catalog.AddModule(<span style=\"color:#A31515\">&quot;NodeManager&quot;</span>, moduleAssemblyQualifiedName2, InitializationMode.OnDemand);\r\n\r\n            <span style=\"color:Blue\">return</span> catalog;\r\n        }\r\n\r\n        <span style=\"color:Blue\">protected</span> <span style=\"color:Blue\">override</span> <span style=\"color:Blue\">void</span> ConfigureContainer()\r\n        {\r\n            <span style=\"color:Blue\">base</span>.ConfigureContainer();\r\n        }\r\n\r\n        <span style=\"color:Blue\">protected</span> <span style=\"color:Blue\">override</span> DependencyObject CreateShell()\r\n        {   \r\n            ShellPresenter presenter = Container.Resolve&lt;ShellPresenter&gt;();\r\n            ShellMainPage shell = presenter.View <span style=\"color:Blue\">as</span> ShellMainPage;\r\n\r\n            Container.RegisterInstance&lt;IShellView&gt;(<span style=\"color:#A31515\">&quot;ShellView&quot;</span>, shell);\r\n  \r\n            NavigationWindow parent = shell.Parent <span style=\"color:Blue\">as</span> NavigationWindow;\r\n            parent.ShowsNavigationUI = <span style=\"color:Blue\">false</span>;\r\n\r\n            RegionManager.SetRegionName(shell.contentRegion, RegionNames.ContentRegion);\r\n\r\n            RegionManager.SetRegionName(shell.leftSideBarRegion, RegionNames.LeftSideBarRegion);\r\n\r\n            RegionManager.SetRegionName(shell.rightSideBarRegion, RegionNames.RightSideBarRegion);\r\n           \r\n            <span style=\"color:Blue\">return</span> shell;\r\n        }\r\n\r\n        <span style=\"color:Blue\">protected</span> <span style=\"color:Blue\">override</span> <span style=\"color:Blue\">void</span> InitializeModules()\r\n        {\r\n           <span style=\"color:Blue\">base</span>.InitializeModules();\r\n\r\n           IModuleManager manager = Container.Resolve&lt;IModuleManager&gt;();\r\n\r\n           manager.LoadModule(<span style=\"color:#A31515\">&quot;NodeManager&quot;</span>);\r\n\r\n           INodeManager nm = Container.Resolve&lt;INodeManager&gt;();   <span style=\"color:#ff0000\">&lt;== this call throws a SecurityException</span>\r\n           <span style=\"color:Blue\">if</span> (nm != <span style=\"color:Blue\">null</span>)\r\n           {\r\n               nm.Activate(<span style=\"color:Blue\">null</span>);\r\n           }\r\n        }</pre>\r\n<pre>}\r\n</pre>\r\n<pre>But when I start the application in partial trusted mode, it throws the following SecurityException: &quot;Request for the permission of type 'System.Security.Permissions.SecurityPermission, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' failed.&quot;</pre>\r\n<pre>I already added the AllowPartiallyTrustedCallersAttribute to the CAL framework and strong named all assemblies!</pre>\r\n<pre>Can anyone help me please??</pre>\r\n</div>\r\n<p>&nbsp; Thanks, Andreas</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-06-15T00:38:56.997-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "202632",
    "ThreadId": "59505",
    "Html": "<p style=\"margin:0cm 0cm 0pt\"><span style=\"\" lang=EN-US><span style=\"font-family:Calibri\"><span style=\"font-size:small\">Hi Andreas,</span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"\" lang=EN-US><span style=\"font-family:Calibri;font-size:small\">&nbsp;</span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"\" lang=EN-US><span style=\"font-family:Calibri\"><span style=\"font-size:small\">I do not know your exact scenario, but judging from the line that is throwing the exception, this issue could be related to Unity. The following article lists Unity&rsquo;s v1.2 limitations when running in Partial Trust Environments:</span></span></span></p>\r\n<p style=\"text-indent:-18pt;margin:0cm 0cm 0pt 36pt\"><span style=\"font-family:Symbol\" lang=EN-US><span style=\"\"><span style=\"font-size:small\">&middot;</span><span style=\"font:7pt &quot;Times New Roman&quot;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style=\"\" lang=EN-US><a href=\"http://msdn.microsoft.com/en-us/library/dd203232.aspx\"><span style=\"font-family:Calibri;font-size:small\">Using Unity in Partial Trust Environments</span></a></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"\" lang=EN-US><span style=\"font-family:Calibri;font-size:small\">&nbsp;</span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt -1.2pt\"><span style=\"\" lang=EN-US><span style=\"font-family:Calibri;font-size:small\">You might also get some more information about this in the </span><a href=\"http://www.codeplex.com/unity/Thread/List.aspx\"><span style=\"font-family:Calibri;font-size:small\">Unity Forums</span></a><span style=\"font-size:small\"><span style=\"font-family:Calibri\">.</span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt -1.2pt\"><span style=\"\" lang=EN-US><span style=\"font-family:Calibri;font-size:small\">&nbsp;</span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"\" lang=EN-US><span style=\"font-size:small\"><span style=\"font-family:Calibri\">You should also take into account that since XBAPs are not in the scope of the Composite Application Guidance for WPF &amp; SL, some particular things might not be fully functional.</span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"\" lang=EN-US><span style=\"font-family:Calibri;font-size:small\">&nbsp;</span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"\" lang=EN-US><span style=\"font-size:small\"><span style=\"font-family:Calibri\">Please let me know if this helps.</span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt -0.6pt\"><span style=\"\" lang=EN-US><span style=\"font-family:Calibri;font-size:small\">&nbsp;</span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt -0.6pt\"><span style=\"\" lang=EN-US><span style=\"font-size:small\"><span style=\"font-family:Calibri\">Damian Schenkelman</span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"\" lang=EN-US><a href=\"http://blogs.southworks.net/dschenkelman\"><span style=\"font-family:Calibri;font-size:small\">http://blogs.southworks.net/dschenkelman</span></a></span></p>",
    "PostedDate": "2009-06-17T12:50:15.34-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "204002",
    "ThreadId": "59505",
    "Html": "<p>Hi Damion,</p>\r\n<p>thank you very much for your answer, it <span lang=EN-US>helped me to solve the problem.</span></p>\r\n<p><span lang=EN-US>The problem was, that the access modifier of my ModuleController classes was not public!</span></p>\r\n<p><span lang=EN-US>Thanks a lot, </span></p>\r\n<p><span lang=EN-US>Andreas</span></p>",
    "PostedDate": "2009-06-22T03:56:30.987-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]