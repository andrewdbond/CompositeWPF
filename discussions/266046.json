[
  {
    "Id": "645536",
    "ThreadId": "266046",
    "Html": "\r\n<p>Hi all!</p>\r\n<p>In my project I've created a component (Silverlight WCF component) that connects to a database, gets data from there and shows the data in a listbox. It works async and responds to the INotifyPropertyChanged event in order to show the data. The component\r\n displays itself in a region on the UI.</p>\r\n<p>In another project, intended to handle all the UI, I have a Shell with some regions. The ViewModel is responsible for instatiating the component like so:</p>\r\n<p>&nbsp;</p>\r\n<p><span style=\"color:#0000ff\">Dim</span> MyComponent <span style=\"color:#0000ff\">\r\nAs New </span>SLComponent.<span style=\"color:#008080\">Component1</span></p>\r\n<p>MyComponent.Initialize<span style=\"color:#00ff00\"> '//This is where the component does it's own work</span></p>\r\n<p>OnpropertyChanged(<span style=\"color:#800000\">&quot;MyComponent&quot;</span>)</p>\r\n<p>&nbsp;</p>\r\n<p>It works async and responds allright. I know that, because in Fiddler, I see the XML data filled with the desired information. But the component and the empty listbox show up in the intended Region, yet the listpart of the listbox remains empty. I have set\r\n the DisplayMemberPath to one of the properties of the object that is shown.</p>\r\n<p>Does anyone have any suggestions on how to get the UI responding to the async update of the component?</p>\r\n<p>Regards,Peter</p>\r\n",
    "PostedDate": "2011-07-21T06:24:17.287-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "645539",
    "ThreadId": "266046",
    "Html": "<p>Hi Peter,</p>\r\n<p>You should make sure that you've set your binding correctly, and that your ViewModel implements <strong>INotifyPropertyChanged </strong>(by manually implementing it, or making your ViewModel inherit from <strong>NotificationObject</strong>). Also, you should make sure you're raising the <strong>PropertyChanged</strong> event each time your information is obtained from the server.</p>\r\n<p>I hope you find this helpful.</p>\r\n<p>Guido Leandro Maliandi<br /> <a href=\"http://blogs.southworks.net/gmaliandi\">http://blogs.southworks.net/gmaliandi</a></p>",
    "PostedDate": "2011-07-21T06:28:10.903-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "645589",
    "ThreadId": "266046",
    "Html": "<p>Hi Guido, thanks for getting back to me so fast. I really appreciate that.</p>\r\n<p>As far as I can see I have the NotifyPropertyChanged events on places where they should be. This is the code for the component:</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">Imports</span> System.Collections.ObjectModel\r\n<span style=\"color: blue;\">Imports</span> SLComponent.PersoonProxy\r\n\r\n<span style=\"color: blue;\">Public</span> <span style=\"color: blue;\">Class</span> Component1ViewModel\r\n    <span style=\"color: blue;\">Inherits</span> ViewModelBase\r\n\r\n    <span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">ReadOnly</span> MijnProxy <span style=\"color: blue;\">As</span> <span style=\"color: blue;\">New</span> MensenServiceClient\r\n\r\n    <span style=\"color: blue;\">Public</span> <span style=\"color: blue;\">Property</span> Personen <span style=\"color: blue;\">As</span> <span style=\"color: blue;\">New</span> ObservableCollection(Of Persoon)\r\n\r\n    <span style=\"color: blue;\">Public</span> <span style=\"color: blue;\">Sub</span> <span style=\"color: blue;\">New</span>()\r\n        <span style=\"color: blue;\">If</span> <span style=\"color: blue;\">Not</span> IsDesignTime <span style=\"color: blue;\">Then</span>\r\n            OphalenPersonen()\r\n        <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">If</span>\r\n    <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Sub</span>\r\n\r\n    <span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">Sub</span> OphalenPersonen()\r\n        LeesPersonen(<span style=\"color: blue;\">Sub</span>(s, e) Personen = e.result)\r\n\r\n    <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Sub</span>\r\n\r\n    <span style=\"color: blue;\">Private</span> <span style=\"color: blue;\">Sub</span> LeesPersonen(<span style=\"color: blue;\">ByVal</span> callback <span style=\"color: blue;\">As</span> EventHandler(Of LeesAllePersonenCompletedEventArgs))\r\n\r\n        <span style=\"color: blue;\">AddHandler</span> MijnProxy.LeesAllePersonenCompleted, callback\r\n        MijnProxy.LeesAllePersonenAsync()\r\n        OnPropertyChanged(<span style=\"color: #a31515;\">\"Personen\"</span>)\r\n    <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Sub</span>\r\n\r\n<span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Class</span>\r\n</pre>\r\n</div>\r\n<p>The listbox that is on the visible part of the component is bound to this ViewModel as shown below:</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>    xmlns:ViewModel=\"clr-namespace:SLComponent\"\r\n    \r\n    <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">UserControl.Resources</span><span style=\"color: blue;\">&gt;</span>\r\n        <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">ViewModel</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">Component1ViewModel</span> <span style=\"color: red;\">x:Key</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">MijnViewModel</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">/&gt;</span>\r\n    <span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">UserControl.Resources</span><span style=\"color: blue;\">&gt;</span>\r\n    \r\n    <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">Grid</span> <span style=\"color: red;\">x:Name</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">LayoutRoot</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">Background</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">White</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">DataContext</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">{Binding Source={StaticResource MijnViewModel}}</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>\r\n        <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">ListBox</span> <span style=\"color: red;\">Name</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">ListBox1</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">ItemsSource</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">{Binding Path=Personen}</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">DisplayMemberPath</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">BSN</span><span style=\"color: black;\">\"</span> <span style=\"color: blue;\">/&gt;</span>\r\n    <span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">Grid</span><span style=\"color: blue;\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p>IMHO on every async update of the Observablecollection(of&nbsp;Personen), this listbox will show the newly fetched data, right?</p>\r\n<p>Then eventually in the UI project, the component assembly is referenced to from that UI project and it is instantiated with the call I gave in my first post. Somewhere along the road something gets lost...</p>\r\n<p>Any suggestions? Do you need more codesnippets? All help is welcome!</p>\r\n<p>Regards,</p>\r\n<p>Peter</p>",
    "PostedDate": "2011-07-21T07:58:27.437-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "645682",
    "ThreadId": "266046",
    "Html": "<p>FOUND the solution!</p>\r\n<p>The OnPropertyChanged should not be set inside of the async call, where it gets updated allright. Instead, it has to be set inside the Property Setter.. SO in the above code, the automated property will have to be changed into a property with backing store. And inside of the Setter, the OnPropertyChanged. Like so:</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>    <span style=\"color: blue;\">Private</span> _personen <span style=\"color: blue;\">As</span> ObservableCollection(Of Persoon) = <span style=\"color: blue;\">New</span> ObservableCollection(Of Persoon)()\r\n    <span style=\"color: blue;\">Public</span> <span style=\"color: blue;\">Property</span> Personen() <span style=\"color: blue;\">As</span> ObservableCollection(Of Persoon)\r\n        <span style=\"color: blue;\">Get</span>\r\n            <span style=\"color: blue;\">Return</span> _personen\r\n        <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Get</span>\r\n        <span style=\"color: blue;\">Set</span>(<span style=\"color: blue;\">ByVal</span> value <span style=\"color: blue;\">As</span> ObservableCollection(Of Persoon))\r\n            _personen = value\r\n            OnPropertyChanged(<span style=\"color: #a31515;\">\"Personen\"</span>)\r\n        <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Set</span>\r\n    <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">Property</span>\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>Thanks for your attention!</p>\r\n<p>Peter</p>",
    "PostedDate": "2011-07-21T10:37:46.413-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "645697",
    "ThreadId": "266046",
    "Html": "<p>Hi Peter,</p>\r\n<p>Thank you for sharing your insight with the rest of the community, as it might benefit other users facing similar problems.</p>\r\n<p>Thanks,</p>\r\n<p>Guido Leandro Maliandi<br /> <a href=\"http://blogs.southworks.net/gmaliandi\">http://blogs.southworks.net/gmaliandi</a></p>",
    "PostedDate": "2011-07-21T10:58:31.303-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]