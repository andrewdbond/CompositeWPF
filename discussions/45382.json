[
  {
    "Id": "151347",
    "ThreadId": "45382",
    "Html": "Hi All<br>\r\n<br>\r\nBusy learning prism here and was wondering what the best way to add items to a shared Menu that exists in the Shell.<br>\r\n<br>\r\nI would like each module that gets loaded to create menu items in main shared menu in my Shell view.<br>\r\n<br>\r\nAny tips greatly appreciated<br>\r\n",
    "PostedDate": "2009-01-27T07:01:12.637-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "151846",
    "ThreadId": "45382",
    "Html": "<p style=\"margin:0in 0in 0pt\"><span style=\"font-family:calibri\">Hi,</span></p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-family:calibri\">Since the <b>Menu</b> and <b>MenuItem</b> classes inherit from the <b>ItemsControl</b> control, what you only need to do is define the control as a region like this:</span></p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0in 0in 0pt 35.4pt\"><span style=\"font-size:10pt;font-family:'courier new'\">&lt;!--Shell.xaml--&gt;</span></p>\r\n<p style=\"margin:0in 0in 0pt 35.4pt\"><span style=\"font-size:10pt;font-family:'courier new'\">&lt;Menu&gt;</span></p>\r\n<p style=\"margin:0in 0in 0pt 71.4pt\"><span style=\"font-size:10pt;font-family:'courier new'\">&lt;MenuItem Header=&quot;_File&quot; cal:RegionManager.RegionName=&quot;GlobalCommandsRegion&quot;&gt;</span></p>\r\n<p style=\"margin:0in 0in 0pt 107.4pt\"><span style=\"font-size:10pt;font-family:'courier new'\">&lt;!—Shell Menu Item --&gt;</span></p>\r\n<p style=\"margin:0in 0in 0pt 71.4pt\"><span style=\"font-size:10pt;font-family:'courier new'\">&lt;/MenuItem&gt;</span></p>\r\n<p style=\"margin:0in 0in 0pt 35.4pt\"><span style=\"font-size:10pt;font-family:'courier new'\">&lt;/Menu&gt;</span></p>\r\n<p style=\"margin:0in 0in 0pt -0.6pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0in 0in 0pt -0.6pt\"><span style=\"font-family:calibri\">Then, in your modules, you can get a reference to the region through the region manager and add menu items like this:</span></p>\r\n<p style=\"margin:0in 0in 0pt -0.6pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0in 0in 0pt 35.4pt\"><span style=\"font-size:10pt;font-family:'courier new'\">IRegion globalCommandsRegion = regionManager.Regions[&quot;GlobalCommandsRegion&quot;];</span></p>\r\n<p style=\"margin:0in 0in 0pt 35.4pt\"><span style=\"font-size:10pt;font-family:'courier new'\"> </span></p>\r\n<p style=\"margin:0in 0in 0pt 35.4pt\"><span style=\"font-size:10pt;font-family:'courier new'\">// Add a menu item bound to a command.</span></p>\r\n<p style=\"margin:0in 0in 0pt 35.4pt\"><span style=\"font-size:10pt;font-family:'courier new'\">globalCommandsRegion.Add(new MyModuleMenuItem());</span></p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0in 0in 0pt -0.6pt\"><span style=\"font-family:calibri\">You could do the same with a <b>Toolbar</b> control and add buttons from your modules:</span></p>\r\n<p style=\"margin:0in 0in 0pt -0.6pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0in 0in 0pt 35.4pt\"><span style=\"font-size:10pt;font-family:'courier new'\">&lt;!--Shell.xaml--&gt;</span></p>\r\n<p style=\"margin:0in 0in 0pt 35.4pt\"><span style=\"font-size:10pt;font-family:'courier new'\">&lt;ToolBar x:Name=&quot;MyToolbar&quot; cal:RegionManager.RegionName=&quot;GlobalCommandsRegion&quot;&gt;</span></p>\r\n<p style=\"margin:0in 0in 0pt 35.4pt\"><span style=\"font-size:10pt;font-family:'courier new'\"> </span></p>\r\n<p style=\"margin:0in 0in 0pt 71.4pt\"><span style=\"font-size:10pt;font-family:'courier new'\">&lt;!— You need this Separator to avoid having troubles when showing controls from your modules --&gt;</span></p>\r\n<p style=\"margin:0in 0in 0pt 71.4pt\"><span style=\"font-size:10pt;font-family:'courier new'\">&lt;Separator /&gt;</span></p>\r\n<p style=\"margin:0in 0in 0pt 35.4pt\"><span style=\"font-size:10pt;font-family:'courier new'\"> </span></p>\r\n<p style=\"margin:0in 0in 0pt 35.4pt\"><span style=\"font-size:10pt;font-family:'courier new'\">&lt;/ToolBar&gt;</span></p>\r\n<p style=\"margin:0in 0in 0pt -0.6pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-family:calibri\">For a more complex manipulation on where the items should be placed and nested hierarchies, you might consider creating a MenuService for these purposes, that updates the UI in a custom way.</span></p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0in 0in 0pt -0.6pt\"><span style=\"font-family:calibri\">Please let me know if this helps.</span></p>\r\n<p style=\"margin:0in 0in 0pt -0.6pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0in 0in 0pt -0.6pt\"><span style=\"font-family:calibri\">Mariano Converti</span></p>\r\n<p style=\"margin:0in 0in 0pt -0.6pt\"><a href=\"http://blogs.southworks.net/mconverti\"><span style=\"font-family:calibri\">http://blogs.southworks.net/mconverti</span></a> </p>\r\n",
    "PostedDate": "2009-01-28T09:10:37.997-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]