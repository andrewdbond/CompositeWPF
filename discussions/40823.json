[
  {
    "Id": "135372",
    "ThreadId": "40823",
    "Html": "Hello,<br>\r\n<br>\r\nI have a general question about the Presentation Model Pattern. It seems to me that basic scenarios are not addressed in the supplied sample application. At least I can't find it. I am hoping someone here can give me a nudge in the right direction.<br>\r\n<br>\r\nSay I have a view called Customers.xaml that displays a list of customers in a GridView. I need the grid to be sorted but 'CustomerName'. In order to do this in the typical way, I need to handle the GridViewColumnHeader.Click event. This however requires the event handler to be placed in the code behind. I suppose I could define the handler in the PresentationModel and bind to it, however this would then tightly couple the PresentationModel to very view centric objects.  See  below.<br>\r\n<br>\r\n<p><span style=\"font-size:13px;color:#0000ff\"><br>\r\n//Example of why it would be bad in the PresentationModel Class<br>\r\nvoid</span><span style=\"font-size:13px\"> GridViewColumnHeaderClickedHandler(</span><span style=\"font-size:13px;color:#0000ff\">object</span><span style=\"font-size:13px\"> sender, </span><span style=\"font-size:13px;color:#2b91af\">RoutedEventArgs</span><span style=\"font-size:13px\"> e)<br>\r\n{<br>\r\n    //Presentation Model should not know about GridViews etc...<br>\r\n    GridViewHeader selectedHeader = e.OriginalSource as GridViewHeader;<br>\r\n}<br>\r\n<p> </p>\r\n<p><span style=\"font-size:16px\">That being said, it seems to me to make the most sense to handle the event in the code behind, and then to delegate anything needed to the Presentation Model. See below.<br>\r\n<br>\r\n<span style=\"font-size:13px\"><span style=\"color:#0000ff\">//Code behind example<br>\r\nvoid</span> GridViewColumnHeaderClickedHandler(<span style=\"color:#0000ff\">object</span> sender, <span style=\"color:#2b91af\">RoutedEventArgs</span> e)<br>\r\n{<br>\r\n     //Code Behind handles it<br>\r\n    GridViewHeader selectedHeader = e.OriginalSource as GridViewHeader;<br>\r\n    <br>\r\n    PresentationModel viewModel = DataContext as PresentationModel;<br>\r\n    ViewModel.Sort(selectedHeader.Text);<br>\r\n}<br>\r\n<br>\r\nSo I guess my question is basically if this is ok or if I am totally missing something? I was pretty disappointed that the Sample Application left out some of this basic stuff. Perhaps I just missed it in there. Any insight in to this would be very much appreciated.<br>\r\n<br>\r\nThanks,<br>\r\nBrette</span></span></p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2008-11-25T19:01:51.04-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "135520",
    "ThreadId": "40823",
    "Html": "Hi Brette21,<br>\r\n<br>\r\nYou're right, you should not place logic on your ViewModel that access your UI controls directly. The second approach looks much cleaner than the first one.<br>\r\n<br>\r\nAnother approach if you didn't want to have code behind at all, is to use the AttachedBehavior pattern, where by setting an attached property (of type ICommand for example) on the GridViewHeader, you subscribe to the Click event, and end up executing the command which will be bound to the ViewModel.<br>\r\nYou can see an example of an Attached Behavior in the following post (which is actually implemmenting commands for buttons in Silverlight, but the same thing applies to WPF, and if you replace ButtonBase for a GridViewHeader or something more generic, it should work directly):<br>\r\n<ul>\r\n    <li><a href=\"http://blogs.southworks.net/jdominguez/2008/08/icommand-for-silverlight-with-attached-behaviors/\" rel=bookmark>ICommand for Silverlight with Attached Behaviors </a></li>\r\n</ul>\r\n<br>\r\nBy the way, did you check out the new DataGrid control included in the <a href=\"http://www.codeplex.com/wpf/\">WPF Toolkit</a>? It is much powerful and easy to use than the GridView, and has sort features already built-in. These controls will be part of the framework in the future.<br>\r\n<br>\r\nLet me know if this helps,<br>\r\nJulian Dominguez<br>\r\n<a href=\"http://blogs.southworks.net/jdominguez\">http://blogs.southworks.net/jdominguez</a>\r\n",
    "PostedDate": "2008-11-26T04:32:52.313-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "135566",
    "ThreadId": "40823",
    "Html": "Hey Julian,<br>\r\n<br>\r\nFirst thanks for the great response. I will look at the AttachedBehavior pattern per your suggestion. I seem to recall reading that some time ago however at the time, I did not really understand why it was useful. I suppose this points it out rather clearly now! So Thanks! <br>\r\n<br>\r\nYou mentioned the WPF Toolkit. Indeed I have looked at this, and I was very excited for it to arrive in Oct. However I did run into an issue that I am currently unable to resolve. When I add the following grid to my xaml file it works just fine.\r\n<p><span style=\"font-size:13px;color:#0000ff\">&lt;</span><span style=\"font-size:13px;color:#a31515\">my</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">DataGrid</span><span style=\"font-size:13px;color:#ff0000\"> Name</span><span style=\"font-size:13px;color:#0000ff\">=&quot;dataGrid1&quot; </span><span style=\"font-size:13px;color:#ff0000\">VerticalAlignment</span><span style=\"font-size:13px;color:#0000ff\">=&quot;Bottom&quot; </span><span style=\"font-size:13px;color:#ff0000\">xmlns</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#ff0000\">my</span><span style=\"font-size:13px;color:#0000ff\">=&quot;clr-namespace:Microsoft.Windows.Controls;assembly=WPFToolkit&quot;&gt;</span><span style=\"font-size:13px;color:#0000ff\"><br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">&lt;/</span><span style=\"font-size:13px;color:#a31515\">my</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">DataGrid</span><span style=\"font-size:13px;color:#0000ff\">&gt;   <br>\r\n</span></p>\r\n<br>\r\nHowever this is not a very useful grid. Sadly when I add any column to the grid definition my app locks up. I am not really sure if focus is just lost, or if some thread is blocking or if there some other issue in my project or the grid that is causing it. I get no error messages to investigate, and when I look at the running threads there does not seem to be any blocking going on. In any case it renders my application for all practical purposes unresponsive. Here is the code that will cause this behavior.<br>\r\n<span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">\r\n<p>&lt;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#a31515\">my</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">DataGrid</span><span style=\"font-size:13px;color:#ff0000\"> Name</span><span style=\"font-size:13px;color:#0000ff\">=&quot;dataGrid1&quot; </span><span style=\"font-size:13px;color:#ff0000\">VerticalAlignment</span><span style=\"font-size:13px;color:#0000ff\">=&quot;Bottom&quot; </span><span style=\"font-size:13px;color:#ff0000\">xmlns</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#ff0000\">my</span><span style=\"font-size:13px;color:#0000ff\">=&quot;clr-namespace:Microsoft.Windows.Controls;assembly=WPFToolkit&quot;&gt;<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">    &lt;</span><span style=\"font-size:13px;color:#a31515\">my</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">DataGrid.Columns</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">        &lt;</span><span style=\"font-size:13px;color:#a31515\">my</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">DataGridTextColumn</span><span style=\"font-size:13px;color:#ff0000\"> Header</span><span style=\"font-size:13px;color:#0000ff\">=&quot;Header&quot; /&gt;<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">    &lt;/</span><span style=\"font-size:13px;color:#a31515\">my</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">DataGrid.Columns</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">&lt;/</span><span style=\"font-size:13px;color:#a31515\">my</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">DataGrid</span><span style=\"font-size:13px;color:#0000ff\">&gt;\r\n<p>&nbsp;</p>\r\n<p> </p>\r\n</span></p>\r\n<p>We all know that no application can function without at least one grid that with one unbound column with a title of 'Header' so I have had to go back to the old fashioned way of using a ListView and a GridView. This made me very sad. And even though this happened long long ago (yesterday) the pain is still fresh in my mind. ;-)<br>\r\n<br>\r\n<br>\r\nBrette</p>\r\n",
    "PostedDate": "2008-11-26T06:36:49.607-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "135578",
    "ThreadId": "40823",
    "Html": "Hi,<br>\r\n<br>\r\nI'm glad you found the link useful.<br>\r\n<br>\r\nRegarding the DataGrid, I tried your markup on an empty Window, and I did not have any issues with it. It doesn't do much, but the application does not lock up. Maybe you should give it another try, it will make your life easier in the future ;-)<br>\r\n<br>\r\nJulian\r\n",
    "PostedDate": "2008-11-26T07:09:19.873-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "135612",
    "ThreadId": "40823",
    "Html": "You are correct. In fact if I create a simple project with a new window, I can get it to function as well. However for some reason in the context of the current application I am working on, things go bad for me. I will prolly take another look this weekend. In any case the Attached Behavior Pattern was very helpful indeed. Thanks!<br>\r\n<br>\r\nBrette\r\n",
    "PostedDate": "2008-11-26T08:34:25.437-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]