[
  {
    "Id": "129778",
    "ThreadId": "39131",
    "Html": "Hi All,<br>\r\n<br>\r\nI've implemented a Splashscreen in my app using the new SplashScreen class in SP1.&nbsp; However, when my app launches the splash screen ends up hidden behind the window whilst it initialises all the modules.&nbsp; Once the sceen is ready to show the default modules view the splash screen reappears and then fades out.&nbsp; Doesn't look cool at all ...<br>\r\n<br>\r\nThe splash screen class by default closes when the window first appears which explains why its hidden whilst the modules are enumerated.&nbsp; The class can't tell that there is still a stack of work left to do.&nbsp; Does anyone know of a possible solution to this in the context of CAL?<br>\r\n<br>\r\nCheers,<br>\r\n",
    "PostedDate": "2008-11-03T13:51:13.703-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "131754",
    "ThreadId": "39131",
    "Html": "<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">Hi,</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">Based on your comments, I assume that you may be implementing the <b>SplashScreen</b> in one of these ways:</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span style=\"font-family:calibri\">·<span style=\"font:7pt 'times new roman'\">         </span>Setting the <b>BuildAction</b> property to <b>SplashScreen</b> on an Image of your project.\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span style=\"font-family:calibri\">·<span style=\"font:7pt 'times new roman'\">         </span>Using the <b>SplashScreen</b> class like the following:\r\n<p style=\"margin:0cm 0cm 0pt 141.6pt\"><span style=\"font-size:10pt;color:#2b91af;font-family:'courier new'\">SplashScreen</span><span style=\"font-size:10pt;font-family:'courier new'\"> ss = <span style=\"color:blue\">new</span> <span style=\"color:#2b91af\">SplashScreen</span>(<span style=\"color:#a31515\">&quot;splashScreen.PNG&quot;</span>);</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 141.6pt\"><span style=\"font-size:10pt;font-family:'courier new'\">ss.Show(<span style=\"color:blue\">true</span>);</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'courier new'\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">The problem with these implementations is that the <b>Show</b> method is called passing the parameter “<i>true”</i>, for this reason, the splash screen will be automatically close when the application finished to load, but with a delay of 300 miliseconds (this causes the fade out).</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">You can find more information about how the <b>SplashScreen</b> class works in the following links:</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span style=\"font-family:symbol\">·<span style=\"font:7pt 'times new roman'\">         </span><a href=\"http://msdn.microsoft.com/en-us/library/system.windows.splashscreen.aspx\"><span style=\"font-family:calibri\">SplashScreen Class</span></a>\r\n<p style=\"margin:0cm 0cm 0pt 36pt\"><span style=\"font-family:symbol\">·<span style=\"font:7pt 'times new roman'\">         </span><a href=\"http://msdn.microsoft.com/en-us/library/system.windows.splashscreen.show.aspx\"><span style=\"font-family:calibri\">SplashScreen.Show Method</span></a>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">A possible workaround to solve this, is calling the <b>Show</b> method passing the parameter <i>“false” </i>(In this way, you have to close the <b>SplashScreen</b> manually) and close the splash screen without delay when the application finishes loading.</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">Here you can find a possible implementation of this using the <b>OnStartup</b> method of your <b>App</b> class:</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt -1.2pt\"><span style=\"font-size:10pt;color:blue;font-family:'courier new'\">  protected</span><span style=\"font-size:10pt;font-family:'courier new'\"> <span style=\"color:blue\">override</span> <span style=\"color:blue\">void</span> OnStartup(StartupEventArgs e)</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'courier new'\">  {</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            <b><span style=\"color:#2b91af\">SplashScreen</span> ss = <span style=\"color:blue\">new</span> <span style=\"color:#2b91af\">SplashScreen</span>(<span style=\"color:#a31515\">&quot;splashScreen.PNG&quot;</span>);</b></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><b><span style=\"font-size:10pt;font-family:'courier new'\">            ss.Show(<span style=\"color:blue\">false</span>);</span></b></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'courier new'\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            <span style=\"color:blue\">base</span>.OnStartup(e);</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'courier new'\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;color:blue;font-family:'courier new'\">        #if</span><span style=\"font-size:10pt;font-family:'courier new'\"> (DEBUG)</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;color:gray;font-family:'courier new'\">            </span><span style=\"font-size:10pt;font-family:'courier new'\">RunInDebugMode(); </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;color:blue;font-family:'courier new'\">        #else</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            <span style=\"color:gray\">RunInReleaseMode();</span>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;color:blue;font-family:'courier new'\">        #endif</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'courier new'\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            <span style=\"color:blue\">this</span>.ShutdownMode = ShutdownMode.OnMainWindowClose;</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'courier new'\">            <b>ss.Close(<span style=\"color:blue\">new</span> <span style=\"color:#2b91af\">TimeSpan</span> ()); </b><span style=\"color:green\">//Close the SplashScreen immediately</span><b></b></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'courier new'\">  }</span> </p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">Please, Let me know if you find this useful or if the problem persists, please provide more information into this matter.</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\"> </span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-family:calibri\">Ezequiel Sculli</span></p>\r\n<p style=\"margin:0cm 0cm 0pt -0.6pt\"><a href=\"http://blogs.southworks.net/esculli/\"><span style=\"font-family:calibri\">http://blogs.southworks.net/esculli/</span></a> </p>\r\n</span></p>\r\n</span></p>\r\n</span></p>\r\n</span></p>\r\n</span></p>\r\n",
    "PostedDate": "2008-11-11T11:25:47.93-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "132100",
    "ThreadId": "39131",
    "Html": "Hi Ezequiel,<br>\r\n<br>\r\nThanks for the reply.&nbsp; The problerm I'm having is that the splashscreen class is only active prior to the main window opening.&nbsp; It then performs the fade out.<br>\r\n<br>\r\nHowever, in my app the loading time extends past the window opening whilst the applications modules are enumerated and the app initialises.&nbsp; As soon as the main window opens it is on top of the splash screen.&nbsp; In addition to this because the module enumeration is chugging away on the UI thread the actual fade out can't happen.&nbsp; So when the windows contents is actually rendered and frees up the UI thread the splashscreen suddenly appears and immediately starts its fade out animation.<br>\r\n<br>\r\nI have tried your code above and it certainly tidies things up in that the splashscreen no longer performs its fade.<br>\r\n<br>\r\nIt seems that in a situation with a longer loading time past the window appearing the splashscreen needs to close at the end of module enumeration rather than simply the window appearing, even though its still empty!<br>\r\n<br>\r\nThanks,<br>\r\n",
    "PostedDate": "2008-11-12T12:46:06.3-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]