[
  {
    "Id": "511842",
    "ThreadId": "232140",
    "Html": "\r\n<p>I'm trying to piece together examples and put together a base solution as a template for building modular Silverlight applications.</p>\r\n<p>I'm using MEF.</p>\r\n<p>I'm using a ModulesCatalog.xaml file to load my modules.&nbsp; Right now there is only 1 module and it's name is module1.</p>\r\n<p>In module1, I found if I didn't override the ConfigureAggregateCatalog, none of my Exports are available in the Module1.xap file.</p>\r\n<p>So I had to override the ConfigureAggregateCatalog as follows:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>AggregateCatalog _aggregCat = <span style=\"color:blue\">new</span> AggregateCatalog();\r\n\r\n            _aggregCat.Catalogs.Add(<span style=\"color:blue\">new</span> AssemblyCatalog(<span style=\"color:blue\">typeof</span>(Bootstrapper).Assembly));\r\n            _aggregCat.Catalogs.Add(<span style=\"color:blue\">new</span> AssemblyCatalog(<span style=\"color:blue\">typeof</span>(GlobalRegionNames).Assembly));\r\n\r\n            <span style=\"color:blue\">foreach</span> (<span style=\"color:blue\">var</span> module <span style=\"color:blue\">in</span> <span style=\"color:blue\">this</span>.ModuleCatalog.Modules)\r\n            {\r\n                _aggregCat.Catalogs.Add(CreateCatalog(module.Ref));\r\n            }\r\n\r\n            CompositionHost.Initialize(_aggregCat); <span style=\"color:green\">//add the current XAP.</span>\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>Here is the code for CreateCatalog I got from the samples:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">private</span> DeploymentCatalog CreateCatalog(<span style=\"color:blue\">string</span> uri)\r\n        {\r\n            <span style=\"color:blue\">var</span> catalog = <span style=\"color:blue\">new</span> DeploymentCatalog(uri);\r\n            catalog.DownloadCompleted &#43;= (s, e) =&gt; DownloadCompleted(s, e);\r\n            catalog.DownloadAsync();\r\n            <span style=\"color:blue\">return</span> catalog;\r\n        }\r\n\r\n        <span style=\"color:blue\">private</span> <span style=\"color:blue\">void</span> DownloadCompleted(<span style=\"color:blue\">object</span> sender, AsyncCompletedEventArgs e)\r\n        {\r\n            <span style=\"color:blue\">if</span> (e.Error != <span style=\"color:blue\">null</span>)\r\n            {\r\n                StringBuilder _sb = <span style=\"color:blue\">new</span> StringBuilder();\r\n                _sb.Append(<span style=\"color:#a31515\">@&quot;Bootstrapper Module Load Exception: \\r\\n&quot;</span>);\r\n                _sb.Append(e.Error.Message);\r\n\r\n                <span style=\"color:blue\">if</span> (e.Error.InnerException != <span style=\"color:blue\">null</span>)\r\n                {                    \r\n                    _sb.Append(e.Error.InnerException);\r\n                }\r\n\r\n                MessageBox.Show(e.Error.Message);\r\n            }\r\n        }\r\n</pre>\r\n</div>\r\n<p>In doing this, I now have a problem in the bootstrapper in the CreateShell()</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>        <span style=\"color:blue\">protected</span> <span style=\"color:blue\">override</span> DependencyObject CreateShell()\r\n        {            \r\n            <span style=\"color:blue\">return</span> <span style=\"color:blue\">this</span>.Container.GetExportedValue&lt;Shell&gt;();\r\n        }\r\n<br></pre>\r\n<pre>I get an exception that the Shell contract is not found though it is exported in the base silverlight project.</pre>\r\n<pre>&nbsp;</pre>\r\n<pre>So I have to go back to the ConfigureAggregateCatalog function and and add this code.<span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"></span></span></pre>\r\n<pre><div style=\"color:black; background-color:white\"><pre><span style=\"color:blue\">this</span>.AggregateCatalog.Catalogs.Add(<span style=\"color:blue\">new</span> AssemblyCatalog(<span style=\"color:blue\">typeof</span>(Bootstrapper).Assembly));\r\n            <span style=\"color:blue\">this</span>.AggregateCatalog.Catalogs.Add(<span style=\"color:blue\">new</span> AssemblyCatalog(<span style=\"color:blue\">typeof</span>(GlobalRegionNames).Assembly));\r\nThe problem with doing this I have IPopupController and ILogService I export in the base object and they are getting registered 2 times.  So I'm not understanding why the GetExportedValue&lt;Shell&gt; is failing when it is in fact registered.  </pre>\r\n<pre><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"><span style=\"font-family:Consolas; font-size:x-small\"></span></span></span>&nbsp;</pre>\r\n</div>\r\n</pre>\r\n</div>\r\n",
    "PostedDate": "2010-10-24T15:09:51.443-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "512341",
    "ThreadId": "232140",
    "Html": "\r\n<p>Hi,<br>\r\n<br>\r\nI do not know your exact scenario, but take into account that the Quickstarts are meant to provide guidance on an specific topic.<br>\r\n<br>\r\nThat said, if you are creating a template of a Prism application, I would recommend you to base it on the\r\n<strong>Stock Trader Reference Implementation</strong>. This application ties together most of the design/technical concepts using MEF.</p>\r\n<p>Please take into account that the override of the <strong>ConfigureAggregateCatalog\r\n</strong>method can only be done in classes that inherit from the <strong>MEFBootstrapper\r\n</strong>class. In general, it is located in the Shell project, but not in the modules</p>\r\n<p>If you need more guidance on this topic, you could check how it is implemented in the Stock Trader RI.</p>\r\n<p>Additionally, if you continue experiencing this situation in your scenario, could you please send a repro sample? For example using\r\n<a href=\"http://skydrive.live.com/\">Windows Live SkyDrive</a>.</p>\r\n<p>Hope this helps.</p>\r\n<p>Fernando Antivero <br>\r\n<a href=\"http://blogs.southworks.net/fantivero\">http://blogs.southworks.net/fantivero</a></p>\r\n",
    "PostedDate": "2010-10-25T12:30:19.79-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "512345",
    "ThreadId": "232140",
    "Html": "\r\n<p>Thanks Fantivero,</p>\r\n<p>I'm trying to use the Stock trader RI app.&nbsp; The problem though is it shows how to use ModuleCatalog file to load modules but then it turns around and tightly couples the aggregate container to them by manually adding the modules in the bootstrapper.</p>\r\n<p>I use the code from another example that populates the modules into the aggregateCatalog dynamically based on what's in the ModuleCatalog file.</p>\r\n<p><span style=\"color:blue\">foreach</span> (<span style=\"color:blue\">var</span> module\r\n<span style=\"color:blue\">in</span> <span style=\"color:blue\">this</span>.ModuleCatalog.Modules)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _aggregCat.Catalogs.Add(CreateCatalog(module.Ref));<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n<br>\r\nAll of this is done in the bootstrapper and yes it inherits from MEFBootstrapper.&nbsp; When I get home this afternoon I'll figure out a way to post the solution.</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2010-10-25T12:35:42.123-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "512351",
    "ThreadId": "232140",
    "Html": "\r\n<p>Here's a link</p>\r\n<p><a href=\"http://cid-ff05a29e13af7bfd.office.live.com/self.aspx/.Public/Code%20Samples#resId/FF05A29E13AF7BFD!229\">http://cid-ff05a29e13af7bfd.office.live.com/self.aspx/.Public/Code%20Samples#resId/FF05A29E13AF7BFD!229</a></p>\r\n<p>If you need to compile this, you can pull down the Telerik trial assemblies</p>\r\n<p><a href=\"http://www.telerik.com/login.aspx?ReturnUrl=%2faccount%2ffree-trials%2ftrial-product-versions%2fsingle-trial.aspx%3fpmvid%3d0%26pid%3d571\">http://www.telerik.com/login.aspx?ReturnUrl=%2faccount%2ffree-trials%2ftrial-product-versions%2fsingle-trial.aspx%3fpmvid%3d0%26pid%3d571</a></p>\r\n<p>Start by looking in the ConfigureAggregateCatalog function.&nbsp;</p>\r\n<p>this.AggregateCatalog.Catalogs.Add(new AssemblyCatalog(typeof(Bootstrapper).Assembly));<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.AggregateCatalog.Catalogs.Add(new AssemblyCatalog(typeof(GlobalRegionNames).Assembly));</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // This was the only way that the Module1 was satisfying it's import is with the code below.<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // In EyeCue that's how it was at least.<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AggregateCatalog _aggregCat = new AggregateCatalog();</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _aggregCat.Catalogs.Add(new AssemblyCatalog(typeof(Bootstrapper).Assembly));<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _aggregCat.Catalogs.Add(new AssemblyCatalog(typeof(GlobalRegionNames).Assembly));</p>\r\n<p>You see I'm having to populate two containers here.&nbsp; If I don't do the first one, then the Shell isn't available in the CreateShell override.</p>\r\n<p>If I don't add the second AggregateCatalog then when I start adding multiple Modules in different .Xaps, I find that IPopupController isn't available.&nbsp; In this small template, I don't have the problem with IPopupcontroller not being in Module1.&nbsp;\r\n However, at work, I have a separate solution with multiple modules, and this is what I had to do to get things to work.</p>\r\n<p>Note, I don't want to have to add references in my base silverlight project to modules like what is happening in the StockTrader RI sample.</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2010-10-25T12:48:33.963-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]