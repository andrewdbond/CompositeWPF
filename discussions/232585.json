[
  {
    "Id": "513711",
    "ThreadId": "232585",
    "Html": "\r\n<p>Hi all,</p>\r\n<p>I built an WPF4 app with Prism 2. My development environment is Win7 64bit with VS2010. I tried everything works on my development machine.</p>\r\n<p>Now I copied all EXE, DLL and required files to a Windows XP SP3 32bit machine. Before that I installed .Net Framework 4. When I run the application on WinXP I got exception messages from event viewer:</p>\r\n<p>Excepton: System.IO.FileNotFoundException<br>\r\nStack:<br>\r\n&nbsp;&nbsp; at System.Reflection.RuntimeAssembly.GetExportedTypes(RuntimeAssembly assembly, ObjectHandleOnStack retTypes)<br>\r\n&nbsp;&nbsp; at System.Reflection.RuntimeAssembly.GetExportedTypes()<br>\r\n&nbsp;&nbsp; at Microsoft.Practices.Composite.Modularity.DirectoryModuleCatalog.InnerModuleInfoLoader.&lt;&gt;c__DisplayClass2b.&lt;GetNotAllreadyLoadedModuleInfos&gt;b__27(FileInfo file)<br>\r\n&nbsp;&nbsp; at System.Linq.Enumerable.&lt;SelectManyIterator&gt;d__14`2.MoveNext()<br>\r\n&nbsp;&nbsp; at System.Linq.Buffer`1..ctor(IEnumerable`1 source)<br>\r\n&nbsp;&nbsp; at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)<br>\r\n&nbsp;&nbsp; at Microsoft.Practices.Composite.Modularity.DirectoryModuleCatalog.InnerModuleInfoLoader.GetModuleInfos(String path)<br>\r\n&nbsp;&nbsp; at Microsoft.Practices.Composite.Modularity.DirectoryModuleCatalog&#43;InnerModuleInfoLoader.GetModuleInfos(System.String)<br>\r\n&nbsp;&nbsp; at Microsoft.Practices.Composite.Modularity.DirectoryModuleCatalog.InnerLoad()<br>\r\n&nbsp;&nbsp; at Microsoft.Practices.Composite.Modularity.ModuleCatalog.Initialize()<br>\r\n&nbsp;&nbsp; at Microsoft.Practices.Composite.Modularity.ModuleManager.Run()<br>\r\n&nbsp;&nbsp; at Microsoft.Practices.Composite.UnityExtensions.UnityBootstrapper.InitializeModules()<br>\r\n&nbsp;&nbsp; at Microsoft.Practices.Composite.UnityExtensions.UnityBootstrapper.Run(Boolean)<br>\r\n&nbsp;&nbsp; at HardySoft.App..ctor()<br>\r\n&nbsp;&nbsp; at HardySoft.App.Main()</p>\r\n<p>What does it mean? Do I miss anything from my WinXP?</p>\r\n<p>Thanks</p>\r\n<p>Hardy</p>\r\n",
    "PostedDate": "2010-10-27T18:28:55.453-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "514161",
    "ThreadId": "232585",
    "Html": "\r\n<p>Hi Hardy,</p>\r\n<p>There is no similar issues reported so far. If you continue experiencing this in your scenario, and also consider this an issue in Prism, you could copy this as a work-item. This way the product team will be notified as well as other users can vote this.<br>\r\n<br>\r\nIn the meantime, could you please share the complete exception message?. It might help to determine a possible reason. Have you checked the length of the modules' directory is not longer than 256 characters?</p>\r\n<p>Fernando Antivero</p>\r\n<p><a href=\"http://blogs.southworks.net/fantivero\">http://blogs.southworks.net/fantivero</a></p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2010-10-28T12:08:54.3-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "514789",
    "ThreadId": "232585",
    "Html": "\r\n<p>I think I found the reason, I have a Windows XP with .Net Framework 4.0 installed only (no 3.5 and/or SP1), when the application runs Prism framework &quot;<span style=\"color:#ff0000\">Could not load file or assembly 'WindowsBase, Version=3.0.0.0, Culture=neutral,\r\n PublicKeyToken=31bf3856ad364e35' or one of its dependencies.</span>&quot; even though I have WindowsBase 4.0 referenced.</p>\r\n<p>I checked download binary of Prism 2, and I think I did not find a setup for 4.0 only.</p>\r\n<p>So do I have to install 3.5 or you can compile with 4.0?</p>\r\n<p>Hardy</p>\r\n",
    "PostedDate": "2010-10-29T16:53:42.41-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "514793",
    "ThreadId": "232585",
    "Html": "\r\n<p>More update, Installed VS2010 on WinXP with .Net 4.0 only, and pulled following more detailed exception message. I even tried to open Prism 2.2 source code in VS2010, switched to Framework 4.0 and removed all reference to 3.5 GAC assemblies, referenced to\r\n all 4.0 GAC assemblies. I recompiled codes, used new Prism DLLs in project, there is still no hope. Is there somewhere in Prism source code hard-coded to look for 3.5 version of WindowBase via reflection?</p>\r\n<p>=======================================</p>\r\n<p>System.IO.FileNotFoundException was unhandled<br>\r\n&nbsp; Message=Could not load file or assembly 'WindowsBase, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies.<br>\r\n&nbsp; Source=mscorlib<br>\r\n&nbsp; FileName=WindowsBase, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35<br>\r\n&nbsp; FusionLog=&quot;&quot;<br>\r\n&nbsp; StackTrace:<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Reflection.RuntimeAssembly.GetExportedTypes(RuntimeAssembly assembly, ObjectHandleOnStack retTypes)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Reflection.RuntimeAssembly.GetExportedTypes()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Practices.Composite.Modularity.DirectoryModuleCatalog.InnerModuleInfoLoader.&lt;&gt;c__DisplayClass2b.&lt;GetNotAllreadyLoadedModuleInfos&gt;b__27(FileInfo file)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Linq.Enumerable.&lt;SelectManyIterator&gt;d__14`2.MoveNext()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Linq.Buffer`1..ctor(IEnumerable`1 source)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Practices.Composite.Modularity.DirectoryModuleCatalog.InnerModuleInfoLoader.GetModuleInfos(String path)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Practices.Composite.Modularity.DirectoryModuleCatalog.InnerModuleInfoLoader.GetModuleInfos(String path)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Practices.Composite.Modularity.DirectoryModuleCatalog.InnerLoad()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Practices.Composite.Modularity.ModuleCatalog.Load()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Practices.Composite.Modularity.ModuleCatalog.Initialize()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Practices.Composite.Modularity.ModuleManager.Run()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Practices.Composite.UnityExtensions.UnityBootstrapper.InitializeModules()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Practices.Composite.UnityExtensions.UnityBootstrapper.Run(Boolean runWithDefaultConfiguration)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Practices.Composite.UnityExtensions.UnityBootstrapper.Run()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at HardySoft.Clinic.App..ctor() in C:\\Projects\\HardySoft\\HardySoft.Shell\\App.xaml.cs:line 15<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at HardySoft.Clinic.App.Main() in C:\\Projects\\HardySoft\\HardySoft.Shell\\obj\\x86\\Debug\\App.g.cs:line 49<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ThreadHelper.ThreadStart_Context(Object state)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ThreadHelper.ThreadStart()<br>\r\n&nbsp; InnerException: System.IO.FileNotFoundException<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Message=Could not load file or assembly 'WindowsBase, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies.<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Source=mscorlib<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileName=WindowsBase, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FusionLog==== Pre-bind state information ===<br>\r\nLOG: User = HARDY-0D941D7AC\\Administrator<br>\r\nLOG: DisplayName = WindowsBase, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35<br>\r\n&nbsp;(Fully-specified)<br>\r\nLOG: Appbase = <a href=\"file:///C:/Projects/HardySoft.Clinic/HardySoft.Clinic.Shell/bin/Debug/\">\r\nfile:///C:/Projects/HardySoft/HardySoft.Shell/bin/Debug/</a><br>\r\nLOG: Initial PrivatePath = NULL<br>\r\nCalling assembly : (Unknown).<br>\r\n===<br>\r\nLOG: This is an inspection only bind.<br>\r\nLOG: Using application configuration file: C:\\Projects\\HardySoft\\HardySoft.Shell\\bin\\Debug\\Test.vshost.exe.Config<br>\r\nLOG: Using host configuration file: <br>\r\nLOG: Using machine configuration file from C:\\WINDOWS\\Microsoft.NET\\Framework\\v4.0.30319\\config\\machine.config.<br>\r\nLOG: Attempting download of new URL <a href=\"file:///C:/Projects/HardySoft.Clinic/HardySoft.Clinic.Shell/bin/Debug/WindowsBase.DLL\">\r\nfile:///C:/Projects/HardySoft/HardySoft.Shell/bin/Debug/WindowsBase.DLL</a>.<br>\r\nLOG: Attempting download of new URL <a href=\"file:///C:/Projects/HardySoft.Clinic/HardySoft.Clinic.Shell/bin/Debug/WindowsBase/WindowsBase.DLL\">\r\nfile:///C:/Projects/HardySoft/HardySoft.Shell/bin/Debug/WindowsBase/WindowsBase.DLL</a>.<br>\r\nLOG: Attempting download of new URL <a href=\"file:///C:/Projects/HardySoft.Clinic/HardySoft.Clinic.Shell/bin/Debug/WindowsBase.EXE\">\r\nfile:///C:/Projects/HardySoft/HardySoft.Shell/bin/Debug/WindowsBase.EXE</a>.<br>\r\nLOG: Attempting download of new URL <a href=\"file:///C:/Projects/HardySoft.Clinic/HardySoft.Clinic.Shell/bin/Debug/WindowsBase/WindowsBase.EXE\">\r\nfile:///C:/Projects/HardySoft/HardySoft.Shell/bin/Debug/WindowsBase/WindowsBase.EXE</a>.</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StackTrace:<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark&amp; stackMark, Boolean throwOnFileNotFound,\r\n Boolean forIntrospection, Boolean suppressSecurityChecks)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Reflection.RuntimeAssembly.nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark&amp; stackMark, Boolean throwOnFileNotFound,\r\n Boolean forIntrospection, Boolean suppressSecurityChecks)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, StackCrawlMark&amp; stackMark, Boolean forIntrospection, Boolean suppressSecurityChecks)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Reflection.RuntimeAssembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark&amp; stackMark, Boolean forIntrospection)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Reflection.Assembly.ReflectionOnlyLoad(String assemblyString)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Practices.Composite.Modularity.DirectoryModuleCatalog.InnerModuleInfoLoader.OnReflectionOnlyResolve(ResolveEventArgs args, DirectoryInfo directory)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Practices.Composite.Modularity.DirectoryModuleCatalog.InnerModuleInfoLoader.&lt;&gt;c__DisplayClass23.&lt;GetModuleInfos&gt;b__20(Object sender, ResolveEventArgs args)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.AppDomain.OnReflectionOnlyAssemblyResolveEvent(RuntimeAssembly assembly, String assemblyFullName)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; InnerException:</p>\r\n",
    "PostedDate": "2010-10-29T17:26:01.68-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "514800",
    "ThreadId": "232585",
    "Html": "\r\n<p>I think I finally found the reason, because in my project I have DocumentFormat.OpenXml.dll referenced, and it references to WindowsBase 3.0.</p>\r\n<p>In \\CAL\\Desktop\\Composite\\Modularity\\DirectoryModuleCatalog.Desktop.cs GetNotAllreadyLoadedModuleInfos method found the reference and try to load this assembly thus failed.</p>\r\n",
    "PostedDate": "2010-10-29T18:09:00.427-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]