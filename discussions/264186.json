[
  {
    "Id": "638472",
    "ThreadId": "264186",
    "Html": "\r\n<p>Hi All,</p>\r\n<p>I am a newbie to Prism. Using MefBootStrapper I am trying to get my first module to load. In my app.config I have:</p>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;</span></p>\r\n<table border=\"1\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td width=\"638\" valign=\"top\">\r\n<p><span style=\"color:blue; font-size:9.5pt\">&lt;</span><span style=\"color:#a31515; font-size:9.5pt\">modules</span><span style=\"color:blue; font-size:9.5pt\">&gt;</span><span style=\"font-size:9.5pt\">&nbsp;</span></p>\r\n<p><span style=\"color:blue; font-size:9.5pt\">&nbsp;&nbsp; &lt;</span><span style=\"color:#a31515; font-size:9.5pt\">module</span><span style=\"color:blue; font-size:9.5pt\">\r\n</span><span style=\"color:red; font-size:9.5pt\">assemblyFile</span><span style=\"color:blue; font-size:9.5pt\">=</span><span style=\"font-size:9.5pt\">&quot;<span style=\"color:blue\">DashBoard.dll</span>&quot;<span style=\"color:blue\">\r\n</span><span style=\"color:red\">moduleType</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">DashBoard.DashBoardModule, DashBoard.DashBoardModule, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null</span>&quot;<span style=\"color:blue\">\r\n</span><span style=\"color:red\">moduleName</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">DashboardModule</span>&quot;<span style=\"color:blue\"> /&gt;</span></span></p>\r\n<p><span style=\"color:blue; font-size:9.5pt\">&lt;/</span><span style=\"color:#a31515; font-size:9.5pt\">modules</span><span style=\"color:blue; font-size:9.5pt\">&gt;</span></p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;</span></p>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;</span></p>\r\n<p>In my module dll I have:</p>\r\n<p>&nbsp;</p>\r\n<table border=\"1\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td width=\"638\" valign=\"top\">\r\n<p><span style=\"font-size:9.5pt\">&nbsp;</span></p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;&nbsp; [<span style=\"color:#2b91af\">ModuleExport</span>(\r\n<span style=\"color:blue\">typeof</span>( <span style=\"color:#2b91af\">DashBoardModule</span> ) )]</span></p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;&nbsp; <span style=\"color:blue\">public</span>\r\n<span style=\"color:blue\">class</span> <span style=\"color:#2b91af\">DashBoardModule</span> :\r\n<span style=\"color:#2b91af\">IModule</span></span></p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;&nbsp; {</span></p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color:blue\">\r\npublic</span> DashBoardModule() </span></p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n<span style=\"color:#2b91af\">Console</span>.WriteLine( <span style=\"color:#a31515\">\r\n&quot;In constructor&quot;</span> )</span></p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;</span></p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color:blue\">\r\npublic</span> <span style=\"color:blue\">void</span> Initialize() </span></p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n<span style=\"color:#2b91af\">Console</span>.WriteLine( <span style=\"color:#a31515\">\r\n&quot;In initialize&quot;</span> )</span></p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;&nbsp; }</span></p>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>&nbsp;</p>\r\n<p>My application starts and the shell is displayed then the following happens</p>\r\n<p>&nbsp;</p>\r\n<table border=\"1\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td width=\"638\" valign=\"top\">\r\n<p>1)<span style=\"font:7pt 'Times New Roman'\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\r\nModuleManager.Run calls <span style=\"font-size:9.5pt\">LoadModulesWhenAvailable</span></p>\r\n<p>2)<span style=\"font:7pt 'Times New Roman'\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\r\n<span style=\"font-size:9.5pt\">Then the first call to ModuleInitializer.CreateModule occurs with my ModuleInfo</span></p>\r\n<p>3)<span style=\"font:7pt 'Times New Roman'\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\r\nIn CreateModule the TryGet if is not executed</p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n<span style=\"color:blue\">if</span> (<span style=\"color:blue\">this</span>.downloadedPartCatalogs.TryGet(moduleInfo,\r\n<span style=\"color:blue\">out</span> partCatalog))</span></p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;</span></p>\r\n<p>but ImportedModueles if is executed which returns IModule for my module</p>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n<span style=\"color:blue\">if</span> (<span style=\"color:blue\">this</span>.ImportedModules !=\r\n<span style=\"color:blue\">null</span> &amp;&amp; <span style=\"color:blue\">this</span>.ImportedModules.Count() != 0)</span></p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Lazy&lt;IModule, IModuleExport&gt; lazyModule =\r\n<span style=\"color:blue\">this</span>.ImportedModules.FirstOrDefault(&hellip;);</span></p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n<span style=\"color:blue\">if</span> (lazyModule != <span style=\"color:blue\">null</span>)</span></p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n<span style=\"color:blue\">return</span> lazyModule.Value;</span></p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>\r\n<p><span style=\"font-size:9.5pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>\r\n<p>4)<span style=\"font:7pt 'Times New Roman'\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\r\n<span style=\"font-size:9.5pt\">My module initialize returns successfully which raises LoadModuleCompleted</span></p>\r\n<p>5)<span style=\"font:7pt 'Times New Roman'\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\r\n<span style=\"font-size:9.5pt\">After that ModuleManager.IModuleTypeLoader_LoadModuleCompleted which calls ModuleInitialer.CreateModule again</span></p>\r\n<p>6)<span style=\"font:7pt 'Times New Roman'\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\r\n<span style=\"font-size:9.5pt\">In second call to CreateModule neither the TryGet if or ImportedModules if are executed and the exception ModuleInitializeException is thrown\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>So I think the ModuleManager tries to retrieve the ModuleInfo after the first call to CreateModule but for some reason this fails. I have looked at this thread:</p>\r\n<p><a title=\"Module Loading Error\" href=\"http://compositewpf.codeplex.com/discussions/247248\">Module Loading Error</a>&nbsp;(<a href=\"http://compositewpf.codeplex.com/discussions/247248\">http://compositewpf.codeplex.com/discussions/247248</a>)</p>\r\n<p>The author adds the following and says it gets around his error:</p>\r\n<p>&nbsp;<span style=\"color:black; font-size:10pt\">Type type = Type.GetType(moduleInfo.ModuleType,\r\n</span><span style=\"color:blue; font-size:10pt\">false</span><span style=\"color:black; font-size:10pt\">,\r\n</span><span style=\"color:blue; font-size:10pt\">true</span><span style=\"color:black; font-size:10pt\">);</span></p>\r\n<p>&nbsp;but I am not sure if this relates to my error. Also I have studied the quick start ModularityWithMef.Desktop, and used some of its code. If anyone could provide any input why ModuleInfo is not found in CreateModule I would appreciate it.</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2011-07-06T16:23:03.94-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "638480",
    "ThreadId": "264186",
    "Html": "<p>I forgot to add the DashBoardModule is in the DashBoard namespace.</p>",
    "PostedDate": "2011-07-06T16:49:29.19-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]