[
  {
    "Id": "1099489",
    "ThreadId": "459309",
    "Html": "I am having trouble getting SyncActiveState to work.  The Prism 4.1 readme states simply:\r<br />\n<br />\n&quot;To support scenarios where a parent view contains scoped regions, the regions and views within that scope may need to be notified when the parent view becomes active.  To handle this the SyncActiveStateAttribute can be applied to a View or ViewModel to ensure notification of the views (or view models) within the scoped regions.&quot;<br />\n\r<br />\n[SyncActiveState]\r<br />\n<br />\npublic class MyViewModel : NotificationObject, IActiveAware\r<br />\n<br />\n{<br />\n<pre><code>   (...)\n</code></pre>\n\n}\r<br />\n<br />\nHowever, I am having trouble getting this to work.  I don't think my problem is the known bug discussed elsewhere, namely, that the parent view must be active when the child view is added to its region.  I believe my problem is in defining the correct region scope.   Does anyone have a &quot;hello world&quot; complete example on how to use SyncActiveState?  This would be a big help to me.   Thanks to all.<br />\n",
    "PostedDate": "2013-09-25T22:43:42.293-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1099769",
    "ThreadId": "459309",
    "Html": "Hi richardfen,\r<br />\n<br />\nI created a sample solution portraying this. You can find it in the following link in my <strong>SkyDrive</strong> account:<br />\n<h1></h1>\n<ul>\n<li>\n<a href=\"https://skydrive.live.com/?cid=3ee28791a0df3126&amp;id=3EE28791A0DF3126%21109\" rel=\"nofollow\">SyncActiveStateAttributeSample</a><br />\n</li>\n</ul>\nThe <strong>SyncActiveStateAttributeSample</strong> sample is structured with a <strong><em>MainRegion</em></strong> with 2 tabs (which are views injected in the main region) and 2 buttons. Each tab contains a <strong><em>SubRegionView</em></strong> which defines a scoped region where another child view is added. Of those child views, the <strong><em>SubView</em></strong> defines the <strong>SyncActiveState</strong> attribute, while the <strong><em>SubNotSyncView</em></strong> doesn´t.\r<br />\nFinally, you can see how the <strong>SyncActiveState</strong> attribute works using the aforementioned buttons. <strong><em>SubView’s</em></strong> <strong>IsActive</strong> property will update when its parent’s <strong>IsActive</strong> property updates, unlike <strong><em>SubNotSyncView</em></strong> from which its <strong>IsActive</strong> property remain unchanged.\r<br />\n<br />\nThere is another available sample regarding the workaround for the issue you mentioned of adding sub views to a deactivated parent view. This workaround is explained in the following blog:<br />\n<h1></h1>\n<ul>\n<li>\n<a href=\"http://blogs.southworks.net/dcherubini/2012/04/19/sync-active-state-when-adding-views/\" rel=\"nofollow\">Sync active state when adding views</a><br />\n</li>\n</ul>\nI hope this helps,\r<br />\nGabriel Ostrowsky\r<br />\n<a href=\"http://blogs.southworks.net/gostrowsky\" rel=\"nofollow\">http://blogs.southworks.net/gostrowsky</a><br />\n",
    "PostedDate": "2013-09-26T10:55:04.747-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1099913",
    "ThreadId": "459309",
    "Html": "\r\n<div dir=\"ltr\">\r\n<div style=\"font-size:12pt; font-family:'Calibri'; color:#000000\">\r\n<p style=\"margin:0in 0in 0pt\"><font face=\"Times New Roman\">Thanks for your prompt reply. This is what I was looking for. Just a couple of questions:</font></p>\r\n<p style=\"margin-left:0in; text-autospace:; margin-right:0in; text-indent:-0.25in\">\r\n<font face=\"Segoe UI\"><span style=\"font-family:\">(1 (1) </span></font><span style=\"font-family:\"><font face=\"Segoe UI\">When I comment out the code below I would expect to see the blue “Not in Sync” view:</font><br>\r\n<br>\r\n</span><font face=\"Consolas\"><span style=\"font-family:; color:\"><font color=\"#0000ff\">public</font></span><span style=\"font-family:; color:\">\r\n</span><span style=\"font-family:; color:\"><font color=\"#0000ff\">void</font></span><span style=\"font-family:; color:\"> Initialize()<br>\r\n{<br>\r\n</span></font><font face=\"Consolas\"><span style=\"font-family:; color:\"><font color=\"#2b91af\">IRegion</font></span><span style=\"font-family:; color:\"> mainRegion =\r\n</span><span style=\"font-family:; color:\"><font color=\"#0000ff\">this</font></span><span style=\"font-family:; color:\">.regionManager.Regions[</span><span style=\"font-family:; color:\"><font color=\"#a31515\">&quot;MainRegion&quot;</font></span><span style=\"font-family:; color:\">];</span></font></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><font face=\"Consolas\"><span style=\"font-family:; color:\"><font color=\"#2b91af\">FrameworkElement</font></span><span style=\"font-family:; color:\"> tabView1 =\r\n</span><span style=\"font-family:; color:\"><font color=\"#2b91af\">ServiceLocator</font></span><span style=\"font-family:; color:\">.Current.GetInstance&lt;Views.</span><span style=\"font-family:; color:\"><font color=\"#2b91af\">ScopedRegionView</font></span><span style=\"font-family:; color:\">&gt;();</span></font></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><font face=\"Consolas\"><span style=\"font-family:; color:\"><font color=\"#2b91af\">IRegionManager</font></span><span style=\"font-family:; color:\"> scopedManager1 = mainRegion.Add(tabView1,\r\n</span><span style=\"font-family:; color:\"><font color=\"#0000ff\">null</font></span><span style=\"font-family:; color:\">,\r\n</span><span style=\"font-family:; color:\"><font color=\"#0000ff\">true</font></span><span style=\"font-family:; color:\">);</span></font></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><font face=\"Consolas\"><span style=\"font-family:; color:\"><font color=\"#2b91af\">FrameworkElement</font></span><span style=\"font-family:; color:\"> tabView2 =\r\n</span><span style=\"font-family:; color:\"><font color=\"#2b91af\">ServiceLocator</font></span><span style=\"font-family:; color:\">.Current.GetInstance&lt;Views.</span><span style=\"font-family:; color:\"><font color=\"#2b91af\">ScopedRegionView</font></span><span style=\"font-family:; color:\">&gt;();</span></font></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><font face=\"Consolas\"><span style=\"font-family:; color:\"><font color=\"#2b91af\">IRegionManager</font></span><span style=\"font-family:; color:\"> scopedManager2 = mainRegion.Add(tabView2,\r\n</span><span style=\"font-family:; color:\"><font color=\"#0000ff\">null</font></span><span style=\"font-family:; color:\">,\r\n</span><span style=\"font-family:; color:\"><font color=\"#0000ff\">true</font></span><span style=\"font-family:; color:\">);</span></font></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><span style=\"font-family:; color:\"><font face=\"Consolas\"><font color=\"#008000\">// FrameworkElement subView = ServiceLocator.Current.GetInstance();</font></font></span></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><span style=\"font-family:; color:\"><font face=\"Consolas\"><font color=\"#008000\">// scopedManager1.Regions[&quot;SubRegion&quot;].Add(subView);</font></font></span></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><font face=\"Consolas\"><span style=\"font-family:; color:\"><font color=\"#2b91af\">FrameworkElement</font></span><span style=\"font-family:; color:\"> subNotSyncView =\r\n</span><span style=\"font-family:; color:\"><font color=\"#2b91af\">ServiceLocator</font></span><span style=\"font-family:; color:\">.Current.GetInstance&lt;Views.</span><span style=\"font-family:; color:\"><font color=\"#2b91af\">SubNotSyncView</font></span><span style=\"font-family:; color:\">&gt;();</span></font></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><font face=\"Consolas\"><span style=\"font-family:; color:\">scopedManager2.Regions[</span><span style=\"font-family:; color:\"><font color=\"#a31515\">&quot;SubRegion&quot;</font></span></font><span style=\"font-family:; color:\"><font face=\"Consolas\"><font size=\"3\">].Add(subNotSyncView);<br>\r\n}<br>\r\n</font><br>\r\n<font size=\"3\" face=\"Arial\">However, the view is blank (just a black border).</font></font></span></p>\r\n<p style=\"margin-left:0in; text-autospace:; margin-right:0in; text-indent:-0.25in\">\r\n<font face=\"Segoe UI\"><span style=\"font-family:\">( (2) </span></font><span style=\"font-family:\"><font face=\"Segoe UI\">I wanted to test the action whereby I would change the parent IsActive and see it reflected in the child that used [SyncActiveState]. Therefore,\r\n I modified CheckViewsState() to simply set the IsActive flag on the view model to false:</font><br>\r\n<br>\r\n</span><font face=\"Consolas\"><span style=\"font-family:; color:\"><font color=\"#0000ff\">public</font></span><span style=\"font-family:; color:\">\r\n</span><span style=\"font-family:; color:\"><font color=\"#0000ff\">void</font></span><span style=\"font-family:; color:\"> CheckViewsState()</span></font><span style=\"font-family:\"></span></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><span style=\"font-family:; color:\"><font face=\"Consolas\">{</font></span></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><font face=\"Consolas\"><span style=\"font-family:; color:\"><font color=\"#0000ff\">foreach</font></span><span style=\"font-family:; color:\"> (</span><span style=\"font-family:; color:\"><font color=\"#0000ff\">object</font></span><span style=\"font-family:; color:\">\r\n element </span><span style=\"font-family:; color:\"><font color=\"#0000ff\">in</font></span><span style=\"font-family:; color:\">\r\n</span><span style=\"font-family:; color:\"><font color=\"#0000ff\">this</font></span><span style=\"font-family:; color:\">.regionManager.Regions[</span><span style=\"font-family:; color:\"><font color=\"#a31515\">&quot;MainRegion&quot;</font></span><span style=\"font-family:; color:\">].Views)</span></font></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><span style=\"font-family:; color:\"><font face=\"Consolas\">{</font></span></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><font face=\"Consolas\"><span style=\"font-family:; color:\"><font color=\"#2b91af\">FrameworkElement</font></span><span style=\"font-family:; color:\"> view = element\r\n</span><span style=\"font-family:; color:\"><font color=\"#0000ff\">as</font></span><span style=\"font-family:; color:\">\r\n</span><span style=\"font-family:; color:\"><font color=\"#2b91af\">FrameworkElement</font></span><span style=\"font-family:; color:\">;</span></font></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><font face=\"Consolas\"><span style=\"font-family:; color:\"><font color=\"#2b91af\">IActiveAware</font></span><span style=\"font-family:; color:\"> viewModel = view.DataContext\r\n</span><span style=\"font-family:; color:\"><font color=\"#0000ff\">as</font></span><span style=\"font-family:; color:\">\r\n</span><span style=\"font-family:; color:\"><font color=\"#2b91af\">IActiveAware</font></span><span style=\"font-family:; color:\">;</span></font></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><font face=\"Consolas\"><span style=\"font-family:; color:\">viewModel.IsActive =\r\n</span><span style=\"font-family:; color:\"><font color=\"#0000ff\">false</font></span><span style=\"font-family:; color:\">;</span></font></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><span style=\"font-family:; color:\"><font face=\"Consolas\">}</font></span></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><font face=\"Consolas\"><span style=\"font-family:; color:\"><font size=\"3\">}<br>\r\n</font><br>\r\n<font size=\"3\" face=\"Arial\">I expected to hit a breakpoint in SubView.xaml.cs on the “set” accessor:<br>\r\n</font><br>\r\n</span><span style=\"font-family:; color:\"><font color=\"#0000ff\">private</font></span><span style=\"font-family:; color:\">\r\n</span><span style=\"font-family:; color:\"><font color=\"#0000ff\">bool</font></span><span style=\"font-family:; color:\"> _isActive;</span></font></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><font face=\"Consolas\"><span style=\"font-family:; color:\"><font color=\"#0000ff\">public</font></span><span style=\"font-family:; color:\">\r\n</span><span style=\"font-family:; color:\"><font color=\"#0000ff\">bool</font></span><span style=\"font-family:; color:\"> IsActive</span></font></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><span style=\"font-family:; color:\"><font face=\"Consolas\">{</font></span></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><span style=\"font-family:; color:\"><font face=\"Consolas\"><font color=\"#0000ff\">get</font></font></span></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><span style=\"font-family:; color:\"><font face=\"Consolas\">{</font></span></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><font face=\"Consolas\"><span style=\"font-family:; color:\"><font color=\"#0000ff\">return</font></span><span style=\"font-family:; color:\"> _isActive;</span></font></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><span style=\"font-family:; color:\"><font face=\"Consolas\">}</font></span></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><span style=\"font-family:; color:\"><font face=\"Consolas\"><font color=\"#0000ff\">set</font></font></span></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><span style=\"font-family:; color:\"><font face=\"Consolas\">{</font></span></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><font face=\"Consolas\"><span style=\"font-family:; color:\">_isActive =\r\n</span><span style=\"font-family:; color:\"><font color=\"#0000ff\">value</font></span><span style=\"font-family:; color:\">;</span></font></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><span style=\"font-family:; color:\"><font face=\"Consolas\">}</font></span></p>\r\n<p style=\"margin:0in 0in 12pt; text-autospace:\"><span style=\"font-family:; color:\"><font face=\"Consolas\">}</font></span></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><span style=\"font-family:; color:\"><font face=\"Arial\">However, I did not hit the breakpoint.\r\n</font></span></p>\r\n<p style=\"margin:0in 0in 0pt; text-autospace:\"><span style=\"font-family:; color:\"></span></p>\r\n<p style=\"margin:0in 0in 12pt; text-autospace:\"><span style=\"font-family:; color:\"><font face=\"Arial\">Could you tell me what I am missing on these two points? Thanks again for your help.</font></span></p>\r\n<p style=\"margin:0in 0in 0pt\"><font face=\"Times New Roman\"></font></p>\r\n</div>\r\n</div>\r\n",
    "PostedDate": "2013-09-26T18:47:38.797-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1100149",
    "ThreadId": "459309",
    "Html": "Hi richardfen, \r<br />\n<br />\nI believe you have got confused with the code of adding the views to the <strong>Regions</strong> and <strong>ScopedRegions</strong>. \r<br />\nThe <strong>HelloWorldModule’s</strong> <strong><em>initialized()</em></strong> method first add 2 <strong>Views</strong> to the <strong><em>MainRegion</em></strong>, where each one is defined in a different tab. Then, these 2  <strong><em>ScopeRegionView</em></strong> views define a scope region manager so both views would have one scoped region manager where the <strong><em>SubRegion</em></strong> would be defined. Finally, <strong><em>SubView</em></strong> and <strong><em>SubNotSyncView</em></strong> are added into the <strong><em>SubRegion</em></strong> region, but on different scope region managers: <br />\n<h1></h1>\n<ul>\n<li><strong><em>SubView</em></strong> is added on “_scopedManager1_” which is defined in “_tabView1_”, and </li>\n<li>\n<strong><em>SubNotSyncView</em></strong> is added on “_scopedManager2_” which is defined in “_tabView2_”.<br />\n</li>\n</ul>\nRegarding your first question, the blue “_Not in Sync_” view wouldn’t appear on the first tab because you are adding it to the <strong><em>SubRegion</em></strong> contained in the scoped region manager “_scopedmanager2_”. A blank view on the first tab is expected as you are not adding any view to the <strong><em>SubRegion</em></strong> contained in “_scopedManager1_”. And if you move to the second tab window, you may actually see the blue “_Not in Sync_” view.\r<br />\n<br />\nOn regards to the second question, the <strong>SyncAtiveState</strong> attribute is validated on the <strong>RegionActiveAwareBehavior</strong> behavior when the region’s <strong>ActiveViews</strong> collection changes. Based on my understanding, the <strong>RegionActiveAwareBehavior</strong> subscribes to the <strong>CollectionChanged</strong> event of the <strong>ActiveViews</strong> collection of the corresponding <strong>Region</strong>. When the aforementioned collection is changed, the behavior changes the state of the views that are added or removed from the collection. This means that this behavior only executes its logic when a view is <strong>activated</strong> or <strong>deactivated</strong>.\r<br />\nThrough the inclusion of the <strong>SyncActiveState</strong> attribute, during the state change, this behavior now also checks for any scoped views with the aforementioned attribute and set its state too. You can see this on the following <strong>RegionActiveAwareBehavior</strong> handler method:<br />\n<div style=\"color:Black;background-color:White;\"><pre>\r\n<span style=\"color:Blue;\">private</span> <span style=\"color:Blue;\">void</span> OnCollectionChanged(<span style=\"color:Blue;\">object</span> sender, NotifyCollectionChangedEventArgs e)\n{\n    <span style=\"color:Blue;\">if</span> (e.Action == NotifyCollectionChangedAction.Add)\n    {\n        <span style=\"color:Blue;\">foreach</span> (<span style=\"color:Blue;\">object</span> item <span style=\"color:Blue;\">in</span> e.NewItems)\n        {\n             Action&lt;IActiveAware&gt; invocation = activeAware =&gt; activeAware.IsActive = <span style=\"color:Blue;\">true</span>;\n\n             InvokeOnActiveAwareElement(item, invocation);\n             InvokeOnSynchronizedActiveAwareChildren(item, invocation);\n        }\n    }\n    <span style=\"color:Blue;\">else</span> <span style=\"color:Blue;\">if</span> (e.Action == NotifyCollectionChangedAction.Remove)\n    {\n        <span style=\"color:Blue;\">foreach</span> (<span style=\"color:Blue;\">object</span> item <span style=\"color:Blue;\">in</span> e.OldItems)\n        {\n             Action&lt;IActiveAware&gt; invocation = activeAware =&gt; activeAware.IsActive = <span style=\"color:Blue;\">false</span>;\n\n             InvokeOnActiveAwareElement(item, invocation);\n             InvokeOnSynchronizedActiveAwareChildren(item, invocation);\n        }\n    }\n\n    <span style=\"color:Green;\">// May need to handle other action values (reset, replace). Currently the ViewsCollection class does not raise CollectionChanged with these values.</span>\n}\r\n</pre></div>Therefore, you could try to <strong><em>deactivate()</em></strong> or <strong><em>activate()</em></strong> the parent view in order to hit the breakpoint on the <strong><em>SubView</em></strong> setter as shown in the following code, or you could simply move from one tab to another (<em>changing tabs make the views to get activated and deactivated</em>):<br />\n<div style=\"color:Black;background-color:White;\"><pre>\r\n<span style=\"color:Blue;\">public</span> <span style=\"color:Blue;\">void</span> CheckViewsState()\n{   \n    <span style=\"color:Blue;\">foreach</span> (<span style=\"color:Blue;\">object</span> element <span style=\"color:Blue;\">in</span> <span style=\"color:Blue;\">this</span>.regionManager.Regions[<span style=\"color:#A31515;\">&quot;MainRegion&quot;</span>].Views)\n    {\n        FrameworkElement view = element <span style=\"color:Blue;\">as</span> FrameworkElement;\n        regionManager.Regions[<span style=\"color:#A31515;\">&quot;MainRegion&quot;</span>].Deactivate(view);\n    }\n}\r\n</pre></div>I hope this helped you.\r<br />\nGabriel Ostrowsky\r<br />\n<a href=\"http://blogs.southworks.net/gostrowsky\" rel=\"nofollow\">http://blogs.southworks.net/gostrowsky</a><br />\n",
    "PostedDate": "2013-09-27T08:11:33.367-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1100364",
    "ThreadId": "459309",
    "Html": "I tried all your suggestions and they work.  Thanks very much for so much attention to this problem.  This has given my understanding of Prism a quantum leap.<br />\n\r<br />\nI added some of my own comments (from a neophyte) as shown below: \r<br />\n<br />\n<br />\npublic void Initialize()<br />\n<pre><code>    {\n        // we have here a main region into which we put a tab control. This is from Shell.xaml.  Then we add individual tabs\n        // to this region.  Each tab contains a region, specifically &quot;SubRegion&quot;.  Therefore, we can't add them to the main region\n        // because the region manager will have nested sub regions using the same string name.\n\n        IRegion mainRegion = this.regionManager.Regions[&quot;MainRegion&quot;];\n\n        FrameworkElement tabView1 = ServiceLocator.Current.GetInstance&lt;Views.ScopedRegionView&gt;();\n        IRegionManager scopedManager1 = mainRegion.Add(tabView1, null, true);\n\n        FrameworkElement tabView2 = ServiceLocator.Current.GetInstance&lt;Views.ScopedRegionView&gt;();\n        IRegionManager scopedManager2 = mainRegion.Add(tabView2, null, true);\n\n        // If we delete the next two lines, we do not see the blue screen and white text &quot;subview does not synch \n        // with parent view screen&quot; because tabView1 is selected by default.  We would have to select the \n        // tabView2 to see this screen.  Alternatively, we could change scopedManager2 below to scopedManager1 \n        // and we would see the blue screen because // scoped manager 1 is the region that is now inside \n        // tabView1 which is selected.  \n        FrameworkElement subView = ServiceLocator.Current.GetInstance&lt;Views.SubView&gt;();\n        scopedManager1.Regions[&quot;SubRegion&quot;].Add(subView);\n\n        FrameworkElement subNotSyncView = ServiceLocator.Current.GetInstance&lt;Views.SubNotSyncView&gt;();\n        scopedManager2.Regions[&quot;SubRegion&quot;].Add(subNotSyncView);\n\n</code></pre>\n\nWe can close this incident now.   Thanks again.<br />\n",
    "PostedDate": "2013-09-28T01:14:31.34-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]