[
  {
    "Id": "554965",
    "ThreadId": "243202",
    "Html": "\r\n<p>Dear All,</p>\r\n<p>I have reched PRISM after a lot of reading amd decided to use it as a framework to develop my new Silverlight 4 application.</p>\r\n<p>I layout my project into 5 different projects, then I define the module catalog as follows:</p>\r\n<p>the cataloge xaml file :-&nbsp;</p>\r\n<div style=\"background-color:white; color:black\">\r\n<pre><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Modularity</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">ModuleCatalog</span> <span style=\"color:red\">xmlns</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.microsoft.com/winfx/2006/xaml/presentation</span><span style=\"color:black\">&quot;</span> \r\n\t<span style=\"color:red\">xmlns:x</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.microsoft.com/winfx/2006/xaml</span><span style=\"color:black\">&quot;</span> \r\n\t<span style=\"color:red\">xmlns:sys</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">clr-namespace:System;assembly=mscorlib</span><span style=\"color:black\">&quot;</span> \r\n\t<span style=\"color:red\">xmlns:Modularity</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">clr-namespace:Microsoft.Practices.Prism.Modularity;assembly=Microsoft.Practices.Prism</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n\r\n\t<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Modularity</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">ModuleInfoGroup</span> <span style=\"color:red\">Ref</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">GL.Modules.AVT.xap</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">InitializationMode</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">WhenAvailable</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n\t\t<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Modularity</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">ModuleInfo</span> <span style=\"color:red\">ModuleName</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">AVTModule</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n\t<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">Modularity</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">ModuleInfoGroup</span><span style=\"color:blue\">&gt;</span>\r\n\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">Modularity</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">ModuleCatalog</span><span style=\"color:blue\">&gt;</span>\r\n</pre>\r\n<pre>Then, I build the AVTModel class into the AVT project as follows:</pre>\r\n<pre><div style=\"background-color:white; color:black\"><pre><span style=\"color:blue\">namespace</span> GL.Modules.AVT\r\n{\r\n\t[ModuleExport(<span style=\"color:blue\">typeof</span>(AVTModule))]\r\n\t<span style=\"color:blue\">public</span> <span style=\"color:blue\">class</span> AVTModule : IModule\r\n\t{\r\n\t\t[Import]\r\n\t\t<span style=\"color:blue\">public</span> IRegionManager RegionManager;\r\n\r\n\t\t<span style=\"color:blue\">public</span> <span style=\"color:blue\">void</span> Initialize()\r\n\t\t{\r\n\t\t\tRegionManager.RegisterViewWithRegion(RegionNames.MainNavigationRegion, \r\n\t\t\t\t\t\t<span style=\"color:blue\">typeof</span>(Views.CurrencyNavigationItemView));\r\n\t\t}\r\n\t}\r\n}\r\n</pre>\r\n<pre>And also defined the bootstrapper class as follows:</pre>\r\n<pre><div style=\"background-color:white; color:black\"><pre>\t<span style=\"color:blue\">public</span> <span style=\"color:blue\">class</span> GlBootStrapper : MefBootstrapper\r\n\t{\r\n       <span style=\"color:blue\">private</span> <span style=\"color:blue\">const</span> <span style=\"color:blue\">string</span> ModuleCatalogUri = <span style=\"color:#a31515\">&quot;/GL;component/ModulesCatalog.xaml&quot;</span>;\r\n\r\n\t\t<span style=\"color:blue\">protected</span> <span style=\"color:blue\">override</span> DependencyObject CreateShell()\r\n\t\t{\r\n\t\t\t<span style=\"color:blue\">return</span> <span style=\"color:blue\">this</span>.Container.GetExportedValue&lt;Shell&gt;();\r\n\t\t}\r\n\t\t<span style=\"color:blue\">protected</span> <span style=\"color:blue\">override</span> <span style=\"color:blue\">void</span> InitializeShell()\r\n\t\t{\r\n\t\t\t<span style=\"color:blue\">base</span>.InitializeShell();\r\n\t\t\tApplication.Current.RootVisual = (UIElement)<span style=\"color:blue\">this</span>.Shell;\r\n\t\t}\r\n\t\t<span style=\"color:blue\">protected</span> <span style=\"color:blue\">override</span> IModuleCatalog CreateModuleCatalog()\r\n\t\t{\r\n\t\t\t<span style=\"color:blue\">return</span> Microsoft.Practices.Prism.Modularity.ModuleCatalog.CreateFromXaml(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span style=\"color:blue\">new</span> Uri(ModuleCatalogUri, UriKind.Relative));\r\n\t\t}\r\n\t\t<span style=\"color:blue\">protected</span> <span style=\"color:blue\">override</span> <span style=\"color:blue\">void</span> ConfigureAggregateCatalog()\r\n\t\t{\r\n\t\t\t<span style=\"color:blue\">base</span>.ConfigureAggregateCatalog();\r\n\r\n\t\t\t<span style=\"color:blue\">this</span>.AggregateCatalog.Catalogs.Add(<span style=\"color:blue\">new</span> AssemblyCatalog(<span style=\"color:blue\">typeof</span>(GlBootStrapper).Assembly));\r\n\t\t}\r\n\r\n\t}\r\n</pre>\r\n</div>\r\nWhen I run the application I got an exception as follows:</pre>\r\n<pre><p>Webpage error details</p><p>User Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; GTB6.6; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; .NET4.0C; .NET4.0E)<br>Timestamp: Tue, 25 Jan 2011 12:24:34 UTC</p><p><br>Message: Unhandled Error in Silverlight Application <br>Code: 4004&nbsp;&nbsp;&nbsp; <br>Category: ManagedRuntimeError&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br><strong>Message: Microsoft.Practices.Prism.Modularity.ModuleTypeLoadingException: Failed to load type for module AVTModule</strong>.</p><p><span style=\"color:#ff0000\"><em>If this error occurred when using MEF in a Silverlight application, please ensure that the CopyLocal property of the reference to the MefExtensions assembly is set to true in the main application/shell and false in all other assemblies.</em></span></p><p>Error was: The package downloaded successfully but an error occurred while reading the contents of the package. See the inner exception for more details.. ---&gt; System.InvalidOperationException: The package downloaded successfully but an error occurred while reading the contents of the package. See the inner exception for more details. ---&gt; System.Reflection.ReflectionTypeLoadException: Unable to load one or more of the requested types. Retrieve the LoaderExceptions property for more information.<br>&nbsp;&nbsp; at System.Reflection.RuntimeModule.GetTypes(RuntimeModule module)<br>&nbsp;&nbsp; at System.Reflection.RuntimeModule.GetTypes()<br>&nbsp;&nbsp; at System.Reflection.Assembly.GetTypes()<br>&nbsp;&nbsp; at System.ComponentModel.Composition.Hosting.AssemblyCatalog.get_InnerCatalog()<br>&nbsp;&nbsp; at System.ComponentModel.Composition.Hosting.AssemblyCatalog.get_Parts()<br>&nbsp;&nbsp; at System.ComponentModel.Composition.Hosting.DeploymentCatalog.DiscoverParts(IEnumerable`1 assemblies)<br>&nbsp;&nbsp; at System.ComponentModel.Composition.Hosting.DeploymentCatalog.HandleOpenReadCompleted(Object sender, OpenReadCompletedEventArgs e)<br>&nbsp;&nbsp; --- End of inner exception stack trace ---<br>&nbsp;&nbsp; --- End of inner exception stack trace ---<br>&nbsp;&nbsp; at Microsoft.Practices.Prism.Modularity.ModuleManager.HandleModuleTypeLoadingError(ModuleInfo moduleInfo, Exception exception)<br>&nbsp;&nbsp; at Microsoft.Practices.Prism.Modularity.ModuleManager.IModuleTypeLoader_LoadModuleCompleted(Object sender, LoadModuleCompletedEventArgs e)<br>&nbsp;&nbsp; at Microsoft.Practices.Prism.MefExtensions.Modularity.MefXapModuleTypeLoader.RaiseLoadModuleCompleted(LoadModuleCompletedEventArgs e)<br>&nbsp;&nbsp; at Microsoft.Practices.Prism.MefExtensions.Modularity.MefXapModuleTypeLoader.RaiseLoadModuleCompleted(ModuleInfo moduleInfo, Exception error)<br>&nbsp;&nbsp; at Microsoft.Practices.Prism.MefExtensions.Modularity.MefXapModuleTypeLoader.HandleDownloadCompleted(DeploymentCatalog deploymentCatalog, AsyncCompletedEventArgs e)<br>&nbsp;&nbsp; at Microsoft.Practices.Prism.MefExtensions.Modularity.MefXapModuleTypeLoader.DeploymentCatalog_DownloadCompleted(Object sender, AsyncCompletedEventArgs e)<br>&nbsp;&nbsp; at System.ComponentModel.Composition.Hosting.DeploymentCatalog.OnDownloadCompleted(AsyncCompletedEventArgs e)<br>&nbsp;&nbsp; at System.ComponentModel.Composition.Hosting.DeploymentCatalog.HandleOpenReadCompleted(Object sender, OpenReadCompletedEventArgs e)<br>&nbsp;&nbsp; at System.Net.WebClient.OnOpenReadCompleted(OpenReadCompletedEventArgs e)<br>&nbsp;&nbsp; at System.Net.WebClient.OpenReadOperationCompleted(Object arg)&nbsp;&nbsp;&nbsp;&nbsp;</p><p>Line: 56<br>Char: 13<br>Code: 0<br>URI: <a href=\"http://localhost:4692/GLTestPage.aspx\"><span style=\"color:#3e62a6\">http://localhost:4692/GLTestPage.aspx</span></a></p><p>&nbsp;</p><p>I already checked the Mef assembly copy local is false in the other project !!</p><p>&nbsp;</p><p>What could be the reason of this error ..</p><p>Thanks and best regards</p><p>Waleed</p></pre>\r\n</div>\r\n</pre>\r\n</div>\r\n",
    "PostedDate": "2011-01-25T05:06:22.743-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "555027",
    "ThreadId": "243202",
    "Html": "\r\n<p>Hi Waleed,</p>\r\n<p>The exception you're experiencing might be because you're setting the Region Manager as an import, and using it in the Initialize method, where it might have not been resolved.</p>\r\n<p>One possible workaround for that would be to make use of constructor injection, so as to make sure that the import of type IRegionManager has been resolved at the time you call the\r\n<strong>RegisterViewWithRegion </strong>method in your module's <strong>Initialize</strong> method. To illustrate this:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>    [ModuleExport(<span style=\"color:blue\">typeof</span>(AVTModule))]\r\n    <span style=\"color:blue\">public</span> <span style=\"color:blue\">class</span> AVTModule : IModule\r\n    {\r\n        <span style=\"color:blue\">private</span> IRegionManager regionManager;\r\n\r\n        [ImportingConstructor]<br>        <span style=\"color:blue\">public</span> AVTModule(IRegionManager regionManager)\r\n        {\r\n            <span style=\"color:blue\">this</span>.regionManager = regionManager;\r\n        }\r\n\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">void</span> Initialize()\r\n        {\r\n            RegionManager.RegisterViewWithRegion(RegionNames.MainNavigationRegion,\r\n                        <span style=\"color:blue\">typeof</span>(Views.CurrencyNavigationItemView));\r\n        }\r\n    }\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>I hope you find this helpful.</p>\r\n<p>Guido Leandro Maliandi <br>\r\n<a href=\"http://blogs.southworks.net/gmaliandi\">http://blogs.southworks.net/gmaliandi</a></p>\r\n",
    "PostedDate": "2011-01-25T06:48:21.58-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "555222",
    "ThreadId": "243202",
    "Html": "\r\n<p>Hello Guido,</p>\r\n<p>Appreciate your reply indeed ... I understand that passing the regionmanager in the constructor is NOT MEF .. I am not sure if this is true....</p>\r\n<p>I try your solution but still not working ... still getting the same exception :(</p>\r\n<p>Regards</p>\r\n",
    "PostedDate": "2011-01-25T13:16:36.313-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "555239",
    "ThreadId": "243202",
    "Html": "\r\n<p>Hi Waleed,</p>\r\n<p>Constructor injection is supported by MEF. In order to achieve it, you must mark your constructor with the\r\n<strong>ImportingConstructor </strong>attribute. You can read more about it in <a href=\"http://mef.codeplex.com/wikipage?title=Declaring%20Imports&referringTitle=Guide\">\r\nthis page</a> from the <a href=\"http://mef.codeplex.com/wikipage?title=Guide&referringTitle=Home\">\r\nMef Programming Guide</a>.</p>\r\n<p>I've modified my previous response to reflect that, since I had missed to include that in the code I had written. Sorry for the inconveniences.</p>\r\n<p>Guido Leandro Maliandi <br>\r\n<a href=\"http://blogs.southworks.net/gmaliandi\">http://blogs.southworks.net/gmaliandi</a></p>\r\n",
    "PostedDate": "2011-01-25T13:42:47.56-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "555488",
    "ThreadId": "243202",
    "Html": "\r\n<p>Hello Guido,</p>\r\n<p>Here is my current code</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>\t[ModuleExport(<span style=\"color:blue\">typeof</span>(AVTModule))]\r\n\t<span style=\"color:blue\">public</span> <span style=\"color:blue\">class</span> AVTModule : IModule\r\n\t{\r\n\t\t<span style=\"color:green\">//[Import]</span>\r\n\t\t<span style=\"color:blue\">public</span> IRegionManager RegionManager;\r\n\r\n\t\t[ImportingConstructor]\r\n\t\t<span style=\"color:blue\">public</span> AVTModule(IRegionManager regionManager)\r\n\t\t{\r\n\t\t\t<span style=\"color:blue\">this</span>.RegionManager = regionManager;\r\n\t\t}\r\n\r\n\t\t<span style=\"color:blue\">public</span> <span style=\"color:blue\">void</span> Initialize()\r\n\t\t{\r\n\t\t\tRegionManager.RegisterViewWithRegion(RegionNames.MainNavigationRegion, \r\n\t\t\t<span style=\"color:blue\">typeof</span>(Views.CurrencyNavigationItemView));\r\n\t\t}\r\n\t}\r\n\r\n</pre>\r\n</div>\r\n<p>Still not working .... some sort of hidden stuff needed ... I guess.</p>\r\n<p>Regards</p>\r\n",
    "PostedDate": "2011-01-26T03:45:16.59-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "555496",
    "ThreadId": "243202",
    "Html": "\r\n<p>Important to notice that the debugger doesn't hit this class at all .... If I insert a breakpoint in the first line ... nothing is hit.</p>\r\n<p>WHY ???</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2011-01-26T04:02:13.313-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "555517",
    "ThreadId": "243202",
    "Html": "\r\n<p>Dear Guido,</p>\r\n<p>I just figure it out ... None of the PRISM dll's should be copy local , all should be set to FALSE.</p>\r\n<p>It just worked !!</p>\r\n<p>Regards,</p>\r\n<p>Waleed</p>\r\n",
    "PostedDate": "2011-01-26T04:57:04.273-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "555565",
    "ThreadId": "243202",
    "Html": "\r\n<p>Hi Waleed,</p>\r\n<p>I'm glad that you've found a solution to your problem. Thank you for sharing this with the rest of the community, as other users facing similar problems might benefit from this.</p>\r\n<p>Guido Leandro Maliandi <br>\r\n<a href=\"http://blogs.southworks.net/gmaliandi\">http://blogs.southworks.net/gmaliandi</a></p>\r\n",
    "PostedDate": "2011-01-26T06:42:40.57-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]