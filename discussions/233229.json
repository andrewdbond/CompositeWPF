[
  {
    "Id": "516140",
    "ThreadId": "233229",
    "Html": "\r\n<p>I've posted about a project I'm working on and the code.&nbsp; It's a modular SL 4 app using a xaml file to specify the modules to load.</p>\r\n<p>Today I created a new module, have it setup with the basics.&nbsp; Added it to my config file.</p>\r\n<p>I've looked in the Bootstrapper and the module appears to be loaded as I can see the exports from the module.&nbsp; But the module constructor or Initialize isn't firing.</p>\r\n<p>The module is defined as follows:</p>\r\n<p>&nbsp;&nbsp;&nbsp; [ModuleExport(typeof(ScanningModule), InitializationMode = InitializationMode.WhenAvailable)]<br>\r\n&nbsp;&nbsp;&nbsp; public class ScanningModule : IModule</p>\r\n<p>&nbsp;</p>\r\n<p>It's entry in the config file.</p>\r\n<p><br>\r\n&nbsp;&nbsp;&nbsp; &lt;Modularity:ModuleInfo Ref=&quot;EyeCue.Modules.Scanning.xap&quot; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ModuleName=&quot;ScanningModule&quot;\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; InitializationMode=&quot;WhenAvailable&quot;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ModuleType=&quot;EyeCue.Modules.Scanning.ScanningModule, EyeCue.Modules.Scanning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null&quot; /&gt;</p>\r\n<p>The question is how do we troubleshoot why a module isn't loading when</p>\r\n<p>protected override void InitializeModules()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; base.InitializeModules();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>\r\n<p>is used.</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2010-11-02T14:24:51.943-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "516498",
    "ThreadId": "233229",
    "Html": "\r\n<p>Hi,</p>\r\n<p>I think that you can find the following forum threads interesting, since other users with a similar scenario found the solution:</p>\r\n<ul>\r\n<li><a href=\"http://compositewpf.codeplex.com/Thread/View.aspx?ThreadId=231403\"><span>Issue Boostrapping Catalog from XAML in SL</span></a>\r\n</li><li><a href=\"http://compositewpf.codeplex.com/Thread/View.aspx?ThreadId=221865\"><span>Problems loading ModuleCatalog from XAML</span></a>\r\n</li></ul>\r\n<p>Hope this helps.</p>\r\n<p>Fernando Antivero <br>\r\n<a href=\"http://blogs.southworks.net/fantivero\">http://blogs.southworks.net/fantivero</a></p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2010-11-03T08:25:44.933-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "516802",
    "ThreadId": "233229",
    "Html": "\r\n<p>Thanks Fantivero for the response.&nbsp; I've really got to get this one figured out.</p>\r\n<p>FYI.&nbsp; This is my 3rd module I'm adding to the project.&nbsp; The first two have worked flawlessly and I created this one the</p>\r\n<p>Thread one doesn't apply as I have that set and the .xap file is showing up in the Web project.&nbsp; I've actually removed it and readded etc just to make sure.&nbsp;</p>\r\n<p>Just about an hour ago, I decided to figure out what the CallbackLogger does.&nbsp; So I created a class and wired it up in the bootstrapper and set a break point in the log method.&nbsp; To my surprise there is an exception message coming back.&nbsp; I\r\n don't understand why if there is an exception, the ModuleManager isn't rethrowing it so get notified of the problem.</p>\r\n<p>Now to the info.&nbsp; It looks to be MEF related at first look but it just doesn't make sense.</p>\r\n<p>First here is the exception message.</p>\r\n<p>Microsoft.Practices.Prism.Modularity.ModuleInitializeException: An exception occurred while initializing module 'ScanningModule'.\r\n<br>\r\n&nbsp;&nbsp;&nbsp; - The exception message was: The composition remains unchanged. The changes were rejected because of the following error(s): The composition produced multiple composition errors, with 6 root causes. The root causes are provided below. Review\r\n the CompositionException.Errors property for more detailed information.</p>\r\n<p>1) Change in exports prevented by non-recomposable import 'EyeCue.ShellViewModel.PopupController (ContractName=&quot;EyeCue.Common.IPopupController&quot;)' on part 'EyeCue.ShellViewModel'.</p>\r\n<p>2) Change in exports prevented by non-recomposable import 'EyeCue.ShellController..ctor (Parameter=&quot;logService&quot;, ContractName=&quot;EyeCue.Common.ILogService&quot;)' on part 'EyeCue.ShellController'.</p>\r\n<p>3) Change in exports prevented by non-recomposable import 'EyeCue.ShellController..ctor (Parameter=&quot;popupController&quot;, ContractName=&quot;EyeCue.Common.IPopupController&quot;)' on part 'EyeCue.ShellController'.</p>\r\n<p>4) Change in exports prevented by non-recomposable import 'EyeCue.Modules.AppSettings.AppSettingController..ctor (Parameter=&quot;popupController&quot;, ContractName=&quot;EyeCue.Common.IPopupController&quot;)' on part 'EyeCue.Modules.AppSettings.AppSettingController'.</p>\r\n<p>5) Change in exports prevented by non-recomposable import 'EyeCue.ShellController..ctor (Parameter=&quot;logService&quot;, ContractName=&quot;EyeCue.Common.ILogService&quot;)' on part 'EyeCue.ShellController'.</p>\r\n<p>6) Change in exports prevented by non-recomposable import 'EyeCue.ShellController..ctor (Parameter=&quot;popupController&quot;, ContractName=&quot;EyeCue.Common.IPopupController&quot;)' on part 'EyeCue.ShellController'.</p>\r\n<p>&nbsp;</p>\r\n<p>What doesn't make sense is it states my new ScanningModule failed but the compostion errors are with EyeCue.ShellViewModel.PopupController.</p>\r\n<p>PopupController is defined in my EyeCue.Common assembly where all shared items are created.&nbsp; In the bootstrapper, after I call the CreateFromXaml here</p>\r\n<p>protected override IModuleCatalog CreateModuleCatalog()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IModuleCatalog _modCat = Microsoft.Practices.Prism.Modularity.ModuleCatalog.CreateFromXaml(new Uri(ModuleCatalogUri, UriKind.Relative));<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return _modCat;</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>\r\n<p>As we've went into in another thread in my dealings with Modules, for Exports to be available I have to override CreateContainer.</p>\r\n<p>protected override CompositionContainer CreateContainer()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var _container = base.CreateContainer();<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.AggregateCatalog.Catalogs.Add(new AssemblyCatalog(typeof(Bootstrapper).Assembly));<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.AggregateCatalog.Catalogs.Add(new AssemblyCatalog(typeof(GlobalValues).Assembly));</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CompositionHost.Initialize(_container);</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return _container;</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>\r\n<p>My new ScanningModule is plain right now.&nbsp; It has a Module that Imports a Controller class which has a constructor that uses ImportConstructor.</p>\r\n<p>It imports IPopupController.&nbsp;</p>\r\n<p>public ScanningController(IRegionManager regionManager, ScanningRootTemplateView scanningRootTemplateView, ScanningMainView scanningMainView, IPopupController popupController)</p>\r\n<p>So for testing I remove popupController but I'm still getting the same exception and now my other modules are throwing an exception of the same type.</p>\r\n<p>It doesn't make sense.&nbsp; I have 3 modules now.&nbsp; The previous 2 were TruckStat &amp; Appsettings.&nbsp; (I've abbreviated the full names)</p>\r\n<p>They each have a controller that fires on load up.&nbsp; Their controller's constructor's also import IPopupController and they worked fine.</p>\r\n<p>It's almost like this module is causing a new DeploymentCatalog created or obviously it's causing PopupController part to change but it doesn't make sense how or why.</p>\r\n<p>I've even removed the ImportConstructor in my new ScanningModule and I'm still getting the same exceptions</p>\r\n<p>I don't understand how the other modules don't initiate this problem but this one does.</p>\r\n",
    "PostedDate": "2010-11-03T18:38:11.877-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "520148",
    "ThreadId": "233229",
    "Html": "\r\n<p>Hi,</p>\r\n<p>Based on my understanding you might continue experiencing an issue when loading modules in your application. So, if you do, could you please provide a repro sample?</p>\r\n<p>Fernando Antivero <br>\r\n<a href=\"http://blogs.southworks.net/fantivero\">http://blogs.southworks.net/fantivero</a></p>\r\n",
    "PostedDate": "2010-11-10T11:45:40.257-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "520149",
    "ThreadId": "233229",
    "Html": "\r\n<p>The app I'm working in is too large to create a repro.</p>\r\n<p><a href=\"http://cid-ff05a29e13af7bfd.office.live.com/self.aspx/.Public/ModuleTemplate.rar#resId/FF05A29E13AF7BFD!229\">http://cid-ff05a29e13af7bfd.office.live.com/self.aspx/.Public/ModuleTemplate.rar#resId/FF05A29E13AF7BFD!229</a></p>\r\n<p>contains a sample.&nbsp; Just add another module assembly and you should see the problem.</p>\r\n<p>I've actually worked around this by utilizing an ImportMany on the things I've described above but I only had to do them in the Main Silverlight app and don't have to do them in any of my modules that import the same part.</p>\r\n<p>So why would just adding a module cause this change in behavior?</p>\r\n<p>More concerning is why an exception isn't getting thrown when a module doesn't load?&nbsp; I shouldn't have to have a debugger connected sifting through the ILoggerFacade to try and determine the problem.</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2010-11-10T11:50:31.053-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]