[
  {
    "Id": "816119",
    "ThreadId": "350214",
    "Html": "\r\n<p>I have a bunch of views which are displayed via<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp; [ViewExport(RegionName = RegionName.NavBar)]<br>\r\n&nbsp;&nbsp;&nbsp; [PartCreationPolicy(CreationPolicy.NonShared)]<br>\r\n&nbsp;&nbsp;&nbsp; public partial class MyNavBar : UserControl<br>\r\n&nbsp;&nbsp;&nbsp; { /// <br>\r\n&nbsp;&nbsp;&nbsp; }<br>\r\n<br>\r\netc. and they work fine<br>\r\n<br>\r\nHowever subsequently after the views are displayed and on some user action, i check on the IRegionManager declared as follows&nbsp; ( via MEF )<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp; [IMPORT] IRegionManager rmgr;<br>\r\n<br>\r\nand</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rmgr.Regions.Count() <br>\r\n<br>\r\nreturns ZERO<br>\r\n<br>\r\n<br>\r\nwhich throws my logic totally off&nbsp; - checking if the view already exists and if not create and display it\r\n<br>\r\n<br>\r\nany clues ?<br>\r\n<br>\r\nFYI - i am not using any locally scoped region managers, it's pretty vanilla usage</p>\r\n",
    "PostedDate": "2012-03-27T07:57:45.71-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "816235",
    "ThreadId": "350214",
    "Html": "<p>Hi,<br /> <br /> So far, we couldn't reproduce the behavior you are mentioning. We tried using <strong> ViewExport </strong>attribute with <strong>MEF </strong>and importing the <strong> RegionManager </strong>as you mentioned but we obtain the regions count from the <strong>RegionManager </strong>as expected.</p>\n<p>Perhaps, you could provide us with a little more information about your scenario or a repro sample application so we can help you further with this.</p>\n<p>Regards,</p>\n<p>Agustin Adami<a href=\"http://blogs.southworks.net/aadami\"><br /> http://blogs.southworks.net/aadami</a>ï»¿</p>",
    "PostedDate": "2012-03-27T12:54:56.54-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "816732",
    "ThreadId": "350214",
    "Html": "<p>Hi Agustin</p>\n<p>tried the following to no avail</p>\n<pre class=\"lang-cs prettyprint\"><code><span class=\"pun\">[</span><span class=\"typ\">Import</span><span class=\"pun\">]</span><span class=\"pln\"> </span><span class=\"typ\">IRegionManager</span><span class=\"pln\"> rmgr</span><span class=\"pun\">;</span><span class=\"pln\"><br />&nbsp; &nbsp; </span><span class=\"pun\">[</span><span class=\"typ\">Import</span><span class=\"pun\">]</span><span class=\"pln\"> </span><span class=\"typ\">CompositionContainer</span><span class=\"pln\"> container</span><span class=\"pun\">;</span><span class=\"pln\"><br /><br />&nbsp; &nbsp; </span><span class=\"kwd\">void</span><span class=\"pln\"> changeView</span><span class=\"pun\">&lt;</span><span class=\"pln\">T</span><span class=\"pun\">&gt;(</span><span class=\"kwd\">int</span><span class=\"pln\"> arg</span><span class=\"pun\">)</span><span class=\"pln\"><br />&nbsp; &nbsp; </span><span class=\"pun\">{</span><span class=\"pln\"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class=\"typ\">IRegionManager</span><span class=\"pln\"> rm1 </span><span class=\"pun\">=</span><span class=\"pln\"> container</span><span class=\"pun\">.</span><span class=\"typ\">GetExportedValue</span><span class=\"pun\">&lt;</span><span class=\"typ\">IRegionManager</span><span class=\"pun\">&gt;();</span><span class=\"pln\"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class=\"typ\">IRegionManager</span><span class=\"pln\"> rm2 </span><span class=\"pun\">=</span><span class=\"pln\"> </span><span class=\"typ\">ServiceLocator</span><span class=\"pun\">.</span><span class=\"typ\">Current</span><span class=\"pun\">.</span><span class=\"typ\">GetInstance</span><span class=\"pun\">&lt;</span><span class=\"typ\">IRegionManager</span><span class=\"pun\">&gt;();</span><span class=\"pln\"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class=\"kwd\">var</span><span class=\"pln\"> cnt1 </span><span class=\"pun\">=</span><span class=\"pln\"> rm1</span><span class=\"pun\">.</span><span class=\"typ\">Regions</span><span class=\"pun\">.</span><span class=\"typ\">Count</span><span class=\"pun\">();</span><span class=\"pln\"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class=\"kwd\">var</span><span class=\"pln\"> cnt2 </span><span class=\"pun\">=</span><span class=\"pln\"> rm2</span><span class=\"pun\">.</span><span class=\"typ\">Regions</span><span class=\"pun\">.</span><span class=\"typ\">Count</span><span class=\"pun\">();</span><span class=\"pln\"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class=\"kwd\">var</span><span class=\"pln\"> cnt3 </span><span class=\"pun\">=</span><span class=\"pln\"> rmgr</span><span class=\"pun\">.</span><span class=\"typ\">Regions</span><span class=\"pun\">.</span><span class=\"typ\">Count</span><span class=\"pun\">();</span><span class=\"pln\"><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class=\"com\">// cnt1, cnt2, cnt3 are all ZERO ????</span><span class=\"pln\"><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; T vw</span><span class=\"pun\">;</span><span class=\"pln\"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class=\"kwd\">if</span><span class=\"pln\"> </span><span class=\"pun\">(!</span><span class=\"pln\">rmgr</span><span class=\"pun\">.</span><span class=\"typ\">TryGetViewByType</span><span class=\"pun\">(</span><span class=\"kwd\">typeof</span><span class=\"pun\">(</span><span class=\"pln\">T</span><span class=\"pun\">),</span><span class=\"pln\"> </span><span class=\"kwd\">out</span><span class=\"pln\"> vw</span><span class=\"pun\">))</span><span class=\"pln\"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class=\"pun\">{</span><span class=\"pln\"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vw </span><span class=\"pun\">=</span><span class=\"pln\"> </span><span class=\"typ\">ServiceLocator</span><span class=\"pun\">.</span><span class=\"typ\">Current</span><span class=\"pun\">.</span><span class=\"typ\">GetInstance</span><span class=\"pun\">&lt;</span><span class=\"pln\">T</span><span class=\"pun\">&gt;();</span><span class=\"pln\"> </span><span class=\"com\">// this also fails with Activation error Key = ''</span><span class=\"pln\"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rmgr</span><span class=\"pun\">.</span><span class=\"typ\">AddToRegion</span><span class=\"pun\">(</span><span class=\"str\">\"MyMainRegion\"</span><span class=\"pun\">,</span><span class=\"pln\"> vw</span><span class=\"pun\">);</span><span class=\"pln\"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class=\"pun\">}</span><span class=\"pln\"><br /><br />&nbsp; &nbsp; </span><span class=\"pun\">}</span><span class=\"pln\"><br /><br /></span></code><span class=\"comment-copy\">the code above is called <em>after</em> the app  is up and running, and the views are displayed on the screen,   regionmanager is registered and available in the class, <br /><br />the real Q is  why the regions.count = ZERO even though i can see the views on the  screen ???<br /><br /><br /><br /></span></pre>",
    "PostedDate": "2012-03-28T11:54:19.397-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "816803",
    "ThreadId": "350214",
    "Html": "<p>Hi,</p>\r\n<p>I believe that this could be related to a known issue in Prism where, if a region is defined inside a <strong>DataTemplate</strong>, the region and all of its child regions will not be registered in the <strong>RegionManager</strong>. For example, if a shell has its \"<strong>MainRegion</strong>\" inside a <strong>DataTemplate</strong>, this region and any other region inside it will not be registered in the <strong>RegionManager</strong>. In this scenario the <strong>RegionManager </strong>would be empty while the  <strong>ViewExport </strong>and its <strong>AutoPopulateExportedViewsBehavior </strong>would work, as they don't require a <strong>RegionManager</strong>.</p>\r\n<p>You can find more information about this issue as well as several workarounds for it in the following work item:</p>\r\n<ul>\r\n<li><a href=\"http://compositewpf.codeplex.com/workitem/3612\">Region Registration Fails w/ Templated Controls</a></li>\r\n</ul>\r\n<p>Also, this could be related to another known issue where if the <strong>AutoPopulateExportedViewsBehavior</strong> or the <strong>AutoPopulateRegionBehavior </strong>is registered before the <strong>RegionManagerRegistrationBehavior</strong>, the regions are never registered in the <strong>RegionManager</strong>. In order to avoid this, you could invoke the base implementation of the <strong>ConfigureDefaultRegionBehaviors </strong>method before registered the <strong>AutoPopulateExportedViewsBehavior</strong> in your bootstrapper. You can find more information in the following work item:</p>\r\n<ul>\r\n<li><a href=\"http://compositewpf.codeplex.com/workitem/4349\">Default Region Behavior Order Problem</a></li>\r\n</ul>\r\n<p>If none of those are your scenario<strong></strong>, it would be helpful if you could provide us with a repro-sample application portraying this problem, so that we can help you further with this. You can upload your sample-application to <a href=\"https://www.google.com.ar/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;ved=0CDcQFjAA&amp;url=https%3A%2F%2Fskydrive.live.com%2F&amp;ei=MG5zT5WvAcji0QGZ5vD_Ag&amp;usg=AFQjCNEEgKCKuBIJPLRgjkmFTRMMwJgOGA&amp;sig2=2yEqlqVi5MXkU9X7Z9Np5w&amp;cad=rja\">SkyDrive </a>or any other file hosting service of your preference.</p>\r\n<p>I hope you find this useful,</p>\r\n<p>Damian Cherubini<br /> <a href=\"http://blogs.southworks.net/dcherubini\">http://blogs.southworks.net/dcherubini</a></p>",
    "PostedDate": "2012-03-28T13:41:06.85-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "817293",
    "ThreadId": "350214",
    "Html": "<p>Hi Damian</p>\r\n<p>&nbsp;</p>\r\n<p>Some more tests and it turns out to be related to the Adapters somehow and the way the regions are nested</p>\r\n<p>FYI - I'm using DevX controls</p>\r\n<p>The AppShell define a region called MainShellRegion</p>\r\n<p>There's a shell module which defines regions called MainRegion ( devx DocumentGroup control ), NavBarRegion( LayoutPanel control) and other modules which render into these views and are unaware of MainShellRegion</p>\r\n<p>The problem where IREgionManager.Regions.Count occurs with this setup</p>\r\n<p>&nbsp;</p>\r\n<p>Now if i change the AppShell to directly include MainRegion, NavBarRegion, RightRegion etc.</p>\r\n<p>then the code above works fine and IREgionManager.Regions.Count returns TWO as it should</p>\r\n<p>&nbsp;</p>\r\n<p>so it appears to be related to the DocumentGroupAdapter and/or LayoutPanelAdapter from here</p>\r\n<p>http://www.devexpress.com/Support/Center/e/E3339.aspx</p>\r\n<p>I hope this is a known issue else I'll create a repro app and post it on their support channel</p>\r\n<p>&nbsp;</p>\r\n<p>thanks</p>",
    "PostedDate": "2012-03-29T10:23:59.853-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]