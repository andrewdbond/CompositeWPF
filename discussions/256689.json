[
  {
    "Id": "608656",
    "ThreadId": "256689",
    "Html": "\r\n<p>Hi,</p>\r\n<p>I dynamically add &amp; remove a&nbsp;view to a region&nbsp;&quot;B&quot;&nbsp;when&nbsp;a main&nbsp;view in region &quot;A&quot; is navigated from&nbsp;(simplified example):</p>\r\n<pre style=\"font-family:Consolas; background:white; color:black; font-size:13px\">\t\t<span style=\"color:blue\">public</span>&nbsp;<span style=\"color:blue\">void</span>&nbsp;OnNavigatedTo(<span style=\"color:#2b91af\">NavigationContext</span>&nbsp;navigationContext)\r\n\t\t{\r\n\t\t\tRegionManager.Regions[<span style=\"color:#a31515\">&quot;B&quot;</span>].Add(View);\r\n\t\t}\r\n \r\n\t\t<span style=\"color:blue\">public</span>&nbsp;<span style=\"color:blue\">void</span>&nbsp;OnNavigatedFrom(<span style=\"color:#2b91af\">NavigationContext</span>&nbsp;navigationContext)\r\n\t\t{\r\n\t\t\tRegionManager.Regions[<span style=\"color:#a31515\">&quot;B&quot;</span>].Remove(View);\r\n\t\t}\r\n</pre>\r\n<p>The particularity is that the View implements <span style=\"color:#2b91af\">IRegionMemberLifetime<span style=\"color:#000000\"> and returns false for its KeepAlive property:</span></span></p>\r\n<div><span style=\"color:#2b91af\">\r\n<pre style=\"font-family:Consolas; background:white; color:black; font-size:13px\">\t\t<span style=\"color:blue\">public</span>&nbsp;<span style=\"color:blue\">bool</span>&nbsp;KeepAlive\r\n\t\t{\r\n\t\t\t<span style=\"color:blue\">get</span>&nbsp;{&nbsp;<span style=\"color:blue\">return</span>&nbsp;<span style=\"color:blue\">false</span>;&nbsp;}\r\n\t\t}\r\n</pre>\r\n</span><span style=\"color:#2b91af\">\r\n<div>&nbsp;</div>\r\n<div><span style=\"color:#000000\">When Remove is called, I get an ArgumentException. I debugged the Prism Library and what happens is that Prism tries to remove the view twice. Once when Remove is called from OnNavigatedFrom and one other time by&nbsp;Microsoft.Practices.Prism.Regions.Behaviors.<span style=\"color:#2b91af\">RegionMemberLifetimeBehavior</span>&nbsp;(culpright\r\n is the ShouldKeepAlive() call):</span></div>\r\n<div><span style=\"color:#2b91af\"></span>&nbsp;</div>\r\n<div><span style=\"color:#2b91af\"><span style=\"color:#2b91af\"><span style=\"color:#000000\">\r\n<pre style=\"font-family:Consolas; background:white; color:black; font-size:13px\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">private</span>&nbsp;<span style=\"color:blue\">void</span>&nbsp;OnActiveViewsChanged(<span style=\"color:blue\">object</span>&nbsp;sender,&nbsp;<span style=\"color:#2b91af\">NotifyCollectionChangedEventArgs</span>&nbsp;e)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green\">//&nbsp;We&nbsp;only&nbsp;pay&nbsp;attention&nbsp;to&nbsp;items&nbsp;removed&nbsp;from&nbsp;the&nbsp;ActiveViews&nbsp;list.</span>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green\">//&nbsp;Thus,&nbsp;we&nbsp;expect&nbsp;that&nbsp;any&nbsp;ICollectionView&nbsp;implementation&nbsp;would</span>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green\">//&nbsp;always&nbsp;raise&nbsp;a&nbsp;remove&nbsp;and&nbsp;we&nbsp;don't&nbsp;handle&nbsp;any&nbsp;resets</span>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green\">//&nbsp;unless&nbsp;we&nbsp;wanted&nbsp;to&nbsp;start&nbsp;tracking&nbsp;views&nbsp;that&nbsp;used&nbsp;to&nbsp;be&nbsp;active.</span>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">if</span>&nbsp;(e.Action&nbsp;!=&nbsp;<span style=\"color:#2b91af\">NotifyCollectionChangedAction</span>.Remove)&nbsp;<span style=\"color:blue\">return</span>;\r\n \r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">var</span>&nbsp;inactiveViews&nbsp;=&nbsp;e.OldItems;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">foreach</span>&nbsp;(<span style=\"color:blue\">var</span>&nbsp;inactiveView&nbsp;<span style=\"color:blue\">in</span>&nbsp;inactiveViews)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">if</span>&nbsp;(!ShouldKeepAlive(inactiveView))\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">this</span>.Region.Remove(inactiveView);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</pre>\r\n<pre style=\"font-family:Consolas; background:white; color:black; font-size:13px\">Is that behavior a bug? </pre>\r\n<pre style=\"font-family:Consolas; background:white; color:black; font-size:13px\">Thanks</pre>\r\n</span></span></span></div>\r\n</span></div>\r\n",
    "PostedDate": "2011-05-06T11:30:47.663-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "609742",
    "ThreadId": "256689",
    "Html": "<p>Hi,</p>\r\n<p>We&rsquo;ve reproduced the scenario that you&rsquo;ve mentioned and found an issue in the Prism Library. We&rsquo;ve created an issue in the Issue Tracker so the team can be notified about this behavior.</p>\r\n<p>One possible workaround to avoid this issue from affecting your scenario would be to call the <strong>Region.Deactivate method</strong> instead of the <strong>Region.Remove method</strong> to remove the view from your region; since you&rsquo;re setting <strong>KeepAlive</strong> to false, this should also remove the view from your region, but without causing this exception.</p>\r\n<p>We have created a <a href=\"http://compositewpf.codeplex.com/workitem/8224\">work item</a> in the Issue Tracker to notify the team about this behavior</p>\r\n<p>Thanks,</p>\r\n<p>Miguel Bronzovic<br /><a href=\"http://blogs.southworks.net/mbronzovic\">http://blogs.southworks.net/mbronzovic</a></p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2011-05-09T13:11:40.643-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]