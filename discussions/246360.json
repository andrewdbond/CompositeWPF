[
  {
    "Id": "567423",
    "ThreadId": "246360",
    "Html": "\r\n<p>I am developing a WPF shell application with VS2010 that implements the MVVM pattern. I&rsquo;m using the Prism 4.0 framework with the Unity 2.0 container. I cannot instantiate a class and set its properties during bootstrapper processing and resolve the\r\n class with the properties set during the instantiation of another class library implementing the Prism IModule interface. That is my goal. Am I on the right track with the process I describe below? If so am I missing a step? If I&rsquo;m on the wrong track\r\n is there a better way to make application wide values available to all modules?</p>\r\n<p>Authentication takes place in the application startup event where I store session information in a module reference type for later access. This occurs before the bootstrapper is run. I add a module class library I call &lsquo;Maintenance&rsquo; in the bootstrapper\r\n ConfigureModuleCatalog() overrides setting the InitializeMode to OnDemand. In the ConfigureContainer() overrides of the bootstrapper I instantiate a session class named &lsquo;SessionData&rsquo; that implements interface ISessionData, set its properties from\r\n the previously stored authentication information and register the instance as follows:</p>\r\n<pre><span style=\"color:blue\">Dim</span>&nbsp;SD&nbsp;<span style=\"color:blue\">As</span>&nbsp;<span style=\"color:blue\">New</span>&nbsp;<span style=\"color:#2b91af\">SessionData</span></pre>\r\n<pre><span style=\"color:blue\">With</span>&nbsp;SD</pre>\r\n<pre> &nbsp;&nbsp;&nbsp;.LocalSessionID&nbsp;=&nbsp;LocalSessionID<br>&nbsp;&nbsp;&nbsp;.LocalCNS&nbsp;=&nbsp;LocalCNS<br><span style=\"color:blue\">End</span>&nbsp;<span style=\"color:blue\">With</span><br><span style=\"color:blue\">Me</span>.Container.RegisterInstance(<span style=\"color:blue\">Of</span>&nbsp;<span style=\"color:#2b91af\">ISessionData</span>)(<span style=\"color:#a31515\">&quot;SessionData&quot;</span>,&nbsp;SD)</pre>\r\n<p>&nbsp;</p>\r\n<p>In the InitializeShell() override of the boostrapper I can resolve the instance with no problem using the following statement:</p>\r\n<pre><span style=\"color:blue\">Dim</span>&nbsp;aSD&nbsp;<span style=\"color:blue\">As</span>&nbsp;<span style=\"color:#2b91af\">ISessionData</span>&nbsp;=&nbsp;Container.Resolve(<span style=\"color:blue\">Of</span>&nbsp;<span style=\"color:#2b91af\">ISessionData</span>)(<span style=\"color:#a31515\">&quot;SessionData&quot;</span>)</pre>\r\n<p>&nbsp;</p>\r\n<p>When I launch the Maintenance module with button click processing and attempt to obtain a reference in the Maintenance module constructor with the same statement:</p>\r\n<pre><span style=\"color:blue\">Dim</span>&nbsp;sd&nbsp;<span style=\"color:blue\">As</span>&nbsp;<span style=\"color:#2b91af\">ISessionData</span>&nbsp;=&nbsp;<span style=\"color:blue\">Me</span>.container.Resolve(<span style=\"color:blue\">Of</span>&nbsp;<span style=\"color:#2b91af\">ISessionData</span>)(<span style=\"color:#a31515\">&quot;SessionData&quot;</span>)</pre>\r\n<p>&nbsp;</p>\r\n<p>it throws an error:</p>\r\n<p><em>The current type, ISessionData, is an interface and cannot be constructed. Are you missing a type mapping?</em></p>\r\n<p>I do not get an error with the following statement but the property values are not set:</p>\r\n<p><span style=\"color:blue; font-size:10pt\">Dim</span><span style=\"font-size:10pt\">&nbsp;sd&nbsp;<span style=\"color:blue\">As</span>&nbsp;<span style=\"color:#2b91af\">Object</span>&nbsp;=&nbsp;<span style=\"color:blue\">Me</span>.container.Resolve(<span style=\"color:blue\">Of</span>&nbsp;<span style=\"color:#2b91af\">SessionData</span>)(<span style=\"color:#a31515\">&quot;SessionData&quot;</span>)</span><span style=\"font-size:10pt\">&nbsp;</span></p>\r\n<p>In debug mode I can see that the container has the type registered.</p>\r\n<p>I&rsquo;ve also tried the RegisterInstance method in the bootstrapper using <span style=\"color:#2b91af\">\r\nSessionData</span><span style=\"color:#2b91af\"> </span>instead of <span style=\"color:#2b91af\">\r\nISessionData</span> with similar results.</p>\r\n",
    "PostedDate": "2011-02-16T13:41:46.76-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "568044",
    "ThreadId": "246360",
    "Html": "<p>Hi,</p>\r\n<p>The situation you're explaining could be caused by the fact that you could be using another instance of the Unity Container to retrieve the instance in your module. One possibility to debug this would be to check if the Hash Code of the instances of the Unity Container are the same in your bootstrapper and your module.</p>\r\n<p>In case you're not able to find out the cause of your issue, it would be helpful if you could provide us with a repro sample, so that we can help you further with this.</p>\r\n<p>Additionally, you might find some useful information in the <a href=\"http://unity.codeplex.com/discussions?ProjectName=unity\">Unity forum</a>.</p>\r\n<p>I hope you find this helpful.</p>\r\n<p>Guido Leandro Maliandi <br /> <a href=\"http://blogs.southworks.net/gmaliandi\">http://blogs.southworks.net/gmaliandi</a></p>",
    "PostedDate": "2011-02-17T10:59:28.73-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "568084",
    "ThreadId": "246360",
    "Html": "<p>Hello,</p>\r\n<p>Thanks for comment. Hash code is the same in both instances. I'll put together a sample for examination. Hopefully its something simple I'm missing.</p>\r\n<p>Chuck</p>",
    "PostedDate": "2011-02-17T11:44:50.74-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "568722",
    "ThreadId": "246360",
    "Html": "<p>I&rsquo;ve created a stripped down demo solution consisting of 2 projects, DemoModule and DemoShell which reproduces the problem I&rsquo;ve described above. Would appreciate any comments.</p>\r\n<p>The component I&rsquo;m having a problem resolving with properties set is SessionData which implements ISessionData and which are present in both projects:</p>\r\n<p><span style=\"color: blue; font-size: 10pt;\">Namespace</span><span style=\"font-size: 10pt;\">&nbsp;DemoProperty<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Public</span>&nbsp;<span style=\"color: blue;\">Class</span>&nbsp;<span style=\"color: #2b91af;\">SessionData</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Implements</span>&nbsp;<span style=\"color: #2b91af;\">ISessionData</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Private</span>&nbsp;<span style=\"color: blue;\">Shared</span>&nbsp;_LocalCNS&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: blue;\">String</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Private</span>&nbsp;<span style=\"color: blue;\">Shared</span>&nbsp;_LocalSessionID&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: blue;\">Integer</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Public</span>&nbsp;<span style=\"color: blue;\">Shared</span>&nbsp;LCNS&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: blue;\">String</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Public</span>&nbsp;<span style=\"color: blue;\">Shared</span>&nbsp;LSID&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: blue;\">Integer</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Public</span>&nbsp;<span style=\"color: blue;\">Property</span>&nbsp;LocalCNS&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: blue;\">String</span>&nbsp;<span style=\"color: blue;\">Implements</span>&nbsp;<span style=\"color: #2b91af;\">ISessionData</span>.LocalCNS<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Get</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Return</span>&nbsp;_LocalCNS<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Get</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Set</span>(value&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: blue;\">String</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_LocalCNS&nbsp;=&nbsp;value<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCNS&nbsp;=&nbsp;value<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Set</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Property</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Public</span>&nbsp;<span style=\"color: blue;\">Property</span>&nbsp;LocalSessionID&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: blue;\">Integer</span>&nbsp;<span style=\"color: blue;\">Implements</span>&nbsp;<span style=\"color: #2b91af;\">ISessionData</span>.LocalSessionID<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Get</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Return</span>&nbsp;_LocalSessionID<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Get</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Set</span>(value&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: blue;\">Integer</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_LocalSessionID&nbsp;=&nbsp;value<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LSID&nbsp;=&nbsp;value<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Set</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Property</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Class</span><br /><br /><span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Namespace</span></span></p>\r\n<p>&nbsp;</p>\r\n<pre><span style=\"color: blue;\">Namespace</span>&nbsp;DemoProperty<br /> &nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Public</span>&nbsp;<span style=\"color: blue;\">Interface</span>&nbsp;<span style=\"color: #2b91af;\">ISessionData</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Property</span>&nbsp;LocalCNS&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: blue;\">String</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Property</span>&nbsp;LocalSessionID&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: blue;\">Integer</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Interface</span><br /><br /><span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Namespace</span></pre>\r\n<p>&nbsp;</p>\r\n<p>The DemoModule project has a simple MaintenanceShell.xaml window. I had hoped to obtain a reference to the session information parameters with the following ModuleMaintenance class IModule implementation:</p>\r\n<pre><span style=\"color: blue;\">Imports</span>&nbsp;Microsoft.Practices.Prism.Modularity<br /><span style=\"color: blue;\">Imports</span>&nbsp;Microsoft.Practices.Unity<br /><span style=\"color: blue;\">Imports</span>&nbsp;System.Windows<br /> <span style=\"color: blue;\">Namespace</span>&nbsp;DemoProperty<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Public</span>&nbsp;<span style=\"color: blue;\">Class</span>&nbsp;<span style=\"color: #2b91af;\">ModuleMaintenance</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Implements</span>&nbsp;<span style=\"color: #2b91af;\">IModule</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Private</span>&nbsp;<span style=\"color: blue;\">ReadOnly</span>&nbsp;container&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: #2b91af;\">IUnityContainer</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Private</span>&nbsp;MaintenanceScreen&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: #2b91af;\">Window</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Public</span>&nbsp;<span style=\"color: blue;\">Sub</span>&nbsp;<span style=\"color: blue;\">New</span>(<span style=\"color: blue;\">ByVal</span>&nbsp;container&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: #2b91af;\">IUnityContainer</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Me</span>.container&nbsp;=&nbsp;container<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Dim</span>&nbsp;i&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: blue;\">Integer</span>&nbsp;=&nbsp;<span style=\"color: blue;\">Me</span>.container.GetHashCode()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #2b91af;\">MessageBox</span>.Show(<span style=\"color: #a31515;\">\"Module&nbsp;Container&nbsp;Hash&nbsp;Code:&nbsp;\"</span>&nbsp;&amp;&nbsp;<span style=\"color: blue;\">CStr</span>(i))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Dim</span>&nbsp;sd&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: #2b91af;\">ISessionData</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Try</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sd&nbsp;=&nbsp;<span style=\"color: blue;\">Me</span>.container.Resolve(<span style=\"color: blue;\">Of</span>&nbsp;<span style=\"color: #2b91af;\">ISessionData</span>)(<span style=\"color: #a31515;\">\"SessionData\"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Catch</span>&nbsp;ex&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: #2b91af;\">Exception</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #2b91af;\">MessageBox</span>.Show(ex.ToString)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Try</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Me</span>.MaintenanceScreen&nbsp;=&nbsp;<span style=\"color: blue;\">New</span>&nbsp;<span style=\"color: #2b91af;\">MaintenanceShell</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Me</span>.MaintenanceScreen.Show()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Sub</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Public</span>&nbsp;<span style=\"color: blue;\">Sub</span>&nbsp;Initialize()&nbsp;<span style=\"color: blue;\">Implements</span>&nbsp;<span style=\"color: #2b91af;\">IModule</span>.Initialize<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Sub</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Class</span><br /><br /><span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Namespace</span></pre>\r\n<p>&nbsp;The &lsquo;try&rsquo; throws an error. If I change the resolve to &lsquo;Of SessionData&rsquo; it does not throw an error but the the properties do not come across.</p>\r\n<p>The DemoShell project launches with the following Application.xaml code behind where authentication information is stored in the ConnectionData module:</p>\r\n<pre><span style=\"color: blue;\">Namespace</span>&nbsp;DemoProperty<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Partial</span>&nbsp;<span style=\"color: blue;\">Public</span>&nbsp;<span style=\"color: blue;\">Class</span>&nbsp;<span style=\"color: #2b91af;\">App</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Inherits</span>&nbsp;System.Windows.<span style=\"color: #2b91af;\">Application</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: green;\">'&nbsp;Application-level&nbsp;events,&nbsp;such&nbsp;as&nbsp;Startup,&nbsp;Exit,&nbsp;and&nbsp;DispatcherUnhandledException</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: green;\">'&nbsp;can&nbsp;be&nbsp;handled&nbsp;in&nbsp;this&nbsp;file.</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Protected</span>&nbsp;<span style=\"color: blue;\">Overrides</span>&nbsp;<span style=\"color: blue;\">Sub</span>&nbsp;OnStartup(<span style=\"color: blue;\">ByVal</span>&nbsp;e&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: #2b91af;\">StartupEventArgs</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">MyBase</span>.OnStartup(e)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: green;\">'PROCESS&nbsp;AUTHENTICATION</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #2b91af;\">ConnectionData</span>.LocalSessionID&nbsp;=&nbsp;1000<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #2b91af;\">ConnectionData</span>.LocalCNS&nbsp;=&nbsp;<span style=\"color: #a31515;\">\"DBConnectionString\"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Dim</span>&nbsp;TCB&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: blue;\">New</span>&nbsp;<span style=\"color: #2b91af;\">TxCoreBootstrapper</span>()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TCB.Run()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Sub</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Protected</span>&nbsp;<span style=\"color: blue;\">Overrides</span>&nbsp;<span style=\"color: blue;\">Sub</span>&nbsp;OnExit(<span style=\"color: blue;\">ByVal</span>&nbsp;e&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: #2b91af;\">ExitEventArgs</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">MyBase</span>.OnExit(e)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Sub</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Class</span><br /><br /><span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Namespace</span></pre>\r\n<p>&nbsp;<span style=\"color: blue;\">Namespace</span>&nbsp;DemoProperty<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Module</span>&nbsp;<span style=\"color: #2b91af;\">ConnectionData</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Public</span>&nbsp;SessionID&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: blue;\">String</span>&nbsp;=&nbsp;<span style=\"color: #a31515;\">\"\"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Public</span>&nbsp;LocalSessionID&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: blue;\">Integer</span>&nbsp;=&nbsp;0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Public</span>&nbsp;LocalCNS&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: blue;\">String</span>&nbsp;=&nbsp;<span style=\"color: #a31515;\">\"\"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Public</span>&nbsp;SessionInit&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: blue;\">Boolean</span>&nbsp;=&nbsp;<span style=\"color: blue;\">False</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Module</span><br /><br /><span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Namespace</span></p>\r\n<p>&nbsp;</p>\r\n<p>The bootstrapper configures the module catalog and container and initializes the shell as follows:</p>\r\n<pre><span style=\"color: blue;\">Imports</span>&nbsp;Microsoft.Practices.Prism.Modularity<br /><span style=\"color: blue;\">Imports</span>&nbsp;Microsoft.Practices.Prism.UnityExtensions<br /><span style=\"color: blue;\">Imports</span>&nbsp;Microsoft.Practices.ServiceLocation<br /><span style=\"color: blue;\">Imports</span>&nbsp;Microsoft.Practices.Unity<br /><span style=\"color: blue;\">Imports</span>&nbsp;System.Windows<br /> <span style=\"color: blue;\">Namespace</span>&nbsp;DemoProperty<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Public</span>&nbsp;<span style=\"color: blue;\">Class</span>&nbsp;<span style=\"color: #2b91af;\">TxCoreBootstrapper</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Inherits</span>&nbsp;<span style=\"color: #2b91af;\">UnityBootstrapper</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Protected</span>&nbsp;<span style=\"color: blue;\">Overrides</span>&nbsp;<span style=\"color: blue;\">Function</span>&nbsp;CreateShell()&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: #2b91af;\">DependencyObject</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Return</span>&nbsp;<span style=\"color: #2b91af;\">ServiceLocator</span>.Current.GetInstance(<span style=\"color: blue;\">Of</span>&nbsp;DemoProperty.<span style=\"color: #2b91af;\">Shell</span>)()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Function</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Protected</span>&nbsp;<span style=\"color: blue;\">Overrides</span>&nbsp;<span style=\"color: blue;\">Sub</span>&nbsp;InitializeShell()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">MyBase</span>.InitializeShell()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #2b91af;\">App</span>.Current.MainWindow&nbsp;=&nbsp;<span style=\"color: blue;\">CType</span>(<span style=\"color: blue;\">Me</span>.Shell,&nbsp;<span style=\"color: #2b91af;\">Window</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #2b91af;\">App</span>.Current.MainWindow.Show()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Sub</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Protected</span>&nbsp;<span style=\"color: blue;\">Overrides</span>&nbsp;<span style=\"color: blue;\">Sub</span>&nbsp;ConfigureContainer()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">MyBase</span>.ConfigureContainer()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Dim</span>&nbsp;SD&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: blue;\">New</span>&nbsp;<span style=\"color: #2b91af;\">SessionData</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SD.LocalSessionID&nbsp;=&nbsp;LocalSessionID<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SD.LocalCNS&nbsp;=&nbsp;LocalCNS<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Me</span>.Container.RegisterInstance(<span style=\"color: blue;\">Of</span>&nbsp;<span style=\"color: #2b91af;\">ISessionData</span>)(<span style=\"color: #a31515;\">\"SessionData\"</span>,&nbsp;SD)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Dim</span>&nbsp;i&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: blue;\">Integer</span>&nbsp;=&nbsp;<span style=\"color: blue;\">Me</span>.Container.GetHashCode()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #2b91af;\">MessageBox</span>.Show(<span style=\"color: #a31515;\">\"Bootstrapper&nbsp;Container&nbsp;Hash&nbsp;Code:&nbsp;\"</span>&nbsp;&amp;&nbsp;<span style=\"color: blue;\">CStr</span>(i))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Sub</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Protected</span>&nbsp;<span style=\"color: blue;\">Overrides</span>&nbsp;<span style=\"color: blue;\">Sub</span>&nbsp;ConfigureModuleCatalog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Dim</span>&nbsp;moduleMaintenanceType&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: #2b91af;\">Type</span>&nbsp;=&nbsp;<span style=\"color: blue;\">GetType</span>(<span style=\"color: #2b91af;\">ModuleMaintenance</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ModuleCatalog.AddModule(<span style=\"color: blue;\">New</span>&nbsp;<span style=\"color: #2b91af;\">ModuleInfo</span>()&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">With</span>&nbsp;{.ModuleName&nbsp;=&nbsp;moduleMaintenanceType.Name,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ModuleType&nbsp;=&nbsp;moduleMaintenanceType.AssemblyQualifiedName,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.InitializationMode&nbsp;=&nbsp;<span style=\"color: #2b91af;\">InitializationMode</span>.OnDemand})<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Sub</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Class</span><br /><br /><span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Namespace</span></pre>\r\n<p>&nbsp;The Shell.xaml window has 1 button and saves the IModuleManager implementation and sets the data context to the ShellViewModel with the following code behind:</p>\r\n<pre><span style=\"color: blue;\">Imports</span>&nbsp;Microsoft.Practices.Prism.Modularity<br /> <span style=\"color: blue;\">Namespace</span>&nbsp;DemoProperty<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Public</span>&nbsp;<span style=\"color: blue;\">Class</span>&nbsp;<span style=\"color: #2b91af;\">Shell</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Inherits</span>&nbsp;<span style=\"color: #2b91af;\">Window</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Private</span>&nbsp;moduleManager&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: #2b91af;\">IModuleManager</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Public</span>&nbsp;<span style=\"color: blue;\">Sub</span>&nbsp;<span style=\"color: blue;\">New</span>(<span style=\"color: blue;\">ByVal</span>&nbsp;ViewModel&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: #2b91af;\">ShellViewModel</span>,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">ByVal</span>&nbsp;moduleManager&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: #2b91af;\">IModuleManager</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">If</span>&nbsp;moduleManager&nbsp;<span style=\"color: blue;\">Is</span>&nbsp;<span style=\"color: blue;\">Nothing</span>&nbsp;<span style=\"color: blue;\">Then</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Throw</span>&nbsp;<span style=\"color: blue;\">New</span>&nbsp;<span style=\"color: #2b91af;\">ArgumentNullException</span>(<span style=\"color: #a31515;\">\"moduleManager\"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">If</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Me</span>.moduleManager&nbsp;=&nbsp;moduleManager<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ShellModuleMgr&nbsp;=&nbsp;moduleManager<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InitializeComponent()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Me</span>.DataContext&nbsp;=&nbsp;ViewModel<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Sub</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Public</span>&nbsp;<span style=\"color: blue;\">Sub</span>&nbsp;Window_Loaded(<span style=\"color: blue;\">ByVal</span>&nbsp;sender&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: blue;\">Object</span>,&nbsp;<span style=\"color: blue;\">ByVal</span>&nbsp;e&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: #2b91af;\">RoutedEventArgs</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Sub</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Class</span><br /><br /><span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Namespace</span></pre>\r\n<p>&nbsp;</p>\r\n<pre><span style=\"color: blue;\">Namespace</span>&nbsp;DemoProperty<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Module</span>&nbsp;<span style=\"color: #2b91af;\">ShellModuleManager</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Public</span>&nbsp;ShellModuleMgr&nbsp;<span style=\"color: blue;\">As</span>&nbsp;Microsoft.Practices.Prism.Modularity.<span style=\"color: #2b91af;\">IModuleManager</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Module</span><br /><br /><span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Namespace</span></pre>\r\n<p>&nbsp;<span style=\"color: blue;\">Imports</span>&nbsp;System.ComponentModel<br /><span style=\"color: blue;\">Imports</span>&nbsp;Microsoft.Practices.Prism.Commands<br /><br /><br /><span style=\"color: blue;\">Namespace</span>&nbsp;DemoProperty<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Public</span>&nbsp;<span style=\"color: blue;\">Class</span>&nbsp;<span style=\"color: #2b91af;\">ShellViewModel</span>&nbsp;:&nbsp;<span style=\"color: blue;\">Inherits</span>&nbsp;<span style=\"color: #2b91af;\">FrameworkElement</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Implements</span>&nbsp;<span style=\"color: #2b91af;\">INotifyPropertyChanged</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Public</span>&nbsp;<span style=\"color: blue;\">Sub</span>&nbsp;<span style=\"color: blue;\">New</span>()<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Me</span>.btnMaintenanceClickCmd&nbsp;=&nbsp;<span style=\"color: blue;\">New</span>&nbsp;<span style=\"color: #2b91af;\">DelegateCommand</span>(<span style=\"color: blue;\">Of</span>&nbsp;<span style=\"color: blue;\">Object</span>)&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span style=\"color: blue;\">AddressOf</span>&nbsp;<span style=\"color: blue;\">Me</span>.btnMaintenanceClickProcess,&nbsp;<span style=\"color: blue;\">AddressOf</span>&nbsp;<span style=\"color: blue;\">Me</span>.CanBtnMaintenanceClick)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Sub</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Public</span>&nbsp;<span style=\"color: blue;\">Event</span>&nbsp;btnMaintenanceClick&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: #2b91af;\">EventHandler</span>(<span style=\"color: blue;\">Of</span>&nbsp;Microsoft.Practices.Prism.Events.<span style=\"color: #2b91af;\">DataEventArgs</span>(<span style=\"color: blue;\">Of</span>&nbsp;<span style=\"color: #2b91af;\">ShellViewModel</span>))<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Private</span>&nbsp;_btnMaintenanceClickCmd&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: #2b91af;\">DelegateCommand</span>(<span style=\"color: blue;\">Of</span>&nbsp;<span style=\"color: blue;\">Object</span>)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Public</span>&nbsp;<span style=\"color: blue;\">Property</span>&nbsp;btnMaintenanceClickCmd()&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: #2b91af;\">DelegateCommand</span>(<span style=\"color: blue;\">Of</span>&nbsp;<span style=\"color: blue;\">Object</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Get</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Return</span>&nbsp;_btnMaintenanceClickCmd<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Get</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Private</span>&nbsp;<span style=\"color: blue;\">Set</span>(<span style=\"color: blue;\">ByVal</span>&nbsp;value&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: #2b91af;\">DelegateCommand</span>(<span style=\"color: blue;\">Of</span>&nbsp;<span style=\"color: blue;\">Object</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_btnMaintenanceClickCmd&nbsp;=&nbsp;value<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Set</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Property</span><br /><br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Private</span>&nbsp;<span style=\"color: blue;\">Function</span>&nbsp;CanBtnMaintenanceClick(<span style=\"color: blue;\">ByVal</span>&nbsp;arg&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: blue;\">Object</span>)&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: blue;\">Boolean</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Return</span>&nbsp;<span style=\"color: blue;\">True</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Function</span><br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Private</span>&nbsp;<span style=\"color: blue;\">Sub</span>&nbsp;btnMaintenanceClickProcess(<span style=\"color: blue;\">ByVal</span>&nbsp;obj&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: blue;\">Object</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ShellModuleMgr.LoadModule(<span style=\"color: #a31515;\">\"ModuleMaintenance\"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Sub</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Public</span>&nbsp;<span style=\"color: blue;\">Event</span>&nbsp;PropertyChanged&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: #2b91af;\">PropertyChangedEventHandler</span>&nbsp;<span style=\"color: blue;\">Implements</span>&nbsp;<span style=\"color: #2b91af;\">INotifyPropertyChanged</span>.PropertyChanged<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">Private</span>&nbsp;<span style=\"color: blue;\">Sub</span>&nbsp;NotifyPropertyChanged(<span style=\"color: blue;\">ByVal</span>&nbsp;propertyName&nbsp;<span style=\"color: blue;\">As</span>&nbsp;<span style=\"color: blue;\">String</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">If</span>&nbsp;<span style=\"color: blue;\">Me</span>.PropertyChangedEvent&nbsp;<span style=\"color: blue;\">IsNot</span>&nbsp;<span style=\"color: blue;\">Nothing</span>&nbsp;<span style=\"color: blue;\">Then</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">RaiseEvent</span>&nbsp;PropertyChanged(<span style=\"color: blue;\">Me</span>,&nbsp;<span style=\"color: blue;\">New</span>&nbsp;<span style=\"color: #2b91af;\">PropertyChangedEventArgs</span>(propertyName))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">If</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Sub</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Class</span><br /><br /><span style=\"color: blue;\">End</span>&nbsp;<span style=\"color: blue;\">Namespace</span></p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2011-02-18T12:10:48.28-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "573362",
    "ThreadId": "246360",
    "Html": "<p>Hi,</p>\r\n<p>It could be helpful if you could upload your working sample to <a href=\"http://skydrive.live.com/\">SkyDrive</a> or a similar site, so as to make sure that there are no differences in the elements in your sample and the solution we would debug.</p>\r\n<p>Guido Leandro Maliandi<br /> <a href=\"http://blogs.southworks.net/gmaliandi\">http://blogs.southworks.net/gmaliandi</a></p>",
    "PostedDate": "2011-02-28T10:02:12.657-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "573434",
    "ThreadId": "246360",
    "Html": "<p>I've put the sample in a '.zip' on SkyDrive. File name DemoPropertyPass.zip. Profile name 'chuck mattison'.</p>\r\n<p>I've tried the following registerinstance syntax and can 'see' the set variables in container debug but still cannot resolve in the module.</p>\r\n<p><span style=\"font-family: Consolas; color: #008000; font-size: x-small;\"><span style=\"font-family: Consolas; color: #008000; font-size: x-small;\"><span style=\"font-family: Consolas; color: #008000; font-size: x-small;\">\r\n<p><span style=\"font-family: Consolas; font-size: x-small;\"><span style=\"font-family: Consolas; font-size: x-small;\">Me.Container.RegisterInstance(</span></span><span style=\"font-family: Consolas; color: #0000ff; font-size: x-small;\"><span style=\"font-family: Consolas; color: #0000ff; font-size: x-small;\"><span style=\"font-family: Consolas; color: #0000ff; font-size: x-small;\">Of</span></span></span><span style=\"font-family: Consolas; font-size: x-small;\"><span style=\"font-family: Consolas; font-size: x-small;\"> </span></span><span style=\"font-family: Consolas; color: #2b91af; font-size: x-small;\"><span style=\"font-family: Consolas; color: #2b91af; font-size: x-small;\"><span style=\"font-family: Consolas; color: #2b91af; font-size: x-small;\">ISessionData</span></span></span><span style=\"font-family: Consolas; font-size: x-small;\"><span style=\"font-family: Consolas; font-size: x-small;\">)(</span></span><span style=\"font-family: Consolas; color: #a31515; font-size: x-small;\"><span style=\"font-family: Consolas; color: #a31515; font-size: x-small;\"><span style=\"font-family: Consolas; color: #a31515; font-size: x-small;\">\"SessionData\"</span></span></span><span style=\"font-family: Consolas; font-size: x-small;\"><span style=\"font-family: Consolas; font-size: x-small;\">, SD, </span></span><span style=\"font-family: Consolas; color: #0000ff; font-size: x-small;\"><span style=\"font-family: Consolas; color: #0000ff; font-size: x-small;\"><span style=\"font-family: Consolas; color: #0000ff; font-size: x-small;\">New</span></span></span><span style=\"font-family: Consolas; font-size: x-small;\"><span style=\"font-family: Consolas; font-size: x-small;\"> </span></span><span style=\"font-family: Consolas; color: #2b91af; font-size: x-small;\"><span style=\"font-family: Consolas; color: #2b91af; font-size: x-small;\"><span style=\"font-family: Consolas; color: #2b91af; font-size: x-small;\">ContainerControlledLifetimeManager</span></span></span><span style=\"font-family: Consolas; font-size: x-small;\"> <span style=\"font-family: Consolas; font-size: x-small;\">())</span></span></p>\r\n<p><span style=\"font-family: Consolas; color: #000000; font-size: x-small;\"><span style=\"font-family: Consolas; font-size: x-small;\"><span style=\"font-family: Consolas; font-size: x-small;\"><span style=\"font-family: Consolas; font-size: x-small;\"><span style=\"font-family: Consolas; font-size: x-small;\">&nbsp;</span></span></span></span></span></p>\r\n</span></span></span></p>",
    "PostedDate": "2011-02-28T11:54:15.503-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "573453",
    "ThreadId": "246360",
    "Html": "<p>Hi,</p>\r\n<p>Could you provide us with the link in order to download your repro sample?</p>\r\n<p>You can do this by positioning in the container folder where you upload the the zip file and clicking <em>Get A Link</em> in <strong>Share Menu</strong>.</p>\r\n<p>Thanks,</p>\r\n<p>Miguel Bronzovic<br /><a href=\"http://blogs.southworks.net/mbronzovic\">http://blogs.southworks.net/mbronzovic</a></p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2011-02-28T12:24:48.63-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "573463",
    "ThreadId": "246360",
    "Html": "<p>Thanks for the reply. Here is the link:</p>\r\n<p><a href=\"http://cid-369b7180ddc2e167.skydrive.live.com/redir.aspx?resid=369B7180DDC2E167!118\">http://cid-369b7180ddc2e167.skydrive.live.com/redir.aspx?resid=369B7180DDC2E167!118</a></p>",
    "PostedDate": "2011-02-28T12:32:22.963-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "573988",
    "ThreadId": "246360",
    "Html": "<p>Hi Chuck,</p>\r\n<p>We've examined the sample you've uploaded and found that the issue with the Unity container you're experiencing is caused by the fact that you've two copies of <strong>ISessionData </strong>and <strong>SessionData</strong>, one in the <strong>DemoShell </strong>and one in the <strong>DemoModule </strong>projects.</p>\r\n<p>When you register an instance or a type mapping in the bootstrapper, you're using the ones in the <strong>DemoShell </strong>project, but when you attempt to resolve it in the <strong>ModuleMaintenance </strong>constructor, you're trying to resolve the ones in the <strong>DemoModule</strong> project, hence the Unity container doesn't have them registered.</p>\r\n<p>Since Unity can resolve a concrete type that hasn't been registered, if you try to resolve an instance of type <strong>SessionData</strong>, it will return an new instance of <strong>SessionData </strong>(from <strong>DemoModule</strong>). However, when you try to resolve an instance of type <strong>ISessionData</strong>, it throws an error since it doesn't find a type mapping for the <strong>ISessionData </strong>in <strong>DemoModule</strong>.</p>\r\n<p>One possible way to achieve your desired scenario would be to place the <strong>ISessionData </strong>interface in an infrastructure project, and make both your shell project and your modules reference it. Then, you would be registering an instance or a type mapping pointing to the type in the infrastructure project, and also pointing to that type when resolving it from your modules.</p>\r\n<p>I hope you find this helpful.</p>\r\n<p>Guido Leandro Maliandi<br /> <a href=\"http://blogs.southworks.net/gmaliandi\">http://blogs.southworks.net/gmaliandi</a></p>",
    "PostedDate": "2011-03-01T10:49:48.413-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "574082",
    "ThreadId": "246360",
    "Html": "<p>Guido,<br />That did the trick. Moved ISessionData and its implementor SessionData to an infrastructure project.&nbsp; Thanks for the suggestion. I was dead-ended.<br />Chuck</p>",
    "PostedDate": "2011-03-01T13:44:20.587-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]