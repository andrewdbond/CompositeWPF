[
  {
    "Id": "728586",
    "ThreadId": "286913",
    "Html": "\r\n<p>Hi</p>\r\n<p>I have two modules in my App (Admin and Finance). Both modules are loaded on demand.</p>\r\n<p>The finance module load depends on admin module. Hence when Finance module gets loaded the admin module should also be loaded.</p>\r\n<p>I have specified this dependency in modulecatalog.xaml file. Now when i try to load the Finance module I am getting Service Activation Exception Error</p>\r\n<p>({Microsoft.Practices.ServiceLocation.ActivationException: Activation error occured while trying to get instance of type Object, key &quot;QSys.Finance.Views.FinanceHomeView&quot;&nbsp; &nbsp;at Microsoft.Practices.Prism.MefExtensions.MefServiceLocatorAdapter.DoGetInstance(Type\r\n serviceType, String key)&nbsp; &nbsp;at Microsoft.Practices.ServiceLocation.ServiceLocatorImplBase.GetInstance(Type serviceType, String key)})</p>\r\n<p>but if i remove the dependency of the module. Everything works fine. Below is the xaml markup for module catalog\r\n</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Modularity</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">ModuleCatalog</span> <span style=\"color:red\">xmlns</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.microsoft.com/winfx/2006/xaml/presentation</span><span style=\"color:black\">&quot;</span> \r\n                          <span style=\"color:red\">xmlns:x</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.microsoft.com/winfx/2006/xaml</span><span style=\"color:black\">&quot;</span> \r\n                          <span style=\"color:red\">xmlns:sys</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">clr-namespace:System;assembly=mscorlib</span><span style=\"color:black\">&quot;</span> \r\n                          <span style=\"color:red\">xmlns:Modularity</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">clr-namespace:Microsoft.Practices.Prism.Modularity;assembly=Microsoft.Practices.Prism</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Modularity</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">ModuleInfo</span> \r\n            <span style=\"color:red\">Ref</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">QSys.Admin.xap</span><span style=\"color:black\">&quot;</span>\r\n            <span style=\"color:red\">InitializationMode</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">OnDemand</span><span style=\"color:black\">&quot;</span>\r\n            <span style=\"color:red\">ModuleName</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">QSysAdminModule</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Modularity</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">ModuleInfo</span>\r\n        <span style=\"color:red\">Ref</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">QSys.Finance.xap</span><span style=\"color:black\">&quot;</span>\r\n        <span style=\"color:red\">InitializationMode</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">OnDemand</span><span style=\"color:black\">&quot;</span>\r\n        <span style=\"color:red\">ModuleName</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">QSysFinanceModule</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n        <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Modularity</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">ModuleInfo.DependsOn</span><span style=\"color:blue\">&gt;</span>\r\n            <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">sys</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">String</span><span style=\"color:blue\">&gt;</span>QSysAdminModule<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">sys</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">String</span><span style=\"color:blue\">&gt;</span>\r\n        <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">Modularity</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">ModuleInfo.DependsOn</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">Modularity</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">ModuleInfo</span><span style=\"color:blue\">&gt;</span>\r\n\r\n\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">Modularity</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">ModuleCatalog</span><span style=\"color:blue\">&gt;</span>\r\n\r\n</pre>\r\n<pre><br></pre>\r\n<pre>Please help</pre>\r\n<pre>Thanks</pre>\r\n<pre><br></pre>\r\n</div>\r\n<p></p>\r\n",
    "PostedDate": "2012-01-21T02:55:01.687-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "729382",
    "ThreadId": "286913",
    "Html": "<p>Hi,</p>\r\n<p>So far, we couldn&rsquo;t find anything wrong within the code snippets that you posted, it would be helpful if you could provide us with a repro sample application, so that we can help you further with this.</p>\r\n<p>Thanks,</p>\r\n<p>Agustin Adami<a href=\"http://blogs.southworks.net/aadami\"><br /> http://blogs.southworks.net/aadami</a>ï»¿</p>",
    "PostedDate": "2012-01-23T09:10:06.57-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "729740",
    "ThreadId": "286913",
    "Html": "<p>Hi Agustin</p>\r\n<p>Thanks for your reply</p>\r\n<p>You can download the sample from https://skydrive.live.com/embed?cid=E84CFB62692563C4&amp;resid=E84CFB62692563C4!305&amp;authkey=AHVTD7Hgf1P9mT4</p>\r\n<p>&nbsp;</p>\r\n<p>Please note the example has dependency of database.</p>\r\n<p>You need to create an empty database called QSys and then run the script file called script.sql (This is also there in zip file).</p>\r\n<p>Please change the connectionstrings in web.config file</p>\r\n<p>Login with afzal/afzal@1 credentials.</p>\r\n<p>To stimulate the error follow these steps</p>\r\n<p>1) Click on the admin module, it will load</p>\r\n<p>2) Now click on the Finance module and you would get an error.</p>\r\n<p>&nbsp;</p>\r\n<p>I assume it has some dependency injection problems for the IAdminService. I tried to figure it but could not find the viable solution to it.</p>\r\n<p>&nbsp;</p>\r\n<p>Thanks again for your help.</p>\r\n<p>&nbsp;</p>\r\n<p>Regards</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2012-01-23T23:40:32.94-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "730642",
    "ThreadId": "286913",
    "Html": "<p>Hi,</p>\n<p>We have download your application and we could reproduce the issue you are mentioning. After reviewing the application for a while, we found that this problem stopped appearing after applying the following configurations:</p>\n<ul>\n<li>In the project <strong>QSys.App</strong> set the references to <strong>Microsoft.Practices.Prism.MefExtensions</strong> and <strong>QSys.Library</strong> to <strong>Copy Local = True</strong>. </li>\n<li>In the project <strong>QSys.Finance</strong> set the references to <strong>Microsoft.Practices.Prism.MefExtensions</strong>, <strong>QSys.Library</strong> and <strong>QSys.Services</strong> to <strong>Copy Local = False</strong>. </li>\n<li>In the project <strong>QSys.Admin</strong> set the references to <strong>Microsoft.Practices.Prism.MefExtensions</strong> and <strong>QSys.Library</strong> to <strong>Copy Local = False</strong>, and the reference to <strong>QSys.Services</strong> to <strong>Copy Local = True</strong>. </li>\n<li>In the project <strong>QSys.Library</strong> set the references to <strong>Microsoft.Practices.Prism.MefExtensions</strong> to <strong>Copy Local = False</strong>. </li>\n</ul>\n<p>Also, just in case, you might need to clean the solution and rebuild it after applying these modifications.</p>\n<p>I believe that this problem might be related to a class being exported in the container more than one time: based on my understanding, when using MEF, if you have a project that exports types into the container, this project should be referenced with <strong>Copy Local = True</strong> in only one project, and with <strong>Copy Local = False</strong> in the rest. This is the case, for exampling, when using the <strong>Microsoft.Practices.Prism.MefExtensions</strong>.</p>\n<p>It seems that, as the <strong>QSys.Services</strong> project was referenced with <strong>Copy Local = True</strong> in more than one project the <strong>IAdminService</strong> was exported more than once. As you can see in the configuration mentioned above, we tried to avoid this by making each library to be referenced with the <strong>Copy Local</strong> property set to <strong>True </strong>only once.</p>\n<p>Also, after applying these configurations, we could reproduce the first issue you mentioned (the one regarding the <strong>FinanceHomeView</strong>). Based on my understanding this could be related to a know issue with MEF where if, for example, a Module A has a dependency to a Module B and both use a library, if the Module A has this library in <strong>Copy Local = False</strong> and the Module B has it in <strong>Copy Local = True</strong> an error appears because the library will not be available when the Module A requires it. You can find more information about this issue in the following work item:</p>\n<ul>\n<li><a href=\"http://compositewpf.codeplex.com/workitem/7224\">Mef and Module Dependencies in Silverlight</a></li>\n</ul>\n<p>As a possible work around for this, you could move the reference to the <strong>QSys.Services</strong> project to another location, for example the <strong>QSys.Library</strong> or the <strong>QSys.App</strong> project.</p>\n<p>I hope you find this useful,</p>\n<p>Damian Cherubini<br /> <a href=\"http://blogs.southworks.net/dcherubini\">http://blogs.southworks.net/dcherubini</a></p>",
    "PostedDate": "2012-01-25T10:39:34.097-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "730921",
    "ThreadId": "286913",
    "Html": "<p>Hello</p>\r\n<p>Thanks for your reply. I tried out the steps mentioned above but the problem still persists. I am getting the error when I click on Finance link</p>\r\n<p><strong>{Microsoft.Practices.ServiceLocation.ActivationException: Activation error occured while trying to get instance of type Object, key \"QSys.Finance.Views.FinanceHomeView\" ---&gt; Microsoft.Practices.ServiceLocation.ActivationException: Activation error occured while trying to get instance of type Object, key \"QSys.Finance.Views.FinanceHomeView\"</strong><br /><strong>&nbsp;&nbsp; at Microsoft.Practices.Prism.MefExtensions.MefServiceLocatorAdapter.DoGetInstance(Type serviceType, String key)</strong><br /><strong>&nbsp;&nbsp; at Microsoft.Practices.ServiceLocation.ServiceLocatorImplBase.GetInstance(Type serviceType, String key)</strong><br /><strong>&nbsp;&nbsp; --- End of inner exception stack trace ---</strong><br /><strong>&nbsp;&nbsp; at Microsoft.Practices.ServiceLocation.ServiceLocatorImplBase.GetInstance(Type serviceType, String key)</strong><br /><strong>&nbsp;&nbsp; at Microsoft.Practices.ServiceLocation.ServiceLocatorImplBase.GetInstance[TService](String key)</strong><br /><strong>&nbsp;&nbsp; at Microsoft.Practices.Prism.Regions.RegionNavigationContentLoader.CreateNewRegionItem(String candidateTargetContract)}</strong></p>\r\n<p>&nbsp;</p>\r\n<p>I have uploaded the solution again for your reference once again (https://skydrive.live.com/embed?cid=E84CFB62692563C4&amp;resid=E84CFB62692563C4%21308&amp;authkey=ALD49_zkD-4Yo7o)</p>\r\n<p>Feel free to change the code or references to make it work.</p>\r\n<p>If you find the solution i would request you to please upload it to some public location from where I can download it.</p>\r\n<p>&nbsp;</p>\r\n<p>Thanks once again for your help. I really appreciate.</p>",
    "PostedDate": "2012-01-25T23:02:31.253-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "731297",
    "ThreadId": "286913",
    "Html": "<p>Hi,</p>\r\n<p>The steps we described above were targeting to solve the error you mentioned when following the instructions of your second post (clicking <strong>Admin </strong>module first, and the clicking <strong>Finance </strong>module), which was related to a composition error.</p>\r\n<p>Regarding the exception you mentioned in the first post, after reviewing your application again, we found that you are using <strong>silverlight frame navigation in prism with modules being loaded on demand</strong>. Based on my understanding, there were several users who reported to experience similar problems in related scenarios, as it seems that this is not supported from out of the box. Also, it can be seen that, regardless of the aforementioned exception, the view is still being loaded and shown in the region.</p>\r\n<p>Therefore, I believe you might find the following threads useful where similar scenarios regarding <strong>silverlight frame navigation in prism with modules being loaded on demand</strong> (with possible workarounds) are being discussed:</p>\r\n<ul>\r\n<li><a href=\"http://compositewpf.codeplex.com/discussions/286090\">region &amp; frame navigation with Modules OnDemand&nbsp;</a></li>\r\n<li><a href=\"http://compositewpf.codeplex.com/discussions/241134\">Integrating Prism v4 Region Navigation with Silverlight Frame Navigation with Dynamic Module</a></li>\r\n<li><a href=\"http://compositewpf.codeplex.com/discussions/257202\">Prismv4FrameRegionNavigation Issue</a></li>\r\n</ul>\r\n<p>I hope you find this useful,</p>\r\n<p>Damian Cherubini<br /> <a href=\"http://blogs.southworks.net/dcherubini\">http://blogs.southworks.net/dcherubini</a></p>",
    "PostedDate": "2012-01-26T12:17:53.31-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]