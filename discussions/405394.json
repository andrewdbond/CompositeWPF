[
  {
    "Id": "950594",
    "ThreadId": "405394",
    "Html": "\r\n<p>Hello</p>\r\n<p>I'm having the following problem.</p>\r\n<p>I want to implement ribbon-based app with ribbon tabs as separate MEF component which can also contain MEF components - ribbon groups.</p>\r\n<p>In my shell.xaml I have following code:</p>\r\n<p></p>\r\n<pre><div style=\"color:black; background-color:white\"><pre>        &lt;ribbon:Ribbon x:Name=<span style=\"color:#a31515\">&quot;Ribbon&quot;</span> cal:RegionManager.RegionName=<span style=\"color:#a31515\">&quot;AplicationRibbonControl&quot;</span>  &gt;\r\n            ........\r\n        &lt;/ribbon:Ribbon&gt;\r\n</pre>\r\n<pre><br></pre>\r\n<pre>For my Tab components I have following code in XAML:</pre>\r\n<pre><div style=\"color:black; background-color:white\"><pre>&lt;ribbon:RibbonTab x:Class=&quot;FI.VMRT.ObjectsTabUI&quot;\r\n             xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;\r\n             xmlns:x=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;\r\n             xmlns:mc=&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot; \r\n             xmlns:d=&quot;http://schemas.microsoft.com/expression/blend/2008&quot; \r\n             mc:Ignorable=&quot;d&quot; \r\n             xmlns:cal=&quot;http://www.codeplex.com/prism&quot;             \r\n             xmlns:ribbon=&quot;clr-namespace:Microsoft.Windows.Controls.Ribbon;assembly=RibbonControlsLibrary&quot;\r\n             x:Name=&quot;ObjectsTab&quot;\r\n             Header=&quot;Objects&quot;\r\n             cal:RegionManager.RegionName=&quot;ObjectsTabControl&quot;\r\n             &gt;\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">ribbon</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">RibbonTab</span><span style=\"color:blue\">&gt;</span>\r\n\r\n</pre>\r\n</div>\r\nAnd for my ribbon tab group component:</pre>\r\n<pre><div style=\"color:black; background-color:white\"><pre>&lt;ribbon:RibbonGroup x:Name=&quot;PlacementGroup&quot; \r\n                    Header=&quot;Placement&quot; \r\n                    x:Class=&quot;FI.VMRT.PlacementGroupUI&quot;\r\n             xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;\r\n             xmlns:x=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;\r\n             xmlns:mc=&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot; \r\n             xmlns:d=&quot;http://schemas.microsoft.com/expression/blend/2008&quot; \r\n             xmlns:ribbon=&quot;clr-namespace:Microsoft.Windows.Controls.Ribbon;assembly=RibbonControlsLibrary&quot;\r\n             xmlns:alp=&quot;clr-namespace:FI.Family.AkerLogoPack;assembly=AkerLogoPack&quot;\r\n             mc:Ignorable=&quot;d&quot; \r\n             d:DesignHeight=&quot;300&quot; d:DesignWidth=&quot;300&quot;&gt;\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Grid</span><span style=\"color:blue\">&gt;</span>\r\n.... controls here .......\r\n    <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">Grid</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">ribbon</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">RibbonGroup</span><span style=\"color:blue\">&gt;</span>\r\n\r\n</pre>\r\n</div>\r\nAnd while loading the application in my ribbon tab modude when I'm calling this:</pre>\r\n<pre><div style=\"color:black; background-color:white\"><pre>_regionViewRegistry.RegisterViewWithRegion(<span style=\"color:#a31515\">&quot;AplicationRibbonControl&quot;</span>, <span style=\"color:blue\">typeof</span>(ObjectsTabUI));\r\n</pre>\r\n</div>\r\n<br></pre>\r\n<pre>I'm getting the following error:</pre>\r\n<pre><div style=\"color:black; background-color:white\"><pre>An exception has occurred while trying to add a view to region 'AplicationRibbonControl'. \r\n    - The most likely causing exception was was: 'Microsoft.Practices.ServiceLocation.ActivationException: Activation error occured while trying to get instance of type ObjectsTabUI, key &quot;&quot; ---&gt; Microsoft.Practices.ServiceLocation.ActivationException: Activation error occured while trying to get instance of type ObjectsTabUI, key &quot;&quot;\r\n   at Microsoft.Practices.Prism.MefExtensions.MefServiceLocatorAdapter.DoGetInstance(Type serviceType, String key)\r\n   at Microsoft.Practices.ServiceLocation.ServiceLocatorImplBase.GetInstance(Type serviceType, String key)\r\n   --- End of inner exception stack trace ---\r\n   at Microsoft.Practices.ServiceLocation.ServiceLocatorImplBase.GetInstance(Type serviceType, String key)\r\n   at Microsoft.Practices.ServiceLocation.ServiceLocatorImplBase.GetInstance(Type serviceType)\r\n   at Microsoft.Practices.Prism.Regions.RegionViewRegistry.CreateInstance(Type type)\r\n   at Microsoft.Practices.Prism.Regions.RegionViewRegistry.&lt;&gt;c__DisplayClass1.<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">RegisterViewWithRegion</span><span style=\"color:blue\">&gt;</span>b__0()\r\n   at Microsoft.Practices.Prism.Regions.Behaviors.AutoPopulateRegionBehavior.OnViewRegistered(Object sender, ViewRegisteredEventArgs e)'.\r\n    But also check the InnerExceptions for more detail or call .GetRootException(). \r\n</pre>\r\n</div>\r\n<br></pre>\r\n</div>\r\nIf I'm removing my ribbon tab group component, evertything works fine - I have an empty tab inserted into ribbon on my Shell window.</pre>\r\n<pre>Can someone please give me a hint,  why this error occurs when I'm trying to add nested component?</pre>\r\n<pre>Thank you!</pre>\r\n<p></p>\r\n",
    "PostedDate": "2012-12-03T07:30:07.073-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "950758",
    "ThreadId": "405394",
    "Html": "\r\n<p>Hi,</p>\r\n<p>Basically, when defining a control as a region, <strong>Prism </strong>needs to create a region and &quot;adapt&quot; it for the corresponding control. To do this,\r\n<strong>Prism </strong>has a collection of <strong>RegionAdapters</strong> registered. As out of the box,\r\n<strong>Prism </strong>provides the following <strong>RegionAdapters</strong>:</p>\r\n<ul>\r\n<li><strong>ContentControlRegionAdapter</strong>: Used to adapt a region to any control that inherits from the\r\n<strong>ContentControl </strong>class.<strong>&nbsp;</strong> </li><li><strong>ItemsControlRegionAdapter</strong>: Used to adapt a region to any control that inherits from the\r\n<strong>ItemsControl </strong>class. </li><li><strong>SelectorRegionAdapter</strong>: Used to adapt a region to any control that inherits from the\r\n<strong>Selector </strong>class. </li></ul>\r\n<p>Based on my understanding, the cause of your problem is that you are defining a\r\n<strong>Ribbon </strong>control as a region, but <strong>Ribbon </strong>does not inherit from any of the aforementioned classes. Hence, as there is no\r\n<strong>RegionAdapter </strong>registered for <strong>Ribbons, </strong><strong>Prism\r\n</strong>is not able to create the region.</p>\r\n<p><strong>Prism </strong>allows you to define and add your own custom <strong>RegionAdapters\r\n</strong>to add support for controls that are not supported by default (for example\r\n<strong>Ribbons</strong>). You can find more information about <strong>RegionAdapters\r\n</strong>and how to configure them in the following section of the <strong>Prism </strong>\r\ndocumentation:</p>\r\n<ul>\r\n<li><a href=\"http://msdn.microsoft.com/en-us/library/gg430866%28v=pandp.40%29.aspx#sec25\">Appendix E - Extending Prism - Region Adapters</a>\r\n</li></ul>\r\n<p>Also, you might find the examples portrayed in the following thread useful in order to create a\r\n<strong>RegionAdapter </strong>for <strong>Ribbons</strong>:</p>\r\n<ul>\r\n<li><a href=\"http://compositewpf.codeplex.com/discussions/392851\">WPF + Prism + Ribbon Control Any where nice example??&nbsp;</a>\r\n</li></ul>\r\n<p>Finally, if you want for Prism to provide a <strong>RibbonRegionAdapter </strong>\r\nas out of the box, you can vote in the following work item:</p>\r\n<ul>\r\n<li><a href=\"http://compositewpf.codeplex.com/workitem/7063\">Ribbon Region</a> </li></ul>\r\n<p>I hope you find this useful,</p>\r\n<p>Damian Cherubini<br>\r\n<a href=\"http://blogs.southworks.net/dcherubini\">http://blogs.southworks.net/dcherubini</a></p>\r\n",
    "PostedDate": "2012-12-03T12:21:31.86-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "950980",
    "ThreadId": "405394",
    "Html": "\r\n<p>Hi Demian!</p>\r\n<p>Thank you for your response! So if I get it right I need to create a region adapter for RibbonTab control - correct? I.e. by default Prism doesnt now how to insert items in rbbon - correct?</p>\r\n<p>I'll try to use info on your links - thank you!</p>\r\n",
    "PostedDate": "2012-12-04T00:42:41.34-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]