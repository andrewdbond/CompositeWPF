[
  {
    "Id": "200865",
    "ThreadId": "59334",
    "Html": "<p>Hi all,</p>\r\n<p>I'm evaluating Composite WPF by developing a test application. I would like to load some modules on demand, from a module catalog populated by a configuration file. However after implementing this behavior, my application does not exit. When I close the main window, the window disappears, but the application is still running (Visual Studio is still in debugging mode).</p>\r\n<p>My App.config looks like:</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">&lt;?</span><span style=\"color:#A31515\">xml</span> <span style=\"color:Red\">version</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">1.0</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">encoding</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">utf-8</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Blue\">?&gt;</span>\r\n<span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">configuration</span><span style=\"color:Blue\">&gt;</span>\r\n   <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">configSections</span><span style=\"color:Blue\">&gt;</span>\r\n      <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">section</span> <span style=\"color:Red\">name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">modules</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">type</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Microsoft.Practices.Composite.Modularity.ModulesConfigurationSection, Microsoft.Practices.Composite</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Blue\">/&gt;</span>\r\n   <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">configSections</span><span style=\"color:Blue\">&gt;</span>\r\n   <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">modules</span><span style=\"color:Blue\">&gt;</span>\r\n      <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">module</span> <span style=\"color:Red\">assemblyFile</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">TestApp.Modules.AModule.dll</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">moduleType</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">TestApp.Modules.AModule.AModule, TestApp.Modules.AModule, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">moduleName</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">AModule</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">startupLoaded</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">false</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n         <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">dependencies</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">dependency</span> <span style=\"color:Red\">moduleName</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">BModule</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Blue\">/&gt;</span>\r\n         <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">dependencies</span><span style=\"color:Blue\">&gt;</span>\r\n      <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">module</span><span style=\"color:Blue\">&gt;</span>\r\n      <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">module</span> <span style=\"color:Red\">assemblyFile</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">TestApp.Modules.BModule.dll</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">moduleType</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">TestApp.Modules.BModule.BModule, TestApp.Modules.BModule, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">moduleName</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">BModule</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">startupLoaded</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">false</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Blue\">/&gt;</span>\r\n   <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">modules</span><span style=\"color:Blue\">&gt;</span>\r\n<span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">configuration</span><span style=\"color:Blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>My bootstrapper looks like this:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">public</span> <span style=\"color:Blue\">class</span><span style=\"color:MediumTurquoise\"> Bootstrapper : UnityBootstrapper\r\n</span>{\r\n   <span style=\"color:Blue\">protected</span> <span style=\"color:Blue\">override</span> DependencyObject CreateShell()\r\n   {\r\n      Shell shell = <span style=\"color:Blue\">this</span>.Container.Resolve&lt;Shell&gt;();\r\n      shell.Show();\r\n      <span style=\"color:Blue\">return</span> shell;\r\n   }\r\n\r\n   <span style=\"color:Blue\">protected</span> <span style=\"color:Blue\">override</span> IModuleCatalog GetModuleCatalog()\r\n   {\r\n      ModuleCatalog catalog = <span style=\"color:Blue\">new</span> ConfigurationModuleCatalog();\r\n      <span style=\"color:Blue\">return</span> catalog;\r\n   }\r\n\r\n   <span style=\"color:Blue\">protected</span> <span style=\"color:Blue\">override</span> <span style=\"color:Blue\">void</span> InitializeModules()\r\n   {\r\n      <span style=\"color:Blue\">base</span>.InitializeModules();\r\n\r\n      Shell shell = <span style=\"color:Blue\">this</span>.Container.Resolve&lt;Shell&gt;();\r\n      IModuleManager module_manager = Container.Resolve&lt;ModuleManager&gt;();\r\n      shell.InitializeModules(module_manager);\r\n\r\n      <span style=\"color:Blue\">return</span>;\r\n   }\r\n}\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>My shell looks like this:</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">public</span> <span style=\"color:Blue\">partial</span> <span style=\"color:Blue\">class</span><span style=\"color:MediumTurquoise\"> Shell : Window\r\n</span>{\r\n   <span style=\"color:Blue\">public</span> Shell()\r\n   {\r\n      InitializeComponent();\r\n      <span style=\"color:Blue\">return</span>;\r\n   }\r\n\r\n   <span style=\"color:Blue\">public</span> <span style=\"color:Blue\">void</span> InitializeModules(IModuleManager moduleManager)\r\n   {\r\n      moduleManager.LoadModule(<span style=\"color:#A31515\">&quot;BModule&quot;</span>);\r\n      moduleManager.LoadModule(<span style=\"color:#A31515\">&quot;AModule&quot;</span>);\r\n      <span style=\"color:Blue\">return</span>;\r\n   }\r\n}\r\n</pre>\r\n</div>\r\n</p>\r\n<p>&nbsp;</p>\r\n<p>Any ideas on what the problem might be?</p>",
    "PostedDate": "2009-06-12T08:48:22.23-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "200930",
    "ThreadId": "59334",
    "Html": "<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:small\"><span style=\"font-family:Calibri\"><span style=\"\" lang=EN-US>Hi emddudley,</span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:small\"><span style=\"font-family:Calibri\"><span style=\"\" lang=EN-US>&nbsp;</span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"\" lang=EN-US><span style=\"font-size:small\"><span style=\"font-family:Calibri\">I was able to reproduce the error you mention (Thanks for posting the code) and found the issue. </span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"\" lang=EN-US><span style=\"font-size:small\"><span style=\"font-family:Calibri\">The problem is in the following code (the<strong><em> </em></strong>line in <strong>bold&nbsp;</strong>and commented):</span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt 35.4pt\"><span style=\"font-size:10pt;color:blue;font-family:'Courier New'\" lang=EN-US>protected</span><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US> <span style=\"color:blue\">override</span> <span style=\"color:blue\">void</span> InitializeModules()</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 35.4pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>{</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 35.4pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp; <span style=\"color:blue\">base</span>.InitializeModules();</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 35.4pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 35.4pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp; <strong><span style=\"color:#2b91af\">Shell</span> shell = <span style=\"color:blue\">this</span>.Container.Resolve&lt;<span style=\"color:#2b91af\">Shell</span>&gt;(); <span style=\"color:green\">// This line creates a new instance of the shell</span></strong></span></p>\r\n<p style=\"margin:0cm 0cm 0pt 35.4pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp; <span style=\"color:#2b91af\">IModuleManager</span> module_manager = Container.Resolve&lt;ModuleManager&gt;();</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 35.4pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp; shell.InitializeModules(module_manager);</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 35.4pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 35.4pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp; <span style=\"color:blue\">return</span>;</span></p>\r\n<p style=\"margin:0cm 0cm 0pt 35.4pt\"><span style=\"font-size:10pt;font-family:'Courier New'\">}</span><span style=\"font-size:small\"><span style=\"font-family:Calibri\"> </span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:small\"><span style=\"font-family:Calibri\"><span style=\"\" lang=EN-US>&nbsp;</span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:small\"><span style=\"font-family:Calibri\"><span style=\"\" lang=EN-US>As you are creating a new instance of the shell (but not showing it), when you close the visible instance of the shell, the application keeps running.</span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:small\"><span style=\"font-family:Calibri\"><span style=\"\" lang=EN-US>&nbsp;</span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:small\"><span style=\"font-family:Calibri\"><strong><span style=\"\" lang=EN-US>Workarround</span></strong></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"\" lang=EN-US><span style=\"font-size:small\"><span style=\"font-family:Calibri\">A possible and simple workaround is not to use the shell in the <strong>InitializeModules</strong> method moving the <strong>Shell.InitializeModules</strong> method to the <strong>Bootstrapper</strong> as follows:<span style=\"color:#993366\"></span></span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"color:#993366\" lang=EN-US><span style=\"font-size:small\"><span style=\"font-family:Calibri\"><span style=\"\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;color:#993366;font-family:'Courier New'\" lang=EN-US><span style=\"\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style=\"font-size:10pt;color:blue;font-family:'Courier New'\" lang=EN-US>public</span><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US> <span style=\"color:blue\">class</span> <span style=\"color:#2b91af\">Bootstrapper</span> : <span style=\"color:#2b91af\">UnityBootstrapper</span></span><span style=\"color:#993366\"></span></p>\r\n<p style=\"margin:0cm 0cm 0pt 35.4pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>{</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color:blue\">protected</span> <span style=\"color:blue\">override</span> DependencyObject CreateShell()</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <em>{</em></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><em><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ...</span></em></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><em><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></em></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color:blue\">protected</span> <span style=\"color:blue\">override</span> IModuleCatalog GetModuleCatalog()</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ...</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color:blue\">protected</span> <span style=\"color:blue\">override</span> <span style=\"color:blue\">void</span> InitializeModules()</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color:blue\">base</span>.InitializeModules();</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color:green\">//Shell shell = this.Container.Resolve&lt;Shell&gt;(); // This line creates a new instance of the shell</span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IModuleManager module_manager = Container.Resolve&lt;ModuleManager&gt;();</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong><span style=\"color:blue\">this</span>.InitializeModules(module_manager);</strong></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color:blue\">return</span>;</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong><span style=\"color:blue\">public</span> <span style=\"color:blue\">void</span> InitializeModules(IModuleManager moduleManager)</strong></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><strong><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></strong></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><strong><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; moduleManager.LoadModule(<span style=\"color:#a31515\">&quot;BModule&quot;</span>);</span></strong></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><strong><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; moduleManager.LoadModule(<span style=\"color:#a31515\">&quot;AModule&quot;</span>);</span></strong></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><strong><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><strong><span style=\"font-size:10pt;color:blue;font-family:'Courier New'\">return</span></strong><strong><span style=\"font-size:10pt;font-family:'Courier New'\">;</span></strong></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><strong><span style=\"font-size:10pt;font-family:'Courier New'\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></strong></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\">&nbsp;</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"\" lang=EN-US><span style=\"font-size:small\"><span style=\"font-family:Calibri\">If your scenario forces you to <span style=\"color:#1f497d\">l</span>oad the modules in the <span style=\"color:#1f497d\">S</span>hell class, you can both:</span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt 53.4pt;text-indent:-18pt\"><span style=\"\"><span style=\"\"><span style=\"font-size:small;font-family:Calibri\">1.</span><span style=\"font:7pt &quot;Times New Roman&quot;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style=\"font-size:small\"><span style=\"font-family:Calibri\"><span style=\"\" lang=EN-US>Keep a reference to the shell created in the <strong>CreateShell</strong> Method as a private filed in the bootstrapper.</span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt 53.4pt;text-indent:-18pt\"><span style=\"\"><span style=\"\"><span style=\"font-size:small;font-family:Calibri\">2.</span><span style=\"font:7pt &quot;Times New Roman&quot;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style=\"\" lang=EN-US><span style=\"font-size:small;font-family:Calibri\">Register the shell as Singleton in the container (this is good only if need to access the shell instance from several places, if not the first option is better). &nbsp;You might check </span><a href=\"http://msdn.microsoft.com/en-us/library/cc304836.aspx\"><span style=\"font-size:small;font-family:Calibri\">How to: Register and Use Services</span></a></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:10pt;font-family:'Courier New'\" lang=EN-US>&nbsp;</span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:small\"><span style=\"font-family:Calibri\"><span style=\"\" lang=EN-US>Please let me know if it helps.</span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:small\"><span style=\"font-family:Calibri\"><span style=\"\" lang=EN-US>&nbsp;</span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><span style=\"font-size:small\"><span style=\"font-family:Calibri\"><span style=\"\" lang=EN-US>Matias Bonaventura</span></span></span></p>\r\n<p style=\"margin:0cm 0cm 0pt\"><a href=\"http://blogs.southworks.net/\"><span style=\"font-size:small;font-family:Calibri\">http://blogs.southworks.net/matiasb</span></a></p>",
    "PostedDate": "2009-06-12T11:14:35.723-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "200938",
    "ThreadId": "59334",
    "Html": "<p>Thanks for your help, I really appreciate it! I've decided to keep a private reference to the shell in the bootstrapper. It works like I had been hoping it would.</p>\r\n<p>I will have to read the documentation on Container.Resolve&lt;&gt;() to understand why it was creating a new instance.</p>",
    "PostedDate": "2009-06-12T11:36:30.367-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]