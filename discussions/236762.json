[
  {
    "Id": "529633",
    "ThreadId": "236762",
    "Html": "\r\n<p>VB.NET, WPF 4.0, Prism 4.0</p>\r\n<p>I have a solution with a&nbsp;primary&nbsp;desktop project and&nbsp;and another module.&nbsp; The main project's shell view has a TabControl which is my MainRegion.&nbsp; I have a menu that opens views in the mainregion.&nbsp; This is all working fine but\r\n I cannot get the view to close.&nbsp; I register the View from my Module&nbsp;with Unity and it launches successfully when selecting the appropriate menu option.&nbsp; My ViewModel implements INavigationAware and stores the NavigationJournal in a local variable\r\n on the&nbsp;NavigateTo event.&nbsp; I then have&nbsp;a CloseCommand on my ViewModel which is&nbsp;bound to a button on my TabHeader.&nbsp; When the button is clicked the corresponding ExceuteCloseCommand routine is called but the view never gets removed from\r\n the TabControl.&nbsp; My ExecuteCloseCommand routine simply issues a&nbsp;_navigationjournal.GoBack similar to the various examples out there.&nbsp; If I check the _navigationjournal.CanGoBack it is false and I'm not sure why.</p>\r\n<p>What could I be missing?&nbsp; I read through Chapter 8 of the guidance and poured through various examples but could not find any other interface that was required for me to implement to get this to work.</p>\r\n<p>Edit:&nbsp;&nbsp;I created an even simpler example and still can't get it to work.&nbsp; The ItemView opens fine in the TabControl in my shell but I can't get it to close.</p>\r\n<p>ShellViewModel:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">Public</span> <span style=\"color:blue\">Class</span> ShellViewModel\r\n\r\n  <span style=\"color:blue\">Private</span> _regionManager <span style=\"color:blue\">As</span> IRegionManager\r\n  <span style=\"color:blue\">Private</span> _navigatecommand <span style=\"color:blue\">As</span> ICommand\r\n\r\n  <span style=\"color:blue\">Public</span> <span style=\"color:blue\">Sub</span> <span style=\"color:blue\">New</span>(<span style=\"color:blue\">ByVal</span> regionManager <span style=\"color:blue\">As</span> IRegionManager)\r\n    _regionManager = regionManager\r\n  <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n\r\n  <span style=\"color:blue\">Public</span> <span style=\"color:blue\">ReadOnly</span> <span style=\"color:blue\">Property</span> NavigateCommand <span style=\"color:blue\">As</span> RelayCommand(Of <span style=\"color:blue\">String</span>)\r\n    <span style=\"color:blue\">Get</span>\r\n      <span style=\"color:blue\">If</span> _navigatecommand <span style=\"color:blue\">Is</span> <span style=\"color:blue\">Nothing</span> <span style=\"color:blue\">Then</span>\r\n        _navigatecommand = <span style=\"color:blue\">New</span> RelayCommand(Of <span style=\"color:blue\">String</span>)(<span style=\"color:blue\">AddressOf</span> NavigateTo)\r\n      <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\r\n      <span style=\"color:blue\">Return</span> _navigatecommand\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Get</span>\r\n  <span style=\"color:blue\">End</span> <span style=\"color:blue\">Property</span>\r\n\r\n  <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> NavigateTo(<span style=\"color:blue\">ByVal</span> param <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span>)\r\n    _regionManager.RequestNavigate(<span style=\"color:#a31515\">&quot;MainRegion&quot;</span>, <span style=\"color:#a31515\">&quot;ItemView&quot;</span>)\r\n  <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n\r\n<span style=\"color:blue\">End</span> <span style=\"color:blue\">Class</span>\r\n</pre>\r\n</div>\r\n<p>ItemViewModel:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">Public</span> <span style=\"color:blue\">Class</span> ItemViewModel\r\n  <span style=\"color:blue\">Implements</span> INavigationAware\r\n\r\n  <span style=\"color:blue\">Private</span> _closecommand <span style=\"color:blue\">As</span> ICommand\r\n  <span style=\"color:blue\">Private</span> _navjournal <span style=\"color:blue\">As</span> IRegionNavigationJournal\r\n\r\n  <span style=\"color:blue\">Public</span> <span style=\"color:blue\">ReadOnly</span> <span style=\"color:blue\">Property</span> CloseCommand <span style=\"color:blue\">As</span> ICommand\r\n    <span style=\"color:blue\">Get</span>\r\n      <span style=\"color:blue\">If</span> _closecommand <span style=\"color:blue\">Is</span> <span style=\"color:blue\">Nothing</span> <span style=\"color:blue\">Then</span>\r\n        _closecommand = <span style=\"color:blue\">New</span> RelayCommand(<span style=\"color:blue\">AddressOf</span> ExecuteClose)\r\n      <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\r\n      <span style=\"color:blue\">Return</span> _closecommand\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Get</span>\r\n  <span style=\"color:blue\">End</span> <span style=\"color:blue\">Property</span>\r\n\r\n  <span style=\"color:blue\">Public</span> <span style=\"color:blue\">Property</span> DisplayName <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span>\r\n    <span style=\"color:blue\">Get</span>\r\n      <span style=\"color:blue\">Return</span> <span style=\"color:#a31515\">&quot;Item View&quot;</span>\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Get</span>\r\n    <span style=\"color:blue\">Set</span>(<span style=\"color:blue\">ByVal</span> value <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span>)\r\n      <span style=\"color:green\">'noop</span>\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Set</span>\r\n  <span style=\"color:blue\">End</span> <span style=\"color:blue\">Property</span>\r\n\r\n  <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> ExecuteClose()\r\n    <span style=\"color:blue\">If</span> _navjournal.CanGoBack <span style=\"color:blue\">Then</span>\r\n      _navjournal.GoBack()\r\n    <span style=\"color:blue\">Else</span>\r\n      MessageBox.Show(<span style=\"color:#a31515\">&quot;Cant do it!!&quot;</span>)\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\r\n  <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n\r\n  <span style=\"color:blue\">Public</span> <span style=\"color:blue\">Function</span> IsNavigationTarget(<span style=\"color:blue\">ByVal</span> navigationContext <span style=\"color:blue\">As</span> Microsoft.Practices.Prism.Regions.NavigationContext) <span style=\"color:blue\">As</span> <span style=\"color:blue\">Boolean</span> <span style=\"color:blue\">Implements</span> Microsoft.Practices.Prism.Regions.INavigationAware.IsNavigationTarget\r\n    <span style=\"color:blue\">Return</span> <span style=\"color:blue\">False</span>\r\n  <span style=\"color:blue\">End</span> <span style=\"color:blue\">Function</span>\r\n\r\n  <span style=\"color:blue\">Public</span> <span style=\"color:blue\">Sub</span> OnNavigatedFrom(<span style=\"color:blue\">ByVal</span> navigationContext <span style=\"color:blue\">As</span> Microsoft.Practices.Prism.Regions.NavigationContext) <span style=\"color:blue\">Implements</span> Microsoft.Practices.Prism.Regions.INavigationAware.OnNavigatedFrom\r\n\r\n  <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n\r\n  <span style=\"color:blue\">Public</span> <span style=\"color:blue\">Sub</span> OnNavigatedTo(<span style=\"color:blue\">ByVal</span> navigationContext <span style=\"color:blue\">As</span> Microsoft.Practices.Prism.Regions.NavigationContext) <span style=\"color:blue\">Implements</span> Microsoft.Practices.Prism.Regions.INavigationAware.OnNavigatedTo\r\n    <span style=\"color:blue\">If</span> _navjournal <span style=\"color:blue\">Is</span> <span style=\"color:blue\">Nothing</span> <span style=\"color:blue\">Then</span>\r\n      _navjournal = navigationContext.NavigationService.Journal\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\r\n\r\n  <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n<span style=\"color:blue\">End</span> <span style=\"color:blue\">Class</span>\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2010-12-01T12:18:00.39-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "529677",
    "ThreadId": "236762",
    "Html": "\r\n<p>Hi,</p>\r\n<p>Based on my understanding when your application calls the <strong>GoBack </strong>\r\nmethod in the <strong>RegionNavigationJournal</strong> class, it does not navigate to the most recent entry in the back navigation history. Please, take into account that it does nothing if no entry exists in back navigation.</p>\r\n<p>That said, you could check your code to see whether it is calling the <strong>\r\nClear </strong>method in the <strong>RegionNavigationJournal </strong>class, since it clears your journal.<strong></strong></p>\r\n<p>If you continue experiencing this issue, could you please provide a repro sample application?<strong></strong></p>\r\n<p>Fernando Antivero <br>\r\n<a href=\"http://blogs.southworks.net/fantivero\">http://blogs.southworks.net/fantivero</a></p>\r\n",
    "PostedDate": "2010-12-01T13:29:39.033-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "530004",
    "ThreadId": "236762",
    "Html": "\r\n<p>OK, not sure what I changed to get this to work but now I have my CanGoBack showing True (most of the time).&nbsp; I was not calling Clear anywhere, it just seemed to loose the history sometimes.&nbsp; Is there any way to look at the URI that GoBack would\r\n go to?&nbsp; Here is the reason for my request.&nbsp; Lets say I have two views and they're being hosted in a TabControl with an &quot;X&quot; button to close the tab.&nbsp; If I navigate to View1, then View2, then click the X button on View1 (which does NOT navigate\r\n to View1), the GoBack method wants to go back to View1 so the end results is View1 is closed and then re-opened.&nbsp; So I would need to check and do something like: if jrnl.GoBackURI&lt;&gt;myURI then jrnl.GoBack.&nbsp; My other thought was to manually add\r\n a journal.RecordNavigation(_currenturi) so the call gets pushed down the stack.&nbsp; Maybe the Journal navigation just isn't meant for Tab based applications.</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2010-12-02T04:42:33.573-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "530694",
    "ThreadId": "236762",
    "Html": "\r\n<p>Hi,</p>\r\n<p>I'm glad that you solved your problem regarding the <strong>GoBack </strong>method.</p>\r\n<p>As you've mentioned, Journal navigation isn't meant for your scenario. The <a href=\"http://msdn.microsoft.com/en-us/library/microsoft.practices.prism.regions.regionnavigationjournal_members%28PandP.38%29.aspx\">\r\nRegionNavigationJournal</a> class does not expose a property that indicates the URI that the\r\n<strong>GoBack </strong>method navigates to. You could check the <a href=\"http://msdn.microsoft.com/en-us/library/microsoft.practices.prism.regions.iregionmemberlifetime.keepalive%28PandP.38%29.aspx\">\r\nIRegionMemberLifetime<span>.</span>KeepAlive</a> property, which might be useful to your scenario. You might find\r\n<a href=\"http://msdn.microsoft.com/en-us/library/gg430861%28PandP.40%29.aspx\">this chapter</a> from the Prism v4 documentation, and\r\n<a href=\"http://blogs.msdn.com/b/kashiffl/archive/2010/10/04/prism-v4-region-navigation-pipeline.aspx\">\r\nthis article</a> from <a href=\"http://karlshifflett.wordpress.com/\">Karl Shifflett</a> useful. The working of the aforementioned property, among other things, is explained there.</p>\r\n<p>I hope you find this helpful.</p>\r\n<p>Guido Leandro Maliandi<br>\r\n<a href=\"http://blogs.southworks.net/gmaliandi\">http://blogs.southworks.net/gmaliandi</a></p>\r\n",
    "PostedDate": "2010-12-03T07:23:36.59-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]