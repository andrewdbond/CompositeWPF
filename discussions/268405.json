[
  {
    "Id": "655283",
    "ThreadId": "268405",
    "Html": "\r\n<p>&nbsp;</p>\r\n<p>I am using Prism version 4.</p>\r\n<p>I have use IEventAggregator in some of my programs made with C# wpf/mvvm and I love it.</p>\r\n<p>I have an existing application mix with C#, C&#43;&#43;/cli, and C&#43;&#43;.</p>\r\n<p>Now I am bringing IEventAggregator in this software to be more loosely coupled.</p>\r\n<p>I am publishing some events very well, but when it comes to subscribe, I cannot make it work in C&#43;&#43;/CLI.</p>\r\n<p>&nbsp;</p>\r\n<p>If I do the following :</p>\r\n<p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; EventAggregator-&gt;GetEvent&lt;DoCalculationEvent^&gt;()-&gt;Subscribe(CalcTaxManager::CTaxRetMgr::CalcForm);</p>\r\n<p>I get the following error :</p>\r\n<p>CTaxRetMgr.cpp(45): error C3867: 'CalcTaxManager::CTaxRetMgr::CalcForm': function call missing argument list; use '&amp;CalcTaxManager::CTaxRetMgr::CalcForm' to create a pointer to member</p>\r\n<p>If I do create a delegate:</p>\r\n<p>in .h</p>\r\n<p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; public:</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delegate void CalcFormHandler(System::Object^ obj, DrTaxIdentification::FormIdentification^ FormID);</p>\r\n<p>in .cpp<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; EventAggregator-&gt;GetEvent&lt;DoCalculationEvent^&gt;()-&gt;Subscribe(gcnew CalcFormHandler(this, &amp;CalcTaxManager::CTaxRetMgr::CalcForm));</p>\r\n<p>I get the following error :</p>\r\n<p>CTaxRetMgr.cpp(45): error C2664: 'Microsoft::Practices::Prism::Events::SubscriptionToken ^Microsoft::Practices::Prism::Events::CompositePresentationEvent&lt;TPayload&gt;::Subscribe(System::Action&lt;T&gt; ^)' : cannot convert parameter 1 from 'CalcTaxManager::CTaxRetMgr::CalcFormHandler\r\n ^' to 'System::Action&lt;T&gt; ^'<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; with<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TPayload=DrTaxIdentification::FormIdentification ^,<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; T=DrTaxIdentification::FormIdentification ^<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ]<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; and<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; T=DrTaxIdentification::FormIdentification ^<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ]<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; No user-defined-conversion operator available, or<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Types pointed to are unrelated; conversion requires reinterpret_cast, C-style cast or function-style cast</p>\r\n<p>How can I cast a Delegate to a System.Action????</p>\r\n<p>Is there any example somewhere on how to subscribe to an event in C&#43;&#43;/cli?</p>\r\n<p>&nbsp;</p>\r\n<p>Thanks</p>\r\n<p>GI</p>\r\n",
    "PostedDate": "2011-08-09T08:51:24.277-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "655403",
    "ThreadId": "268405",
    "Html": "<p>Hi Gi,</p>\r\n<p>Currently there is no official support for Prism on the C++/cli language.</p>\r\n<p>For specific topics regarding C++/cli you can post a question in the Visual C++ forums:</p>\r\n<ul>\r\n<li><a href=\"http://social.msdn.microsoft.com/Forums/en-US/category/visualc\">Visual C++ Forums on MSDN</a></li>\r\n</ul>\r\n<p>Thanks,</p>\r\n<p>Damian Cherubini<br /> <a href=\"http://blogs.southworks.net/dcherubini\">http://blogs.southworks.net/dcherubini</a></p>",
    "PostedDate": "2011-08-09T11:17:05.703-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]