[
  {
    "Id": "441355",
    "ThreadId": "212225",
    "Html": "<p>Hi,</p>\r\n<p>I am building the application using the Compositie Guidance October 2009 version.</p>\r\n<p>Below is the XMAL for the datagrid in a view of a module which is in&nbsp;a region&nbsp;on the left hand of&nbsp;the shell window.</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Grid</span> <span style=\"color:red\">x:Name</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">mainGrid</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Height</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Auto</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Width</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Auto</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">RenderTransformOrigin</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">0.5,0.5</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Grid.RenderTransform</span><span style=\"color:blue\">&gt;</span>\r\n   <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">TransformGroup</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">ScaleTransform</span><span style=\"color:blue\">/&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">SkewTransform</span><span style=\"color:blue\">/&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">RotateTransform</span><span style=\"color:blue\">/&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">TranslateTransform</span><span style=\"color:blue\">/&gt;</span>\r\n   <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">TransformGroup</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">Grid.RenderTransform</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Grid.ColumnDefinitions</span><span style=\"color:blue\">&gt;</span>\r\n   <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">ColumnDefinition</span> <span style=\"color:red\">Width</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">*</span><span style=\"color:black\">&quot;</span> <span style=\"color:blue\">/&gt;</span>\r\n   <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">ColumnDefinition</span> <span style=\"color:red\">Width</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">10</span><span style=\"color:black\">&quot;</span> <span style=\"color:blue\">/&gt;</span>\r\n   <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">ColumnDefinition</span> <span style=\"color:red\">Width</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">*</span><span style=\"color:black\">&quot;</span> <span style=\"color:blue\">/&gt;</span>\r\n  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">Grid.ColumnDefinitions</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Grid.RowDefinitions</span><span style=\"color:blue\">&gt;</span>\r\n   <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">RowDefinition</span> <span style=\"color:red\">Height</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Auto</span><span style=\"color:black\">&quot;</span> <span style=\"color:blue\">/&gt;</span>\r\n   <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">RowDefinition</span> <span style=\"color:red\">Height</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Auto</span><span style=\"color:black\">&quot;</span> <span style=\"color:blue\">/&gt;</span>\r\n  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">Grid.RowDefinitions</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">toolkit</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">DataGrid</span> <span style=\"color:red\">x:Name</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">dgResults</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Grid.Row</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">0</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Grid.Column</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">0</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">AutoGenerateColumns</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">True</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">VerticalAlignment</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Top</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">HeadersVisibility</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">None</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">ItemsSource</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">{Binding Path=.}</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">CanUserAddRows</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">False</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">CanUserDeleteRows</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">False</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">CanUserResizeRows</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">False</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">CanUserReorderColumns</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">False</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">CanUserResizeColumns</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">False</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">CanUserSortColumns</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">False</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Visibility</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Hidden</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">LoadingRow</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">dg_LoadingRow</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Width</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">auto</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">HorizontalScrollBarVisibility</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Auto</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">HorizontalAlignment</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Left</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">FrozenColumnCount</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">1</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">IsReadOnly</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">True</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">Grid</span><span style=\"color:blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p>The code in the code-behind file used to populate the datagrid when the data is passed by presenter&nbsp;is</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre><span style=\"color:blue\">public</span> List&lt;DataTable&gt; Model\r\n  {\r\n   <span style=\"color:blue\">get</span>\r\n   {\r\n    <span style=\"color:blue\">return</span> <span style=\"color:blue\">this</span>.mainGrid.DataContext <span style=\"color:blue\">as</span> List&lt;DataTable&gt;;\r\n   }\r\n   <span style=\"color:blue\">set</span>\r\n   {     \r\n    dgResults.DataContext = value[0];    \r\n    numberofcpv = value[0].Columns.Count - 1;\r\n    dgResults.Columns[0].CellStyle = (Style)FindResource(<span style=\"color:#a31515\">&quot;DatagridCellStyle&quot;</span>);    \r\n    dgResults.Visibility = Visibility.Visible;\r\n   }\r\n  } \r\n</pre>\r\n</div>\r\n<p>The code below is the event handler used to format the data in each row as transposed data now have the same format for each row.</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre><span style=\"color:blue\">private</span> <span style=\"color:blue\">void</span> dg_LoadingRow(<span style=\"color:blue\">object</span> sender, DataGridRowEventArgs e)\r\n  {\r\n   DataRowView item = e.Row.Item <span style=\"color:blue\">as</span> DataRowView;\r\n   DataRow row;\r\n   DataGrid dg = (sender) <span style=\"color:blue\">as</span> DataGrid;\r\n\r\n   <span style=\"color:blue\">if</span> (e.Row.GetIndex() == 0)\r\n   {\r\n    DataGridRow dgr = e.Row;\r\n\r\n    e.Row.Background = <span style=\"color:blue\">new</span> SolidColorBrush(Colors.Gray);\r\n    dgr.FontWeight = FontWeights.Bold;\r\n    <span style=\"color:blue\">if</span> (item != <span style=\"color:blue\">null</span>)\r\n    {\r\n     row = item.Row;\r\n     row[<span style=\"color:#a31515\">&quot;0&quot;</span>] = <span style=\"color:#a31515\">&quot;&quot;</span>;\r\n\r\n    }\r\n   }\r\n   <span style=\"color:blue\">else</span> <span style=\"color:blue\">if</span> (e.Row.GetIndex() &lt;= 8)\r\n   {\r\n    <span style=\"color:blue\">if</span> (dg == dgResults)\r\n    {\r\n     <span style=\"color:blue\">for</span> (<span style=\"color:blue\">int</span> i = 1; i &lt;= numberofcpv; i++)\r\n     {\r\n      <span style=\"color:blue\">if</span> (item != <span style=\"color:blue\">null</span>)\r\n      {\r\n       row = item.Row;\r\n       row[i] = <span style=\"color:blue\">string</span>.Format(<span style=\"color:#a31515\">&quot;{0:c0}&quot;</span>, Convert.ToDecimal(row[i]));\r\n      }\r\n     }\r\n    }\r\n    }\r\n   <span style=\"color:blue\">else</span> <span style=\"color:blue\">if</span> (9 &lt;= e.Row.GetIndex() &amp;&amp; e.Row.GetIndex() &lt;= 12)\r\n   {\r\n    <span style=\"color:blue\">if</span> (dg == dgResults)\r\n    {\r\n     <span style=\"color:blue\">for</span> (<span style=\"color:blue\">int</span> i = 1; i &lt;= numberofcpv; i++)\r\n     {\r\n      <span style=\"color:blue\">if</span> (item != <span style=\"color:blue\">null</span>)\r\n      {\r\n       row = item.Row;\r\n       row[i] = <span style=\"color:blue\">string</span>.Format(<span style=\"color:#a31515\">&quot;{0:0.00%}&quot;</span>, Convert.ToDecimal(row[i]));\r\n      }\r\n     }\r\n    }\r\n\r\n   }\r\n   <span style=\"color:blue\">else</span> <span style=\"color:blue\">if</span> (9 &lt;= e.Row.GetIndex() &amp;&amp; e.Row.GetIndex() &lt;= 13)\r\n   {\r\n    <span style=\"color:blue\">if</span> (dg == dgResults)\r\n    {\r\n     <span style=\"color:blue\">for</span> (<span style=\"color:blue\">int</span> i = 1; i &lt;= numberofcpv; i++)\r\n     {\r\n      <span style=\"color:blue\">if</span> (item != <span style=\"color:blue\">null</span>)\r\n      {\r\n       row = item.Row;\r\n       row[i] = Convert.ToDecimal(row[i]).ToString(<span style=\"color:#a31515\">&quot;N2&quot;</span>);\r\n      }\r\n     }\r\n    }\r\n   }\r\n   <span style=\"color:blue\">else</span>\r\n   {\r\n    <span style=\"color:blue\">if</span> (dg == dgResults)\r\n    {\r\n     <span style=\"color:blue\">for</span> (<span style=\"color:blue\">int</span> i = 1; i &lt;= numberofcpv; i++)\r\n     {\r\n      <span style=\"color:blue\">if</span> (item != <span style=\"color:blue\">null</span>)\r\n      {\r\n       row = item.Row;\r\n       row[i] = <span style=\"color:blue\">string</span>.Format(<span style=\"color:#a31515\">&quot;{0:c0}&quot;</span>, Convert.ToDecimal(row[i]));\r\n      }\r\n     }\r\n    }\r\n    }\r\n  }\r\n</pre>\r\n</div>\r\n<p>On the right hand side region of the shell window, it is another view from the same module. This view cotains some comboboxes for the selection of search criteria. These comboboxs' default value are set to index 0 when the window is loaded.</p>\r\n<p>When I choose the different items in the comboboxes and click the submit button, the data are loaded and displayed correctly in the grid.</p>\r\n<p>However, when I select a row in the datagrid by clicking on it, while it should have no effect on all the comboboexs,&nbsp;&nbsp;the&nbsp;currently selected items in them&nbsp;are all changed back to the default items same as the when the window is just loaded.&nbsp; e.g. if comboboxes has&nbsp;items A,B,c and A is the default selected item when the window is loaded. After I choose B in it and submit the search, when the data is displayed in the datagrid, I click on the row in the grid, the combobox will chagne to A selected in it while it should stay on B.</p>\r\n<p>It has nothing to do with the dg_LoadingRow event handling as well. As even without using it, the problem can still happend.</p>\r\n<p>If I put a&nbsp;combox in the&nbsp;same view&nbsp;with the grid,&nbsp;it seems all right.&nbsp;</p>\r\n<p>Is there anything else I can use to track the problem?</p>\r\n<p>&nbsp;</p>\r\n<p>Thanks</p>",
    "PostedDate": "2010-05-11T01:01:49.493-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "441390",
    "ThreadId": "212225",
    "Html": "<p>Problems solved. It is something to do with the event bubbling in my code.</p>",
    "PostedDate": "2010-05-11T02:54:33.717-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]