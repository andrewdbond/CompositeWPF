[
  {
    "Id": "510419",
    "ThreadId": "231780",
    "Html": "<p>Hi,<br>I'm having problems attaching an uncheck command to a checkbox. Or more correct, I do not know how to code it. Here's my code for the check command, how should it look to get uncheck also working?</p>\r\n<p>View:</p>\r\n<pre>&lt;CheckBox commands:Checked.Command=&quot;{Binding CheckCommand}&quot;\r\n    IsChecked=&quot;False&quot;&gt;&lt;/CheckBox&gt;</pre>\r\n<p><br>&nbsp;</p>\r\n<p>ViewModel:</p>\r\n<pre>Private _CheckCommand As DelegateCommand(Of Object)\r\n\r\n    CheckCommand = New DelegateCommand(Of Object)(AddressOf Checked)\r\n\r\n    Private Sub Checked(ByVal parameter As Object)\r\n\r\n    End Sub</pre>\r\n<p>&nbsp;</p>\r\n<p>Command:</p>\r\n<pre>Public Class ToggleCheckedCommandBehaviour\r\n        Inherits CommandBehaviorBase(Of CheckBox)\r\n\r\n        Public Sub New(ByVal checkableObject As CheckBox)\r\n            MyBase.New(checkableObject)\r\n            AddHandler checkableObject.Checked, AddressOf checkableObject_Checked\r\n        End Sub\r\n\r\n        Private Sub checkableObject_Checked(ByVal sender As Object, ByVal e As System.Windows.RoutedEventArgs)\r\n            CommandParameter = TargetObject.Name\r\n            ExecuteCommand()\r\n        End Sub\r\n    End Class\r\n\r\n    Public NotInheritable Class Checked\r\n\r\n        Private Sub New()\r\n        End Sub\r\n\r\n        Private Shared ReadOnly SelectedCommandBehaviorProperty As DependencyProperty = _\r\n        DependencyProperty.RegisterAttached(&quot;SelectedCommandBehavior&quot;, _\r\n                                            GetType(ToggleCheckedCommandBehaviour), _\r\n                                            GetType(Checked), _\r\n                                            Nothing)\r\n\r\n        Private Shared ReadOnly CommandProperty As DependencyProperty = _\r\n        DependencyProperty.RegisterAttached(&quot;Command&quot;, _\r\n                                            GetType(ICommand), _\r\n                                            GetType(Checked), _\r\n                                            New PropertyMetadata(AddressOf OnSetCommandCallback))\r\n\r\n\r\n        Public Shared Sub SetCommand(ByVal CheckBox As CheckBox, ByVal command As ICommand)\r\n            CheckBox.SetValue(CommandProperty, command)\r\n        End Sub\r\n\r\n        Public Shared Function GetCommand(ByVal CheckBox As CheckBox) As ICommand\r\n            Return TryCast(CheckBox.GetValue(CommandProperty), ICommand)\r\n        End Function\r\n\r\n        Private Shared Sub OnSetCommandCallback(ByVal dependencyObject As DependencyObject, ByVal e As DependencyPropertyChangedEventArgs)\r\n            Dim CheckBox = TryCast(dependencyObject, CheckBox)\r\n            If Not CheckBox Is Nothing Then\r\n                Dim behavior = GetOrCreateBehavior(CheckBox)\r\n                behavior.Command = TryCast(e.NewValue, ICommand)\r\n            End If\r\n        End Sub\r\n\r\n        Private Shared Function GetOrCreateBehavior(ByVal CheckBox As CheckBox) As ToggleCheckedCommandBehaviour\r\n            Dim behavior = TryCast(CheckBox.GetValue(SelectedCommandBehaviorProperty), ToggleCheckedCommandBehaviour)\r\n            If behavior Is Nothing Then\r\n                behavior = New ToggleCheckedCommandBehaviour(CheckBox)\r\n                CheckBox.SetValue(SelectedCommandBehaviorProperty, behavior)\r\n            End If\r\n            Return behavior\r\n        End Function\r\n\r\n    End Class\r\n    End Namespace</pre>\r\n<p>&nbsp;</p>\r\n<p>As mentioned the check command works fine, and the command and method connected to it gets fired, what do I need to do to get the uncheck also working?<br>For info I'm using PRISM v2, CAL, MVVM and SL4 - in VB.NET<br><br></p>",
    "PostedDate": "2010-10-21T03:32:42.1-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "511123",
    "ThreadId": "231780",
    "Html": "\r\n<p>Hi,</p>\r\n<p>The fact that the Checked command is working correctly means that the attached behavior was correctly implemented. That said, the behavior only monitors a single event which you specify in this line:</p>\r\n<p><strong><span style=\"font-size:10pt\">AddHandler checkableObject.Checked, AddressOf checkableObject_Checked</span></strong></p>\r\n<p>Thus, you are subscribing to the <a href=\"http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.togglebutton.checked%28VS.95%29.aspx\" target=\"_blank\">\r\nChecked</a> event of the Checkbox control. As you want to have control of the Checkbox being unchecked, you simply need to create another command behavior using the\r\n<a href=\"http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.togglebutton.unchecked%28VS.95%29.aspx\">\r\nUnchecked</a> event. This assumes that you want a different command executed when the button is checked/unchecked. But If you use the same command, then binding to the\r\n<a href=\"http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.buttonbase.command%28VS.95%29.aspx\" target=\"_blank\">\r\nCommand</a> property should suffice.</p>\r\n<p>Hope this helps.</p>\r\n<p>Fernando Antivero <br>\r\n<a href=\"http://blogs.southworks.net/fantivero\">http://blogs.southworks.net/fantivero</a></p>\r\n",
    "PostedDate": "2010-10-22T07:34:28.413-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "511953",
    "ThreadId": "231780",
    "Html": "\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-family:Consolas; color:#0000ff; font-size:small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:small\">Thanx fantivero, you put me on the right path. I change my code to monitor the click event instead, that way I'm able to\r\n catch both unched/check event and by passing the TargetObject as commandparameter&nbsp;back to my viewmodel&nbsp;I can do various stuff with IsChecked bool to determine wheter&nbsp;it's a &quot;check click&quot; or &quot;uncheck click&quot;.&nbsp;</span></span></p>\r\n<p><span style=\"font-family:Consolas; color:#0000ff; font-size:small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:small\">AddHandler checkableObject.Click, AddressOf checkableObject_Click</span></span></p>\r\n<p></p>\r\n<p>Private Sub checkableObject_Click(ByVal sender As Object, ByVal e As System.Windows.RoutedEventArgs<br>\r\n&nbsp;CommandParameter = TargetObject<br>\r\n&nbsp;ExecuteCommand()<br>\r\nEnd Sub</p>\r\n<p></p>\r\n<p><span style=\"font-family:Consolas; color:#0000ff; font-size:small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:small\">When I detect a click, I'm displaying a view within a region (ItemsControl) in another view. So if I check 5 checkboxes\r\n the mainview will hold 5 detailviews in its ItemsControl.. I add the views like this:&nbsp;</span></span></p>\r\n<p><span style=\"font-family:Consolas; color:#0000ff; font-size:small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:small\">(but how can I remove the views on uncheck?)</span></span></p>\r\n<p><span style=\"font-family:Consolas; color:#0000ff; font-size:small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:small\">&#65279;</span></span></span></span>&nbsp;Dim\r\n basketRegion = _RegionManager.Regions(&quot;basketRegion&quot;)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim view = _Container.Resolve(Of basketDetailsView)()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim viewmodel = _Container.Resolve(Of basketDetailsViewModel)()</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; viewmodel.basketName = basketName<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; view.ApplyModel(viewmodel)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; basketRegion.Add(view)</p>\r\n",
    "PostedDate": "2010-10-25T00:11:57.363-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "512136",
    "ThreadId": "231780",
    "Html": "\r\n<p>Hi,</p>\r\n<p>Based on the code that you shared you are using View Injection for adding your views to the region. So, if you want to remove a view from a region, you could use the\r\n<a href=\"http://msdn.microsoft.com/en-us/library/microsoft.practices.composite.presentation.regions.region.remove.aspx\">\r\nRemove</a> method in the <a href=\"http://msdn.microsoft.com/en-us/library/microsoft.practices.composite.presentation.regions.region.aspx\">\r\nRegion</a> class.</p>\r\n<p>But before removing the views, you must add your views indicating a view name for each one. So your code might be similar to the following:</p>\r\n<p style=\"padding-left:30px\"><strong>basketRegion.Add(view, &quot;YourViewName&quot;)</strong></p>\r\n<p>Once you added your views using the aforementioned approach, you will be able to remove these views using the following code (pseudo-code):</p>\r\n<p style=\"padding-left:30px\"><strong>Dim basketRegion = _RegionManager.Regions(&quot;basketRegion&quot;)</strong><br>\r\n<strong>Dim yourView = basketRegion.GetView(&quot;YourViewName&quot;)</strong><br>\r\n<strong>basketRegion.Remove(yourView)</strong></p>\r\n<p>If you need more guidance on this topic, you could also check the UIComposition Quickstart, since it provides the recommended approaches for similar scenarios.<strong><br>\r\n</strong></p>\r\n<p>Hope this helps.</p>\r\n<p>Fernando Antivero <br>\r\n<a href=\"http://blogs.southworks.net/fantivero\">http://blogs.southworks.net/fantivero</a></p>\r\n",
    "PostedDate": "2010-10-25T07:07:27.363-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "512590",
    "ThreadId": "231780",
    "Html": "\r\n<p>That works like a charm, thank you very much! :)</p>\r\n<p>Please see my latest problem at this thread: <a href=\"http://compositewpf.codeplex.com/Thread/View.aspx?ThreadId=232334\">\r\nhttp://compositewpf.codeplex.com/Thread/View.aspx?ThreadId=232334</a></p>\r\n<p>:)</p>\r\n",
    "PostedDate": "2010-10-26T02:17:54.72-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]