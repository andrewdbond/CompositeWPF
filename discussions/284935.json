[
  {
    "Id": "720240",
    "ThreadId": "284935",
    "Html": "\r\n<p>Hi All,</p>\r\n<p>I am using the following code for remove the Ribbon Tab</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach (var view in rmanager.Regions[RegionNames.RibbonRegion].Views)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (view != null)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RibbonTab tab = view as RibbonTab;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (tab.Name == &quot;LoginTabView&quot;)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rmanager.Regions[RegionNames.RibbonRegion].Remove(view);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; continue;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>\r\n<p>&nbsp;</p>\r\n<p>It throws the error as follows :</p>\r\n<p>&quot; {&quot;The region does not contain the specified view.\\r\\nParameter name: view&quot;} &quot;</p>\r\n<p>I debugged the project in Ribbon RegionAdapter class&nbsp;Ribbon Tab is removed but it throwing above exception.</p>\r\n<p>Thanks and Regards,</p>\r\n<p>Sakthi</p>\r\n",
    "PostedDate": "2012-01-04T04:07:55.247-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "720398",
    "ThreadId": "284935",
    "Html": "<p>Hi Sakthi,</p>\r\n<p>Based on my understanding, you might find the following  thread useful, where a scenario in which the same exception is being  thrown when the views are removed:</p>\r\n<ul>\r\n<li> <a href=\"http://compositewpf.codeplex.com/discussions/272855\">Problem when remove view from region </a></li>\r\n</ul>\r\n<p>Regarding the region adapter, as far as I know there is no official support for ribbon region adapters in <strong>Prism out of the box</strong>. However, you can check the following blog post where an example of a ribbon region adapter is provided. The blog post is in German but it provides a sample solution that could be useful regardless of your understanding of the language:</p>\r\n<ul>\r\n<li><a href=\"http://blogs.msdn.com/b/mtcmuc/archive/2010/12/01/how-to-prism-ribbon-regionadapter.aspx\">How to: PRISM Ribbon RegionAdapter</a></li>\r\n</ul>\r\n<p>Also, if you believe that ribbon region adapters should be supported by<strong> Prism out of the box</strong>, you can vote in the following work item so that the prism team analyzes it for a future release:</p>\r\n<ul>\r\n<li><a href=\"http://compositewpf.codeplex.com/workitem/7063\">Ribbon Region</a></li>\r\n</ul>\r\n<p>As a side note, it can be seen in the code snippet you posted above that the collection that is being iterated in the <strong>foreach </strong>statement (the <strong>Views </strong>collection of the region) is modified inside the <strong>foreach </strong>when the <strong>Remove </strong>method of the region is invoked. Based on my understanding, this might cause unexpected behaviors in your application. Just to be safe, it might be useful to modify the collection outside of the <strong>foreach </strong>statement. For example:</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>IRegion region = rmanager.Regions[RegionNames.RibbonRegion];\r\nList&lt;Object&gt; viewsToRemove = <span style=\"color: blue;\">new</span> List&lt;Object&gt;();\r\n\r\n<span style=\"color: blue;\">foreach</span> (<span style=\"color: blue;\">var</span> view <span style=\"color: blue;\">in</span> region.Views)\r\n{\r\n    <span style=\"color: blue;\">if</span> (view != <span style=\"color: blue;\">null</span>)\r\n    {\r\n        RibbonTab tab = view <span style=\"color: blue;\">as</span> RibbonTab;\r\n        <span style=\"color: blue;\">if</span> (tab.Name == <span style=\"color: #a31515;\">\"LoginTabView\"</span>)\r\n        { \r\n            viewsToRemove.Add(view);\r\n        }\r\n    }\r\n}\r\n\r\n<span style=\"color: blue;\">foreach</span>(<span style=\"color: blue;\">var</span> view <span style=\"color: blue;\">in</span> viewsToRemove)\r\n{\r\n    region.Remove(view);\r\n}</pre>\r\n</div>\r\n<p>I hope you find this useful,</p>\r\n<p>Damian Cherubini<br /> <a href=\"http://blogs.southworks.net/dcherubini\" target=\"_blank\">http://blogs.southworks.net/dcherubini</a></p>",
    "PostedDate": "2012-01-04T10:18:47.927-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]